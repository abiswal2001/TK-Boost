instance_id,user_query,used_gold_tables,used_gold_joins,used_predicted_tables_cols,used_predicted_tables_cols_raw,used_external_knowledge,model,examples_used,predicted_cte_briefs,raw_output,example_selection,timestamp
bq011,"How many distinct pseudo users had positive engagement time  in the 7-day period ending on January 7, 2021 at 23:59:59, but had no positive engagement time in the 2-day period ending on the same date (January 7, 2021 at 23:59:59) ?",false,false,false,false,false,azure/o3,"local310,local194,local059,local021",seven_day_users: distinct pseudo users with positive engagement Jan 1–7 2021 inclusive; two_day_users: distinct pseudo users with positive engagement Jan 6–7 2021 inclusive; qualified_users: users in seven_day_users not in two_day_users; user_count: counts qualified_users,seven_day_users: distinct pseudo users with positive engagement Jan 1–7 2021 inclusive; two_day_users: distinct pseudo users with positive engagement Jan 6–7 2021 inclusive; qualified_users: users in seven_day_users not in two_day_users; user_count: counts qualified_users,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local194,local059,local021""}",2025-10-31T09:36:24
bq010,"Find the top-selling product among customers who bought 'Youtube Men’s Vintage Henley' in July 2017, excluding itself.",false,false,false,false,true,azure/o3,"local201,local067,local311,local329","july_items: extracts July 2017 purchased items with fullVisitorId, v2ProductName, quantity, revenue; target_buyers: distinct fullVisitorId who bought 'Youtube Men’s Vintage Henley' in July 2017; buyer_items: july_items filtered to target_buyers; other_items: buyer_items excluding 'Youtube Men’s Vintage Henley'; product_totals: aggregates quantity and revenue per product from other_items; top_product: selects highest revenue product from product_totals","july_items: extracts July 2017 purchased items with fullVisitorId, v2ProductName, quantity, revenue; target_buyers: distinct fullVisitorId who bought 'Youtube Men’s Vintage Henley' in July 2017; buyer_items: july_items filtered to target_buyers; other_items: buyer_items excluding 'Youtube Men’s Vintage Henley'; product_totals: aggregates quantity and revenue per product from other_items; top_product: selects highest revenue product from product_totals","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local067,local311,local329""}",2025-10-31T09:36:42
bq009,"Which traffic source has the highest total transaction revenue for the year 2017, and what is the difference in millions (rounded to two decimal places) between the highest and lowest monthly total transaction revenue for that traffic source?",false,false,false,false,true,azure/o3,"local015,local244,local219,local199","filtered_sessions: 2017 sessions with non-null totals.totalTransactionRevenue, keeping date, month, trafficSource.source, revenue; source_totals: sum 2017 revenue per source, add rank descending; best_source: select source with rank 1 from source_totals; monthly_totals: aggregate revenue by month for best_source; revenue_range: compute max and min monthly revenue and their difference in millions rounded to two decimals","filtered_sessions: 2017 sessions with non-null totals.totalTransactionRevenue, keeping date, month, trafficSource.source, revenue; source_totals: sum 2017 revenue per source, add rank descending; best_source: select source with rank 1 from source_totals; monthly_totals: aggregate revenue by month for best_source; revenue_range: compute max and min monthly revenue and their difference in millions rounded to two decimals","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local244,local219,local199""}",2025-10-31T09:36:51
bq001,"For each visitor who made at least one transaction in February 2017, how many days elapsed between the date of their first visit in February and the date of their first transaction in February, and on what type of device did they make that first transaction?",false,false,false,false,true,azure/o3,"local066,local075,local228,local037","feb_sessions: selects Feb 2017 sessions with visitor id, visitStartTime, date, transactions count, device category; first_visits: earliest Feb session date per visitor; first_transactions: earliest Feb transaction session per visitor capturing device category; visitor_gap: joins first_visits and first_transactions to compute days between first visit and first transaction","feb_sessions: selects Feb 2017 sessions with visitor id, visitStartTime, date, transactions count, device category; first_visits: earliest Feb session date per visitor; first_transactions: earliest Feb transaction session per visitor capturing device category; visitor_gap: joins first_visits and first_transactions to compute days between first visit and first transaction","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local075,local228,local037""}",2025-10-31T09:37:09
bq002,"During the first half of 2017,  focusing on hits product revenue, which traffic source generated the highest total product revenue, and what were the maximum daily, weekly, and monthly product revenues (in millions) for that top-performing source over this period?",false,false,false,false,true,azure/o3,"local253,local141,local301,local130","exploded_products: extract date, traffic_source, product revenue (millions) from product hits Jan–Jun 2017; source_totals: sum revenue per traffic source to find totals; top_source: pick source with highest total revenue; period_sums: aggregate top source revenue by day, week, and month with period_type labels; max_revenue_by_period: return maximum revenue per period_type for final output","exploded_products: extract date, traffic_source, product revenue (millions) from product hits Jan–Jun 2017; source_totals: sum revenue per traffic source to find totals; top_source: pick source with highest total revenue; period_sums: aggregate top source revenue by day, week, and month with period_type labels; max_revenue_by_period: return maximum revenue per period_type for final output","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local141,local301,local130""}",2025-10-31T09:37:31
bq003,"Between April 1 and July 31 of 2017, using the hits product revenue data along with the totals transactions to classify sessions as purchase (transactions ≥ 1 and productRevenue not null) or non-purchase (transactions null and productRevenue null), compare the average pageviews per visitor for each group by month",false,false,false,false,true,azure/o3,"local141,local244,local060,local075","sessions_in_range: selects sessions 2017-04-01 to 2017-07-31 with visitor id, month, pageviews, transactions; session_product_rev: sums hits.product.productRevenue per session in range; classified_sessions: joins sessions and revenue, labels purchase vs non_purchase; visitor_totals: aggregates total pageviews per visitor, month, purchase_flag; monthly_avg_pageviews: computes average visitor pageviews by month and purchase_flag","sessions_in_range: selects sessions 2017-04-01 to 2017-07-31 with visitor id, month, pageviews, transactions; session_product_rev: sums hits.product.productRevenue per session in range; classified_sessions: joins sessions and revenue, labels purchase vs non_purchase; visitor_totals: aggregates total pageviews per visitor, month, purchase_flag; monthly_avg_pageviews: computes average visitor pageviews by month and purchase_flag","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local244,local060,local075""}",2025-10-31T09:38:00
bq004,"In July 2017, among all visitors who bought any YouTube-related product, which distinct product—excluding those containing ‘YouTube’ in the product name—had the highest total quantity purchased?",false,false,false,false,true,azure/o3,"local199,local310,local311,local023","july_items: extracts July 2017 ITEM hits with fullVisitorId, product_name, item_quantity; youtube_buyers: finds distinct visitors in july_items where product_name ILIKE '%YouTube%'; filtered_items: keeps july_items rows not containing 'YouTube' and belonging to youtube_buyers; product_totals: sums item_quantity per product_name within filtered_items; top_product: selects product_name with highest total_quantity from product_totals","july_items: extracts July 2017 ITEM hits with fullVisitorId, product_name, item_quantity; youtube_buyers: finds distinct visitors in july_items where product_name ILIKE '%YouTube%'; filtered_items: keeps july_items rows not containing 'YouTube' and belonging to youtube_buyers; product_totals: sums item_quantity per product_name within filtered_items; top_product: selects product_name with highest total_quantity from product_totals","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local310,local311,local023""}",2025-10-31T09:38:17
bq008,"In January 2017, among visitors whose campaign name contains 'Data Share' and who accessed any page starting with '/home', which page did they most commonly visit next, and what is the maximum time (in seconds) they spent on the '/home' page before moving on?",false,false,false,false,true,azure/o3,"local311,local037,local077,local310","campaign_sessions: January 2017 sessions whose trafficSource.campaign contains 'Data Share'; home_hits: pageview hits within campaign_sessions where pagePath starts with '/home', with hit order and time; transitions: adds next pageview path and seconds spent until next hit within same session; next_page_stats: counts transitions per next page and records max seconds_on_home; most_common_next: selects next page with highest transition count along with max seconds_on_home","campaign_sessions: January 2017 sessions whose trafficSource.campaign contains 'Data Share'; home_hits: pageview hits within campaign_sessions where pagePath starts with '/home', with hit order and time; transitions: adds next pageview path and seconds spent until next hit within same session; next_page_stats: counts transitions per next page and records max seconds_on_home; most_common_next: selects next page with highest transition count along with max seconds_on_home","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local311,local037,local077,local310""}",2025-10-31T09:38:35
bq269,"Between June 1, 2017, and July 31, 2017, consider only sessions that have non-null pageviews. Classify each session as ‘purchase’ if it has at least one transaction, or ‘non_purchase’ otherwise. For each month, sum each visitor’s total pageviews under each classification, then compute the average pageviews per visitor for both purchase and non-purchase groups in each month, and present the results side by side.",false,false,false,false,false,azure/o3,"local264,local026,local067,local015","filtered_sessions: selects sessions dated 2017-06-01 to 2017-07-31 with pageviews not null; classified_sessions: labels each session as 'purchase' if transactions>0 else 'non_purchase'; visitor_monthly_views: aggregates total pageviews per visitor, month, and purchase_flag; monthly_avg_views: computes average pageviews across visitors for each month and purchase_flag; pivot_avgs: reshapes monthly averages into side-by-side purchase and non_purchase columns","filtered_sessions: selects sessions dated 2017-06-01 to 2017-07-31 with pageviews not null; classified_sessions: labels each session as 'purchase' if transactions>0 else 'non_purchase'; visitor_monthly_views: aggregates total pageviews per visitor, month, and purchase_flag; monthly_avg_views: computes average pageviews across visitors for each month and purchase_flag; pivot_avgs: reshapes monthly averages into side-by-side purchase and non_purchase columns","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local026,local067,local015""}",2025-10-31T09:38:47
bq268,"Identify the longest number of days between the first visit and the last recorded event (either the last visit or the first transaction) for a user, where the last recorded event is associated with a mobile device. The last recorded event could either be the last visit or the first transaction, and you should focus on users whose last recorded event occurred on a mobile device.",false,false,false,false,false,azure/o3,"local196,local311,local157,local253","first_visit_dates: earliest visit date per user; last_visit_mobile: most recent visit date per user on mobile; first_txn_mobile: earliest transaction date per user on mobile; user_last_event: selects later of mobile last visit or first mobile transaction per user; day_gap: calculates days between first visit and chosen last event, preparing for max search","first_visit_dates: earliest visit date per user; last_visit_mobile: most recent visit date per user on mobile; first_txn_mobile: earliest transaction date per user on mobile; user_last_event: selects later of mobile last visit or first mobile transaction per user; day_gap: calculates days between first visit and chosen last event, preparing for max search","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local311,local157,local253""}",2025-10-31T09:39:04
bq270,"What were the monthly add-to-cart and purchase conversion rates, calculated as a percentage of pageviews on product details, from January to March 2017?",false,false,false,false,true,azure/o3,"local024,local244,local021,local228","q1_product_hits: unnests product hits Jan–Mar 2017 for action types 2,3,6 excluding impressions; detail_views: monthly count of product detail view hits; add_to_cart: monthly count of add-to-cart hits; purchases: monthly count of purchase hits; monthly_rates: joins monthly counts computing add-to-cart and purchase percentages of detail views","q1_product_hits: unnests product hits Jan–Mar 2017 for action types 2,3,6 excluding impressions; detail_views: monthly count of product detail view hits; add_to_cart: monthly count of add-to-cart hits; purchases: monthly count of purchase hits; monthly_rates: joins monthly counts computing add-to-cart and purchase percentages of detail views","{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local244,local021,local228""}",2025-10-31T09:39:15
bq275,Which visitor IDs belong to users whose first transaction occurred on a device explicitly labeled as 'mobile' on a later date than their first visit?,false,false,false,false,false,azure/o3,"local003,local253,local010,local099",first_visit: earliest visit_date per visitor_id; first_mobile_txn: earliest transaction_date per visitor_id on device 'mobile'; qualified_visitors: visitor_ids where first_mobile_txn_date occurs after first_visit_date,first_visit: earliest visit_date per visitor_id; first_mobile_txn: earliest transaction_date per visitor_id on device 'mobile'; qualified_visitors: visitor_ids where first_mobile_txn_date occurs after first_visit_date,"{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local253,local010,local099""}",2025-10-31T09:39:22
bq374,"Calculates the percentage of new users who, between August 1, 2016, and April 30, 2017, both stayed on the site for more than 5 minutes during their initial visit and made a purchase on a subsequent visit at any later time, relative to the total number of new users in the same period.",false,false,false,false,false,azure/o3,"local196,local064,local194,local097",first_visits: earliest visit per user with timestamp and duration; new_users: first_visits occurring between 2016-08-01 and 2017-04-30; long_first_visits: new_users with initial visit duration over 300 seconds; post_visit_purchases: users having any purchase after their first visit timestamp; qualified_users: intersection of long_first_visits and post_visit_purchases; summary_stats: counts new_users and qualified_users and derives percentage,first_visits: earliest visit per user with timestamp and duration; new_users: first_visits occurring between 2016-08-01 and 2017-04-30; long_first_visits: new_users with initial visit duration over 300 seconds; post_visit_purchases: users having any purchase after their first visit timestamp; qualified_users: intersection of long_first_visits and post_visit_purchases; summary_stats: counts new_users and qualified_users and derives percentage,"{""target_db"": ""ga360"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local064,local194,local097""}",2025-10-31T09:39:35
bq019,"In the 2014 CMS Medicare inpatient charges data, which DRG definition has the highest total number of discharges, and among the top three cities with the most discharges for that DRG definition, what are their respective weighted average total payments (weighted by total discharges)",false,false,false,false,false,azure/o3,"local283,local017,local311,local015",drg_discharges: sums total_discharges per DRG across dataset; top_drg: selects DRG with maximum total discharges; drg_city_rows: filters records to only the top DRG; city_payment_stats: aggregates per city total discharges and weighted average total payments; top_three_cities: ranks cities by discharges and keeps top three,drg_discharges: sums total_discharges per DRG across dataset; top_drg: selects DRG with maximum total discharges; drg_city_rows: filters records to only the top DRG; city_payment_stats: aggregates per city total discharges and weighted average total payments; top_three_cities: ranks cities by discharges and keeps top three,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local017,local311,local015""}",2025-10-31T09:39:46
bq234,What is the most prescribed medication in each state in 2014?,false,false,false,false,false,azure/o3,"local075,local283,local032,local264",prescriptions_2014: filters prescription records to year 2014; state_med_counts: counts prescriptions per medication within each state for 2014; top_med_per_state: ranks counts and selects highest per state,prescriptions_2014: filters prescription records to year 2014; state_med_counts: counts prescriptions per medication within each state for 2014; top_med_per_state: ranks counts and selects highest per state,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local283,local032,local264""}",2025-10-31T09:39:52
bq235,Can you tell me which healthcare provider incurs the highest combined average costs for both outpatient and inpatient services in 2014?,false,false,false,false,false,azure/o3,"local219,local283,local026,local064","claims_2014: selects service records dated in 2014; avg_costs_by_type: computes average cost per provider and service_type; combined_avgs: merges outpatient and inpatient averages, deriving combined_average per provider; top_provider: orders providers by combined_average descending, returning highest","claims_2014: selects service records dated in 2014; avg_costs_by_type: computes average cost per provider and service_type; combined_avgs: merges outpatient and inpatient averages, deriving combined_average per provider; top_provider: orders providers by combined_average descending, returning highest","{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local219,local283,local026,local064""}",2025-10-31T09:40:03
bq172,"For the drug with the highest total number of prescriptions in New York State during 2014, could you list the top five states with the highest total claim counts for this drug? Please also include their total claim counts and total drug costs. ",false,false,false,false,false,azure/o3,"local015,local075,local017,local059",ny_2014_drug_totals: sums 2014 claim counts per drug for New York; top_ny_drug: picks drug with max New York claims; drug_state_totals_2014: aggregates 2014 claim counts and costs per state for that drug; top5_states: selects five states with highest claim totals,ny_2014_drug_totals: sums 2014 claim counts per drug for New York; top_ny_drug: picks drug with max New York claims; drug_state_totals_2014: aggregates 2014 claim counts and costs per state for that drug; top5_states: selects five states with highest claim totals,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local075,local017,local059""}",2025-10-31T09:40:15
bq177,"For the provider whose total inpatient Medicare cost from 2011 through 2015 is the highest (computed as the sum of average_medicare_payments multiplied by total_discharges), please list that provider’s yearly average inpatient cost and yearly average outpatient cost for each calendar year in this period, where the inpatient cost is calculated as the average of (average_medicare_payments × total_discharges) and the outpatient cost is calculated as the average of (average_total_payments × outpatient_services).",false,false,false,false,false,azure/o3,"local017,local064,local301,local032",inpatient_yrs: selects 2011-2015 inpatient rows adding cost_medicare as average_medicare_payments*total_discharges; inpatient_provider_totals: sums cost_medicare across years per provider; top_provider: picks provider with highest total inpatient cost; yearly_inpatient_avg: averages cost_medicare per year for top_provider; outpatient_yrs: selects 2011-2015 outpatient rows adding cost_total as average_total_payments*outpatient_services; yearly_outpatient_avg: averages cost_total per year for top_provider; combined_yearly_costs: merges yearly inpatient and outpatient averages for final display,inpatient_yrs: selects 2011-2015 inpatient rows adding cost_medicare as average_medicare_payments*total_discharges; inpatient_provider_totals: sums cost_medicare across years per provider; top_provider: picks provider with highest total inpatient cost; yearly_inpatient_avg: averages cost_medicare per year for top_provider; outpatient_yrs: selects 2011-2015 outpatient rows adding cost_total as average_total_payments*outpatient_services; yearly_outpatient_avg: averages cost_total per year for top_provider; combined_yearly_costs: merges yearly inpatient and outpatient averages for final display,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local064,local301,local032""}",2025-10-31T09:40:33
bq354,"Could you provide the percentage of participants for standard acne, atopic dermatitis, psoriasis, and vitiligo as defined by the International Classification of Diseases 10-CM (ICD-10-CM), including their subcategories? Please include all related concepts mapped to the standard ICD-10-CM codes (L70 for acne, L20 for atopic dermatitis, L40 for psoriasis, and L80 for vitiligo) by utilizing concept relationships, including descendant concepts. The percentage should be calculated based on the total number of participants, considering only the standard concepts and their related descendants.",false,false,false,false,false,azure/o3,"local229,local099,local157,local199",base_icd10_codes: retrieve standard concept_ids for root ICD-10-CM codes L70 L20 L40 L80; descendant_concepts: list each root code’s standard descendants via concept_ancestor; condition_patient_counts: count distinct participants per root code using condition_occurrence and descendant set; total_participants: count all distinct participants from person table; percent_of_participants: calculate percentage per root code using patient counts over total participants,base_icd10_codes: retrieve standard concept_ids for root ICD-10-CM codes L70 L20 L40 L80; descendant_concepts: list each root code’s standard descendants via concept_ancestor; condition_patient_counts: count distinct participants per root code using condition_occurrence and descendant set; total_participants: count all distinct participants from person table; percent_of_participants: calculate percentage per root code using patient counts over total participants,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local229,local099,local157,local199""}",2025-10-31T09:40:46
bq355,Please tell me the percentage of participants not using quinapril and related medications(Quinapril RxCUI: 35208).,false,false,false,false,false,azure/o3,"local056,local201,local194,local023",related_rxcuis: retrieves quinapril RxCUI 35208 plus descendant or synonymous RxCUIs; quinapril_exposures: filters medication records for RxCUIs in related_rxcuis; quinapril_users: selects distinct participant_ids with quinapril_exposures; total_participants: counts all distinct participant_ids in study; non_use_percentage: calculates percentage of participants absent from quinapril_users out of total_participants,related_rxcuis: retrieves quinapril RxCUI 35208 plus descendant or synonymous RxCUIs; quinapril_exposures: filters medication records for RxCUIs in related_rxcuis; quinapril_users: selects distinct participant_ids with quinapril_exposures; total_participants: counts all distinct participant_ids in study; non_use_percentage: calculates percentage of participants absent from quinapril_users out of total_participants,"{""target_db"": ""cms_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local201,local194,local023""}",2025-10-31T09:40:57
bq032,Can you provide the latitude of the final coordinates for the hurricane that traveled the second longest distance in the North Atlantic during 2020?,false,false,false,false,true,azure/o3,"local075,local228,local064,local264",atlantic_2020_tracks: filters hurricane track records to 2020 North Atlantic basin; ordered_track_points: orders each storm's points chronologically and assigns sequence numbers; point_segments: joins consecutive ordered points to compute segment distances with ST_DISTANCE; storm_total_distance: aggregates segment distances per storm to get traveled distance; second_longest_storm: ranks storms by total distance and selects the second longest; storm_final_position: returns latitude of the last coordinate for the selected storm,atlantic_2020_tracks: filters hurricane track records to 2020 North Atlantic basin; ordered_track_points: orders each storm's points chronologically and assigns sequence numbers; point_segments: joins consecutive ordered points to compute segment distances with ST_DISTANCE; storm_total_distance: aggregates segment distances per storm to get traveled distance; second_longest_storm: ranks storms by total distance and selects the second longest; storm_final_position: returns latitude of the last coordinate for the selected storm,"{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local228,local064,local264""}",2025-10-31T09:41:11
bq119,"Please show information about the hurricane with the third longest total travel distance in the North Atlantic during 2020, including its travel coordinates, the cumulative travel distance (in kilometers) at each point, and the maximum sustained wind speed at those times.",false,false,false,false,true,azure/o3,"local283,local024,local244,local196","storm_tracks_2020: track points for North Atlantic storms in 2020; point_distances: great-circle distance between consecutive points per storm; storm_totals: summed segment distances for each storm in kilometers; third_longest_storm: storm with third greatest total travel distance; cumulative_path: coordinates, cumulative distance, and max sustained wind for the selected storm ordered chronologically","storm_tracks_2020: track points for North Atlantic storms in 2020; point_distances: great-circle distance between consecutive points per storm; storm_totals: summed segment distances for each storm in kilometers; third_longest_storm: storm with third greatest total travel distance; cumulative_path: coordinates, cumulative distance, and max sustained wind for the selected storm ordered chronologically","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local024,local244,local196""}",2025-10-31T09:41:22
bq419,"Which 5 states had the most storm events from 1980 to 1995, considering only the top 1000 states with the highest event counts each year? Please use state abbreviations.",false,false,false,false,false,azure/o3,"local228,local021,local301,local026",yearly_state_counts: counts events per state and year 1980–1995; top1000_by_year: retains states whose yearly counts rank in top 1000; period_totals: sums yearly counts per state across full period; top5_states: picks five states with highest summed counts,yearly_state_counts: counts events per state and year 1980–1995; top1000_by_year: retains states whose yearly counts rank in top 1000; period_totals: sums yearly counts per state across full period; top5_states: picks five states with highest summed counts,"{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local228,local021,local301,local026""}",2025-10-31T09:41:34
bq356,"Among all NOAA GSOD weather stations that recorded valid daily temperature data (non-missing temp, max, min) in 2019 and whose period of record began on or before January 1, 2000, and continued through at least June 30, 2019, how many of these stations achieved 90% or more of the maximum possible number of valid temperature-record days in 2019?",false,false,false,false,false,azure/o3,"local059,local026,local157,local010","station_metadata_filtered: selects stations with start_date ≤2000-01-01 and end_date ≥2019-06-30; valid_obs_2019: 2019 daily rows for these stations with non-null temp, max, min; station_valid_counts: counts distinct valid days per station in 2019; high_coverage_stations: keeps stations with valid_day_count ≥329 (≥90 % of 365)","station_metadata_filtered: selects stations with start_date ≤2000-01-01 and end_date ≥2019-06-30; valid_obs_2019: 2019 daily rows for these stations with non-null temp, max, min; station_valid_counts: counts distinct valid days per station in 2019; high_coverage_stations: keeps stations with valid_day_count ≥329 (≥90 % of 365)","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local026,local157,local010""}",2025-10-31T09:41:45
bq042,"Can you help me retrieve the average temperature, average wind speed, and precipitation for LaGuardia Airport in NYC on June 12 for each year from 2011 through 2020, specifically using the station ID 725030?",false,false,false,false,false,azure/o3,"local017,local059,local194,local130","station_data: filters observations for station 725030 between 2011-2020; jun12_data: selects only June 12 records from station_data; daily_metrics: aggregates per year average temperature, average wind speed, and total precipitation","station_data: filters observations for station 725030 between 2011-2020; jun12_data: selects only June 12 records from station_data; daily_metrics: aggregates per year average temperature, average wind speed, and total precipitation","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local059,local194,local130""}",2025-10-31T09:41:54
bq394,"What are the top 3 months between 2010 and 2014 with the smallest sum of absolute differences between the average air temperature, wet bulb temperature, dew point temperature, and sea surface temperature, including respective years and sum of differences? Please present the year and month in numerical format.",false,false,false,false,false,azure/o3,"local003,local097,local010,local067","period_data: filters readings to dates 2010-01-01 through 2014-12-31; monthly_means: averages air, wet_bulb, dew_point, sea_surface temps per year-month; monthly_similarity: sums absolute differences among the four monthly averages; top_months: selects three months with smallest difference sums including year, month, score","period_data: filters readings to dates 2010-01-01 through 2014-12-31; monthly_means: averages air, wet_bulb, dew_point, sea_surface temps per year-month; monthly_similarity: sums absolute differences among the four monthly averages; top_months: selects three months with smallest difference sums including year, month, score","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local097,local010,local067""}",2025-10-31T09:42:09
bq357,"What are the latitude and longitude coordinates and dates between 2005 and 2015 with the top 5 highest daily average wind speeds, excluding records with missing wind speed values? Using data from tables start with prefix ""icoads_core"".",false,false,false,false,false,azure/o3,"local059,local056,local264,local201","valid_obs_2005_2015: filters icoads_core records to 2005-2015 range and non-null wind_speed; daily_wind_avg: averages wind_speed per latitude, longitude, calendar date; top5_daily_wind: selects five highest daily averages with corresponding coords and date","valid_obs_2005_2015: filters icoads_core records to 2005-2015 range and non-null wind_speed; daily_wind_avg: averages wind_speed per latitude, longitude, calendar date; top5_daily_wind: selects five highest daily averages with corresponding coords and date","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local056,local264,local201""}",2025-10-31T09:42:18
bq181,"What percentage of weather stations recorded valid temperature data (with no missing or invalid values) for at least 90% of the days in 2022, where the temperature, maximum, and minimum values are neither NULL nor equal to 9999.9, and the station has a valid identifier (USAF code not equal to '999999'), out of all available stations in the NOAA GSOD database?",false,false,false,false,false,azure/o3,"local264,local097,local037,local283","obs_2022: filters 2022 GSOD records with USAF code not '999999'; valid_obs: keeps obs_2022 rows where temp, max, min are not null and not 9999.9; valid_counts: counts distinct valid days per station from valid_obs; qualifying_stations: selects stations with valid_day_count ≥ 0.9*365; all_stations: gathers distinct stations present in obs_2022 for denominator","obs_2022: filters 2022 GSOD records with USAF code not '999999'; valid_obs: keeps obs_2022 rows where temp, max, min are not null and not 9999.9; valid_counts: counts distinct valid days per station from valid_obs; qualifying_stations: selects stations with valid_day_count ≥ 0.9*365; all_stations: gathers distinct stations present in obs_2022 for denominator","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local097,local037,local283""}",2025-10-31T09:42:35
bq045,Which weather stations in Washington State recorded more than 150 rainy days in 2023 but fewer rainy days compared to 2022? Defining a “rainy day” as one having precipitation greater than zero millimeters and not equal to 99.99. Only include stations with valid precipitation data.,false,false,false,false,false,azure/o3,"local229,local003,local037,local253","wa_weather: Washington station records with precipitation not null and !=99.99; rainy_observations: flags precipitation>0 as rainy_day and extracts observation year; annual_rain_counts: totals rainy_day per station and year; year_comparison: joins 2022 and 2023 counts, keeps stations where 2023>150 and 2023<2022; qualified_stations: selects station identifiers and rainy-day counts for output","wa_weather: Washington station records with precipitation not null and !=99.99; rainy_observations: flags precipitation>0 as rainy_day and extracts observation year; annual_rain_counts: totals rainy_day per station and year; year_comparison: joins 2022 and 2023 counts, keeps stations where 2023>150 and 2023<2022; qualified_stations: selects station identifiers and rainy-day counts for output","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local229,local003,local037,local253""}",2025-10-31T09:42:50
bq290,"Can you calculate the difference in maximum temperature, minimum temperature, and average temperature between US and UK weather stations for each day in October 2023, using the date field, and excluding records with missing or invalid temperature values?",false,false,false,false,false,azure/o3,"local026,local003,local064,local067","valid_readings: selects US and UK rows in October 2023 with non-null numeric temperatures; station_daily: aggregates valid_readings to max, min, avg temperature per station, date; country_daily: aggregates station_daily to country-level daily max, min, avg temperature; us_uk_daily: self-joins country_daily to pair US and UK stats per date; temp_diffs: computes per-date differences between US and UK for max, min, avg temps","valid_readings: selects US and UK rows in October 2023 with non-null numeric temperatures; station_daily: aggregates valid_readings to max, min, avg temperature per station, date; country_daily: aggregates station_daily to country-level daily max, min, avg temperature; us_uk_daily: self-joins country_daily to pair US and UK stats per date; temp_diffs: computes per-date differences between US and UK for max, min, avg temps","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local003,local064,local067""}",2025-10-31T09:43:02
bq031,"Provide the daily weather data for Rochester from January 1 to March 31, 2019, including temperature (in Celsius), precipitation (in centimeters), and wind speed (in meters per second). For each variable, calculate the 8-day moving average (including the current day and the previous 7 days). Also, calculate the difference between the moving average on each day and the moving averages for the previous 1 to 8 days (i.e., lag1 to lag8). The result should include: The daily values for temperature, precipitation, and wind speed.The 8-day moving averages for each variable. The differences between the moving averages for each of the previous 1 to 8 days (e.g., the difference between today's moving average and the moving average from 1 day ago, from 2 days ago, and so on). Round all values to one decimal place. The data should be ordered by date, starting from January 9, 2019.",false,false,false,false,false,azure/o3,"local074,local219,local229,local003","raw_weather: selects Rochester weather data 2019-01-01 to 2019-03-31 with temperature, precipitation, wind speed; date_span: generates continuous daily date series for identical period; daily_weather: ensures one row per date by left joining date_span to raw_weather, retains original measurements; moving_avg_8d: adds 8-day rolling averages for each variable using window functions, rounded to one decimal; ma_lag_diffs: calculates lag1-lag8 differences between current moving average and prior values for each metric, rounded; final_output: selects daily readings, averages, differences, filters dates from 2019-01-09 onward, orders by date","raw_weather: selects Rochester weather data 2019-01-01 to 2019-03-31 with temperature, precipitation, wind speed; date_span: generates continuous daily date series for identical period; daily_weather: ensures one row per date by left joining date_span to raw_weather, retains original measurements; moving_avg_8d: adds 8-day rolling averages for each variable using window functions, rounded to one decimal; ma_lag_diffs: calculates lag1-lag8 differences between current moving average and prior values for each metric, rounded; final_output: selects daily readings, averages, differences, filters dates from 2019-01-09 onward, orders by date","{""target_db"": ""noaa_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local219,local229,local003""}",2025-10-31T09:43:24
bq392,"What are the top 3 dates in October 2009 with the highest average temperature for station number 723758, in the format YYYY-MM-DD?",false,false,false,false,false,azure/o3,"local075,local078,local067,local032",station_oct2009: filters observations for station 723758 during October 2009 with non-null temperatures; daily_avg: computes average temperature per YYYY-MM-DD date; top_3_dates: selects three dates with highest average temperature descending,station_oct2009: filters observations for station 723758 during October 2009 with non-null temperatures; daily_avg: computes average temperature per YYYY-MM-DD date; top_3_dates: selects three dates with highest average temperature descending,"{""target_db"": ""noaa_gsod"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local078,local067,local032""}",2025-10-31T09:43:33
bq208,"Can you provide weather stations within a 20-mile radius of Chappaqua, New York (Latitude: 41.197, Longitude: -73.764), and tell me the number of valid temperature observations they have recorded from 2011 to 2020, excluding any invalid or missing temperature data?",false,false,false,false,true,azure/o3,"local300,local026,local194,local141","chappaqua_pt: defines geography point for Chappaqua coordinates; nearby_stations: selects stations within 20-mile radius of Chappaqua point; valid_obs: filters 2011-2020 temperature readings with non-null, non-sentinel values for nearby stations; station_counts: counts valid observations per station and joins with station details","chappaqua_pt: defines geography point for Chappaqua coordinates; nearby_stations: selects stations within 20-mile radius of Chappaqua point; valid_obs: filters 2011-2020 temperature readings with non-null, non-sentinel values for nearby stations; station_counts: counts valid observations per station and joins with station details","{""target_db"": ""new_york_noaa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local026,local194,local141""}",2025-10-31T09:43:44
bq047,"Could you analyze the relationship between each complaint type and daily temperature in New York City, specifically using temperature data from LaGuardia (STN=725030) and JFK (STN=744860) airports for the 10 years starting in 2008, and then determine, for each complaint type that has more than 5000 total occurrences and shows a strong correlation (absolute value > 0.5) with temperature, the total number of complaints, the total number of days with valid temperature records, and the Pearson correlation coefficients (rounded to four decimals) between temperature and both the daily complaint count as well as the daily percentage of total complaints, excluding any days with missing or invalid temperature data (such as 9999.9)?",false,false,false,false,false,azure/o3,"local301,local228,local066,local099","weather_daily: extracts 2008-2017 daily mean temp for STN 725030 and 744860, removes 9999.9, averages stations per date; daily_complaints: aggregates 311 complaints by date and complaint_type within 2008-2017; high_volume_types: selects complaint_types with total occurrences over 5000 from daily_complaints totals; daily_metrics: filters daily_complaints to high_volume_types and adds daily_percent_of_total; temp_join: joins daily_metrics with weather_daily on date, keeping only rows with valid temperature; correlation_summary: computes Pearson correlation per complaint_type between temperature and daily count and percent, plus valid_day_count; strong_corr_types: filters correlation_summary to abs(corr_count)>0.5, returns total_complaints, valid_days, rounded coefficients","weather_daily: extracts 2008-2017 daily mean temp for STN 725030 and 744860, removes 9999.9, averages stations per date; daily_complaints: aggregates 311 complaints by date and complaint_type within 2008-2017; high_volume_types: selects complaint_types with total occurrences over 5000 from daily_complaints totals; daily_metrics: filters daily_complaints to high_volume_types and adds daily_percent_of_total; temp_join: joins daily_metrics with weather_daily on date, keeping only rows with valid temperature; correlation_summary: computes Pearson correlation per complaint_type between temperature and daily count and percent, plus valid_day_count; strong_corr_types: filters correlation_summary to abs(corr_count)>0.5, returns total_complaints, valid_days, rounded coefficients","{""target_db"": ""new_york_noaa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local228,local066,local099""}",2025-10-31T09:44:12
bq048,"Which complaint types with more than 3000 total requests from 2011 to 2020 show the strongest positive and negative Pearson correlations with the daily average wind speed measured at station 744860 (JFK Airport), based on daily complaint proportions (the ratio of type-specific complaints to total daily complaints)? Please provide the complaint types and their correlation coefficients, rounded to four decimal places.",false,false,false,false,false,azure/o3,"local060,local075,local021,local003","complaints_2011_2020: filters complaints between 2011-01-01 and 2020-12-31, keeping complaint_date and complaint_type; daily_totals: aggregates filtered complaints per day for total daily count; daily_type_props: counts complaints per type per day, joins totals, keeps types with ≥3000 period requests, calculates daily proportion; wind_daily: selects daily average wind speed for station 744860 in same period; type_correlations: joins proportions with wind data, computing Pearson correlation per complaint_type; extreme_correlations: selects complaint types with max positive and min negative correlations, rounding coefficients to 4 decimals","complaints_2011_2020: filters complaints between 2011-01-01 and 2020-12-31, keeping complaint_date and complaint_type; daily_totals: aggregates filtered complaints per day for total daily count; daily_type_props: counts complaints per type per day, joins totals, keeps types with ≥3000 period requests, calculates daily proportion; wind_daily: selects daily average wind speed for station 744860 in same period; type_correlations: joins proportions with wind data, computing Pearson correlation per complaint_type; extreme_correlations: selects complaint types with max positive and min negative correlations, rounding coefficients to 4 decimals","{""target_db"": ""new_york_noaa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local075,local021,local003""}",2025-10-31T09:44:31
bq293,"I want to analyze New York City yellow taxi trip data specifically for January 1, 2015, using the bigquery-public-data.new_york.tlc_yellow_trips_2015 dataset. I need to join this with the geo_us_boundaries.zip_codes table to map each trip to its respective NYC zip code based on the pickup coordinates. The analysis should create a complete hour-by-hour breakdown for all zip codes by cross-joining distinct zip codes with distinct hours, including hours with zero trips. For each zip code and hour combination, calculate the total number of trips and the following time-based metrics: count of trips from 1 hour ago, 1 day (24 hours) ago, 7 days (168 hours) ago, and 14 days (336 hours) ago. Additionally, compute the 14-day and 21-day moving averages and standard deviations of trip counts, excluding the current hour. Only include trips with valid latitude and longitude coordinates. The final results should be sorted by the highest trip counts, showing only the top 5 groups with the most trips.",false,false,false,false,true,azure/o3,"local017,local010,local157,local194","filtered_trips: filters January 1 2015 trips with valid lat/lon, derives pickup_hour; zip_joined: assigns NYC zip_code to each trip using ST_CONTAINS on pickup point and zip polygon; hourly_trip_counts: counts trips grouped by zip_code and pickup_hour; zip_hour_complete: builds complete grid of distinct zip_codes and 24 hourly timestamps for Jan 1 2015; enriched_metrics: joins counts to grid, fills zeros, adds lag metrics and 14/21-day moving averages and stddev per zip_code; top_zip_hours: returns top 5 zip_code-hour rows sorted by highest current trip_count","filtered_trips: filters January 1 2015 trips with valid lat/lon, derives pickup_hour; zip_joined: assigns NYC zip_code to each trip using ST_CONTAINS on pickup point and zip polygon; hourly_trip_counts: counts trips grouped by zip_code and pickup_hour; zip_hour_complete: builds complete grid of distinct zip_codes and 24 hourly timestamps for Jan 1 2015; enriched_metrics: joins counts to grid, fills zeros, adds lag metrics and 14/21-day moving averages and stddev per zip_code; top_zip_hours: returns top 5 zip_code-hour rows sorted by highest current trip_count","{""target_db"": ""new_york_geo"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local010,local157,local194""}",2025-10-31T09:45:02
bq034,"I want to know the IDs, names of weather stations within a 50 km straight-line distance from the center of Chicago (41.8319°N, 87.6847°W)",false,false,false,false,false,azure/o3,"local201,local010,local130,local074","stations: select id, name, latitude, longitude from weather_stations; station_distances: compute haversine distance_km from Chicago center for each station; nearby_stations: keep records with distance_km <= 50","stations: select id, name, latitude, longitude from weather_stations; station_distances: compute haversine distance_km from Chicago center for each station; nearby_stations: keep records with distance_km <= 50","{""target_db"": ""ghcn_d"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local010,local130,local074""}",2025-10-31T09:45:09
bq383,"Could you provide the highest recorded precipitation, minimum temperature, and maximum temperature from the last 15 days of each year from 2013 to 2016 at weather station USW00094846? Ensure each value represents the peak measurement for that period, with precipitation in millimeters and temperatures in degrees Celsius, using only validated data (non-null values and no quality flags)",false,false,false,false,false,azure/o3,"local021,local023,local194,local310","year_end_days: enumerates dates falling in the final 15 calendar days of each year 2013-2016; station_obs: retrieves USW00094846 readings on year_end_days; validated_obs: filters non-null values and removes rows with any quality flags; unit_converted: standardizes precipitation to millimeters and temperatures to Celsius; yearly_peaks: aggregates per year, selecting max precipitation, min temperature, and max temperature","year_end_days: enumerates dates falling in the final 15 calendar days of each year 2013-2016; station_obs: retrieves USW00094846 readings on year_end_days; validated_obs: filters non-null values and removes rows with any quality flags; unit_converted: standardizes precipitation to millimeters and temperatures to Celsius; yearly_peaks: aggregates per year, selecting max precipitation, min temperature, and max temperature","{""target_db"": ""ghcn_d"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local023,local194,local310""}",2025-10-31T09:45:29
bq051,"Calculate the average daily number of Citibike trips in New York City during 2016, categorizing days as rainy if the total precipitation exceeds 5 millimeters (obtained by dividing the raw precipitation value by 10), and non-rainy otherwise. Use data from the nearest GHCN station located within 50 km of (40.7128, -74.0060) that has valid, unflagged measurements, then compare the resulting average Citibike trips on rainy days versus non-rainy days.",false,false,false,false,false,azure/o3,"local196,local310,local229,local301","stations_within_radius: selects GHCN stations within 50 km of NYC, adding haversine distance; nearest_station: picks closest station_id; daily_precip: aggregates unflagged 2016 PRCP for nearest_station, converts to millimeters; rainy_flags: labels each 2016 date as rainy if precip>5 mm else non_rainy; daily_trips: counts Citibike trips per date in 2016; rainy_averages: joins trips with flags and calculates average daily trips per category","stations_within_radius: selects GHCN stations within 50 km of NYC, adding haversine distance; nearest_station: picks closest station_id; daily_precip: aggregates unflagged 2016 PRCP for nearest_station, converts to millimeters; rainy_flags: labels each 2016 date as rainy if precip>5 mm else non_rainy; daily_trips: counts Citibike trips per date in 2016; rainy_averages: joins trips with flags and calculates average daily trips per category","{""target_db"": ""new_york_ghcn"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local310,local229,local301""}",2025-10-31T09:45:53
bq038,"Identify the top 10 Citibike stations by highest proportion of group rides, defined as trips starting and ending at the same station where multiple riders departed/arrived within the same 2-minute time window. Calculate the proportion as the number of trips that are part of a group divided by the total number of trips ending at that station.",false,false,false,false,false,azure/o3,"local157,local075,local130,local229",same_station_trips: filters rides where start_station_id equals end_station_id and adds 2-minute truncated start_time bucket; group_buckets: groups trips by station and bucket retaining buckets with count > 1 to signify group rides; group_trip_flags: joins qualifying buckets back to same_station_trips to label each trip as group ride; station_totals: aggregates total trips ending at each station from entire trip dataset; group_trip_counts: counts group-flagged trips per station; station_proportions: combines totals and group counts to compute group_trips/total_trips ratio; top10_stations: selects ten stations with highest group ride proportion descending,same_station_trips: filters rides where start_station_id equals end_station_id and adds 2-minute truncated start_time bucket; group_buckets: groups trips by station and bucket retaining buckets with count > 1 to signify group rides; group_trip_flags: joins qualifying buckets back to same_station_trips to label each trip as group ride; station_totals: aggregates total trips ending at each station from entire trip dataset; group_trip_counts: counts group-flagged trips per station; station_proportions: combines totals and group counts to compute group_trips/total_trips ratio; top10_stations: selects ten stations with highest group ride proportion descending,"{""target_db"": ""new_york"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local075,local130,local229""}",2025-10-31T09:46:18
bq053,"Calculate the change in the number of living trees of each fall color in New York City from 1995 to 2015 by computing, for each tree species, the difference between the number of trees not marked as dead in 1995 and the number of trees alive in 2015, matching species by the uppercase form of their scientific names from the tree_species table. Then, group the species by their fall color and sum these differences to determine the total change in the number of trees for each fall color.",false,false,false,false,false,azure/o3,"local219,local017,local077,local003","species_lookup: selects uppercase scientific_name and fall_color from tree_species; alive_trees: filters inventory to 1995 or 2015 rows not dead, adds uppercase scientific_name; yearly_counts: counts alive_trees per species and year; species_diff: pivots yearly_counts to compute 2015 minus 1995 difference per species; color_totals: joins species_diff with species_lookup and sums differences per fall_color","species_lookup: selects uppercase scientific_name and fall_color from tree_species; alive_trees: filters inventory to 1995 or 2015 rows not dead, adds uppercase scientific_name; yearly_counts: counts alive_trees per species and year; species_diff: pivots yearly_counts to compute 2015 minus 1995 difference per species; color_totals: joins species_diff with species_lookup and sums differences per fall_color","{""target_db"": ""new_york"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local219,local017,local077,local003""}",2025-10-31T09:46:30
bq054,"Please provide the top 10 tree species in New York, using their uppercase Latin names where the Latin name is not empty and including their common names, showing the total number of trees, the counts of alive and dead trees for each year, and the corresponding growth in these counts from 1995 to 2015, then order by the difference in total tree counts between these years.",false,false,false,false,false,azure/o3,"local310,local074,local021,local141","filtered_trees: filters New York records with uppercase non-empty Latin names; species_yearly_stats: aggregates total, alive, dead counts per species and year; growth_1995_2015: pivots 1995 and 2015 totals and computes differences; top10_species: selects 10 species with largest total count increase; top_species_yearly_stats: joins yearly stats with top species for final presentation","filtered_trees: filters New York records with uppercase non-empty Latin names; species_yearly_stats: aggregates total, alive, dead counts per species and year; growth_1995_2015: pivots 1995 and 2015 totals and computes differences; top10_species: selects 10 species with largest total count increase; top_species_yearly_stats: joins yearly stats with top species for final presentation","{""target_db"": ""new_york"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local074,local021,local141""}",2025-10-31T09:46:46
bq021,"For the top 20 Citi Bike routes in 2016, which route is faster than yellow taxis and among those, which one has the longest average bike duration? Please provide the start station name of this route. The coordinates are rounded to three decimals.",false,false,false,false,false,azure/o3,"local064,local199,local067,local066","bike_2016: select 2016 Citi Bike trips with start/end stations, rounded coords, duration; top_bike_routes: count trips per rounded coord pair and keep top 20; bike_avg_duration: calculate average bike duration for each top route; taxi_2016: select 2016 yellow taxi rides with rounded pickup/dropoff coords and duration; taxi_avg_duration: calculate average taxi duration for routes overlapping top bike routes; faster_routes: merge averages retaining routes where bike avg < taxi avg; longest_fast_route: pick faster-than-taxi route with highest bike average, return its start station name","bike_2016: select 2016 Citi Bike trips with start/end stations, rounded coords, duration; top_bike_routes: count trips per rounded coord pair and keep top 20; bike_avg_duration: calculate average bike duration for each top route; taxi_2016: select 2016 yellow taxi rides with rounded pickup/dropoff coords and duration; taxi_avg_duration: calculate average taxi duration for routes overlapping top bike routes; faster_routes: merge averages retaining routes where bike avg < taxi avg; longest_fast_route: pick faster-than-taxi route with highest bike average, return its start station name","{""target_db"": ""new_york"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local199,local067,local066""}",2025-10-31T09:46:59
bq202,"For the station that had the highest number of Citibike trips starting there in 2018, which numeric day of the week and which hour of the day had the greatest number of trips based on the start time of those trips?",false,false,false,false,false,azure/o3,"local017,local024,local219,local329",trips_2018: select trips where start_time is in 2018; station_usage: count trips per start_station_id from trips_2018; busiest_station: retain station with maximum trip count; busiest_trips: trips_2018 filtered to busiest_station; dow_counts: count busiest_trips by numeric day_of_week; hour_counts: count busiest_trips by hour_of_day; max_dow: select day_of_week with highest count; max_hour: select hour_of_day with highest count,trips_2018: select trips where start_time is in 2018; station_usage: count trips per start_station_id from trips_2018; busiest_station: retain station with maximum trip count; busiest_trips: trips_2018 filtered to busiest_station; dow_counts: count busiest_trips by numeric day_of_week; hour_counts: count busiest_trips by hour_of_day; max_dow: select day_of_week with highest count; max_hour: select hour_of_day with highest count,"{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local024,local219,local329""}",2025-10-31T09:47:19
bq185,"What is the average trip duration in minutes for all valid Yellow taxi trips that took place between February 1, 2016, and February 7, 2016 (inclusive), with a positive trip duration, more than three passengers, and a trip distance of at least ten miles, where both the pickup and dropoff locations are in Brooklyn?",false,false,false,false,false,azure/o3,"local032,local099,local201,local097",brooklyn_zone_ids: lists location IDs with borough 'Brooklyn'; target_week_trips: pulls rides Feb 1–7 2016 with >3 passengers and distance>=10; trips_with_duration: computes duration_minutes and retains positive values; brooklyn_trips: keeps trips whose pickup and dropoff IDs are in brooklyn_zone_ids for averaging duration,brooklyn_zone_ids: lists location IDs with borough 'Brooklyn'; target_week_trips: pulls rides Feb 1–7 2016 with >3 passengers and distance>=10; trips_with_duration: computes duration_minutes and retains positive values; brooklyn_trips: keeps trips whose pickup and dropoff IDs are in brooklyn_zone_ids for averaging duration,"{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local099,local201,local097""}",2025-10-31T09:47:36
bq040,"For NYC yellow taxi trips between January 1 and January 7, 2016, excluding any trips picked up in ‘EWR’ or ‘Staten Island,’ determine the proportion of rides that fall into each tip category in each pickup borough. Only include trips where the dropoff time is after the pickup time, the passenger count is greater than zero, and trip_distance, tip_amount, tolls_amount, mta_tax, fare_amount, and total_amount are all non-negative. Classify the tip percentage as follows: 0% (no tip), up to 5%, 5% to 10%, 10% to 15%, 15% to 20%, 20% to 25%, and more than 25%.",false,false,false,false,true,azure/o3,"local026,local253,local032,local021","filtered_trips: filters trips to Jan 1–7 2016, valid times, positive passengers, non-negative monetary fields, excluding EWR and Staten Island pickups; tip_bins: computes tip_rate as tip_amount over total_amount and categorizes into defined percentage bands; borough_category_counts: aggregates tip_bins by pickup borough and tip category, counting rides; borough_totals: sums total rides per pickup borough from tip_bins; proportions: joins counts and totals to derive each category’s ride proportion per borough","filtered_trips: filters trips to Jan 1–7 2016, valid times, positive passengers, non-negative monetary fields, excluding EWR and Staten Island pickups; tip_bins: computes tip_rate as tip_amount over total_amount and categorizes into defined percentage bands; borough_category_counts: aggregates tip_bins by pickup borough and tip category, counting rides; borough_totals: sums total rides per pickup borough from tip_bins; proportions: joins counts and totals to derive each category’s ride proportion per borough","{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local253,local032,local021""}",2025-10-31T09:48:01
bq098,"For NYC yellow taxi trips where both the pickup and dropoff occurred between January 1 and 7, 2016, inclusive, calculate the percentage of trips with no tip in each pickup borough, ensuring that only trips where the dropoff occurs after the pickup are included, the passenger count is greater than zero, and the trip distance, tip amount, tolls amount, MTA tax, fare amount, and total amount are non-negative; define ""no tip"" trips as those where the tip rate is zero, with the tip rate calculated as (tip_amount × 100) divided by total_amount (and considered zero when total_amount is zero).",false,false,false,false,true,azure/o3,"local141,local003,local097,local067","date_window_trips: filters yellow taxi trips where pickup and dropoff datetimes between 2016-01-01 and 2016-01-07 and dropoff > pickup; valid_trips: keeps date_window_trips with passenger_count >0 and non-negative trip_distance, tip_amount, tolls_amount, mta_tax, fare_amount, total_amount; tip_flagged: adds tip_rate (tip_amount*100/total_amount) handling zero denominator; marks no_tip when tip_rate = 0; pickup_boroughs: joins tip_flagged with taxi_zones on PULocationID to obtain pickup borough names; borough_summary: aggregates counts and calculates 100*no_tip/total percentage per pickup borough","date_window_trips: filters yellow taxi trips where pickup and dropoff datetimes between 2016-01-01 and 2016-01-07 and dropoff > pickup; valid_trips: keeps date_window_trips with passenger_count >0 and non-negative trip_distance, tip_amount, tolls_amount, mta_tax, fare_amount, total_amount; tip_flagged: adds tip_rate (tip_amount*100/total_amount) handling zero denominator; marks no_tip when tip_rate = 0; pickup_boroughs: joins tip_flagged with taxi_zones on PULocationID to obtain pickup borough names; borough_summary: aggregates counts and calculates 100*no_tip/total percentage per pickup borough","{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local003,local097,local067""}",2025-10-31T09:48:26
bq039,"Find the top 10 taxi trips in New York City between July 1 and July 7, 2016 (ensuring both pickup and dropoff times fall within these dates) where the passenger count is greater than five, the trip distance is at least ten miles, and there are no negative fare-related amounts (including tip, tolls, mta tax, fare, and total costs). Exclude any trips where the dropoff time is not strictly after the pickup time, then sort the results by total fare amount in descending order. Finally, display each trip’s pickup zone, dropoff zone, trip duration in seconds, driving speed in miles per hour, and tip rate as a percentage of the total fare amount.",false,false,false,false,false,azure/o3,"local026,local017,local023,local075","valid_trips: filters 1–7 July 2016 records, passenger_count >5, trip_distance>=10, dropoff>pickup, fare, tip, tolls, mta tax, total nonnegative; trip_metrics: joins valid_trips to taxi_zones for pickup/dropoff names, computes duration_seconds, speed_mph, tip_pct_of_total; top_fares: orders trip_metrics by total_amount desc, returns top 10 rows","valid_trips: filters 1–7 July 2016 records, passenger_count >5, trip_distance>=10, dropoff>pickup, fare, tip, tolls, mta tax, total nonnegative; trip_metrics: joins valid_trips to taxi_zones for pickup/dropoff names, computes duration_seconds, speed_mph, tip_pct_of_total; top_fares: orders trip_metrics by total_amount desc, returns top 10 rows","{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local017,local023,local075""}",2025-10-31T09:48:51
bq203,"For each New York City borough, how many subway stations are there in total, how many have at least one entrance that is marked both as an actual entry and as ADA-compliant, and what percentage of the total stations in each borough does this represent, listing boroughs from the highest to the lowest percentage?",false,false,false,false,false,azure/o3,"local075,local199,local301,local219","filtered_entrances: filters entrances with entry flag 'YES' and ADA compliant, retains station_id; ada_stations: selects distinct station_id from filtered_entrances; total_stations_per_borough: counts distinct station_id per borough from stations table; ada_stations_per_borough: joins ada_stations to stations, counts distinct ADA stations per borough; borough_ada_ratio: combines total and ADA counts, calculates percentage and orders boroughs descending","filtered_entrances: filters entrances with entry flag 'YES' and ADA compliant, retains station_id; ada_stations: selects distinct station_id from filtered_entrances; total_stations_per_borough: counts distinct station_id per borough from stations table; ada_stations_per_borough: joins ada_stations to stations, counts distinct ADA stations per borough; borough_ada_ratio: combines total and ADA counts, calculates percentage and orders boroughs descending","{""target_db"": ""new_york_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local199,local301,local219""}",2025-10-31T09:49:07
bq035,What is the total distance traveled by each bike in the San Francisco Bikeshare program? Use data from bikeshare trips and stations to calculate this.,false,false,false,false,false,azure/o3,"local003,local059,local060,local310","station_locations: fetches station_id, latitude, longitude from stations; trips_enriched: joins trips to station_locations twice to append start and end coords; trip_distances: computes haversine distance per trip, retains bike_id; bike_distance_totals: sums distances per bike_id for final output","station_locations: fetches station_id, latitude, longitude from stations; trips_enriched: joins trips to station_locations twice to append start and end coords; trip_distances: computes haversine distance per trip, retains bike_id; bike_distance_totals: sums distances per bike_id for final output","{""target_db"": ""san_francisco"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local059,local060,local310""}",2025-10-31T09:49:14
bq186,"Please find, for each year-month combination (in the format YYYYMM) derived from the start date of bike share trips in San Francisco, the first trip duration in minutes, the last trip duration in minutes, the highest trip duration in minutes, and the lowest trip duration in minutes, where ‘first’ and ‘last’ are determined by the chronological order of the trip start date, then group your results by this year-month and sort them by the same year-month key.",false,false,false,false,false,azure/o3,"local077,local066,local311,local264","trips_base: selects San Francisco bike trips, adds duration_minutes and year_month key; trips_ranked: assigns ascending and descending row_numbers per year_month to flag first and last trips; month_summary: aggregates per year_month to retrieve first, last, max, and min duration_minutes","trips_base: selects San Francisco bike trips, adds duration_minutes and year_month key; trips_ranked: assigns ascending and descending row_numbers per year_month to flag first and last trips; month_summary: aggregates per year_month to retrieve first, last, max, and min duration_minutes","{""target_db"": ""san_francisco"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local066,local311,local264""}",2025-10-31T09:49:21
bq081,"Find the latest ride data for each region between 2014 and 2017. I want to know the name of each region, the trip ID of this ride, the ride duration, the start time, the starting station, and the gender of the rider.",false,false,false,false,false,azure/o3,"local032,local075,local329,local199","rides_2014_17: filter rides to 2014-01-01 through 2017-12-31 with essential columns; latest_region_ride: pick most recent ride per region via row_number over start_time desc; ride_with_details: join latest_region_ride to regions, stations, and riders to add region name, station name, rider gender","rides_2014_17: filter rides to 2014-01-01 through 2017-12-31 with essential columns; latest_region_ride: pick most recent ride per region via row_number over start_time desc; ride_with_details: join latest_region_ride to regions, stations, and riders to add region name, station name, rider gender","{""target_db"": ""san_francisco_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local075,local329,local199""}",2025-10-31T09:49:29
bq339,"Which month in 2017 had the largest absolute difference between cumulative bike usage minutes for customers and subscribers?	Which month (in number) in 2017 had the largest absolute difference between cumulative bike usage minutes (in thousands) for customers and subscribers, based on the trip end dates in the San Francisco bikeshare data?",false,false,false,false,false,azure/o3,"local077,local157,local067,local023","filtered_trips: filters 2017 trips, computes duration_minutes and end_month; monthly_totals: sums duration_minutes per month and user_type, converting to thousands; month_diff: pairs customer and subscriber totals per month and calculates absolute difference; max_diff: picks month with maximum absolute difference","filtered_trips: filters 2017 trips, computes duration_minutes and end_month; monthly_totals: sums duration_minutes per month and user_type, converting to thousands; month_diff: pairs customer and subscriber totals per month and calculates absolute difference; max_diff: picks month with maximum absolute difference","{""target_db"": ""san_francisco_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local157,local067,local023""}",2025-10-31T09:49:38
bq400,"For trips where 'Clay St & Drumm St' occurs before 'Sacramento St & Davis St' in the stop sequence (one direction only), what are the earliest departure times from 'Clay St & Drumm St' and the latest arrival times at 'Sacramento St & Davis St' in the format HH:MM:SS? Please provide the trip headsign for each route.",false,false,false,false,false,azure/o3,"local244,local283,local196,local199","target_stops: maps stop names to stop_ids for Clay and Sacramento stops; clay_sac_sequences: collects each trip's stop_sequence, departure and arrival times at the two target stops; valid_trip_segments: pairs Clay and Sacramento records by trip, keeping only rows where Clay sequence precedes Sacramento; trip_route_times: aggregates earliest Clay departure and latest Sacramento arrival per trip, joins trips and routes for headsign","target_stops: maps stop names to stop_ids for Clay and Sacramento stops; clay_sac_sequences: collects each trip's stop_sequence, departure and arrival times at the two target stops; valid_trip_segments: pairs Clay and Sacramento records by trip, keeping only rows where Clay sequence precedes Sacramento; trip_route_times: aggregates earliest Clay departure and latest Sacramento arrival per trip, joins trips and routes for headsign","{""target_db"": ""san_francisco_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local283,local196,local199""}",2025-10-31T09:49:47
bq059,"What is the highest average speed (rounded to 1 decimal, in metric m/s) for bike trips in Berkeley with trip distance greater than 1000 meters?",false,false,false,false,false,azure/o3,"local130,local032,local059,local037",berkeley_long_trips: selects Berkeley trips where distance_meters > 1000 keeping distance and duration; trip_speeds: computes average_speed_mps per trip using distance/duration; top_speed: extracts and rounds highest average_speed_mps to 1 decimal,berkeley_long_trips: selects Berkeley trips where distance_meters > 1000 keeping distance and duration; trip_speeds: computes average_speed_mps per trip using distance/duration; top_speed: extracts and rounds highest average_speed_mps to 1 decimal,"{""target_db"": ""san_francisco_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local032,local059,local037""}",2025-10-31T09:49:54
bq376,"For each neighborhood in San Francisco where at least one bike share station and at least one crime incident are located, provide the neighborhood name along with the total count of bike share stations and the total number of crime incidents in that neighborhood.",false,false,false,false,false,azure/o3,"local074,local056,local078,local059","station_counts: counts bike share stations per San Francisco neighborhood; crime_counts: counts crime incidents per neighborhood; neighborhood_totals: joins counts, keeps neighborhoods with both, outputs station and incident totals","station_counts: counts bike share stations per San Francisco neighborhood; crime_counts: counts crime incidents per neighborhood; neighborhood_totals: joins counts, keeps neighborhoods with both, outputs station and incident totals","{""target_db"": ""san_francisco_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local056,local078,local059""}",2025-10-31T09:49:59
bq025,"Provide a list of the top 10 countries for the year 2020, ordered by the highest percentage of their population under 20 years old. For each country, include the total population under 20 years old, the total midyear population, and the percentage of the population that is under 20 years old.",false,false,false,false,false,azure/o3,"local074,local157,local015,local283",filtered_2020: filters population table for year 2020; under20_pop: aggregates population under age 20 by country; total_pop: aggregates total midyear population by country; country_stats: joins aggregates and calculates percentage under 20; top10: selects top ten countries by percentage descending,filtered_2020: filters population table for year 2020; under20_pop: aggregates population under age 20 by country; total_pop: aggregates total midyear population by country; country_stats: joins aggregates and calculates percentage under 20; top10: selects top ten countries by percentage descending,"{""target_db"": ""census_bureau_international"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local157,local015,local283""}",2025-10-31T09:50:10
bq115,Which country has the highest percentage of population under the age of 25 in 2017?,false,false,false,false,false,azure/o3,"local021,local067,local229,local077",age_2017: filters population dataset for 2017 records with age_group and population; under25_pop: sums population for age groups starting under 25 per country; total_pop_2017: sums total population across all ages per country; pct_under25: joins aggregates to compute under-25 percentage per country; top_country: selects country with highest under-25 percentage,age_2017: filters population dataset for 2017 records with age_group and population; under25_pop: sums population for age groups starting under 25 per country; total_pop_2017: sums total population across all ages per country; pct_under25: joins aggregates to compute under-25 percentage per country; top_country: selects country with highest under-25 percentage,"{""target_db"": ""census_bureau_international"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local067,local229,local077""}",2025-10-31T09:50:26
bq030,"As of May 10, 2020, among all countries that had more than 50,000 confirmed COVID-19 cases, which three countries had the highest recovery rates based on the total number of recovered cases relative to their total confirmed cases, and what were their respective recovery rates expressed as percentages?",false,false,false,false,false,azure/o3,"local283,local077,local010,local074",date_stats: filters dataset to May 10 2020 snapshot; country_totals: sums confirmed and recovered cases per country; eligible_countries: selects countries with confirmed cases over 50000 and adds recovery_rate percentage; top_recovery: ranks eligible countries by recovery_rate and retains top three,date_stats: filters dataset to May 10 2020 snapshot; country_totals: sums confirmed and recovered cases per country; eligible_countries: selects countries with confirmed cases over 50000 and adds recovery_rate percentage; top_recovery: ranks eligible countries by recovery_rate and retains top three,"{""target_db"": ""covid19_open_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local077,local010,local074""}",2025-10-31T09:50:33
bq018,Which day in March and April had the highest COVID-19 confirmed case growth rate in the United States? The format is MM-DD.,false,false,false,false,false,azure/o3,"local024,local219,local130,local059",us_daily_totals: aggregates total confirmed cases per date for United States; growth_rates: pairs each date with previous to calculate day-over-day growth rate; march_april: filters growth rates to March and April only; ranked_days: ranks filtered dates by growth rate descending to select top day,us_daily_totals: aggregates total confirmed cases per date for United States; growth_rates: pairs each date with previous to calculate day-over-day growth rate; march_april: filters growth rates to March and April only; ranked_days: ranks filtered dates by growth rate descending to select top day,"{""target_db"": ""covid19_open_data"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local219,local130,local059""}",2025-10-31T09:50:41
bq086,"You need to calculate the percentage of each country's population that had been confirmed with COVID-19 by June 30, 2020. The population data for 2018 can be found in the World Bank dataset, and the cumulative COVID-19 confirmed cases data is available in the COVID-19 Open Data dataset. Calculate the percentage of each country's population, that was cumulatively confirmed to have COVID-19",false,false,false,false,false,azure/o3,"local015,local078,local037,local228","population_2018: pulls 2018 total population per country; covid_cases_jun30: extracts cumulative confirmed cases per country for 2020-06-30; country_aliases: aligns country identifiers between datasets; infection_percentage: joins cases and population, computes confirmed cases percent of population","population_2018: pulls 2018 total population per country; covid_cases_jun30: extracts cumulative confirmed cases per country for 2020-06-30; country_aliases: aligns country identifiers between datasets; infection_percentage: joins cases and population, computes confirmed cases percent of population","{""target_db"": ""covid19_open_world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local078,local037,local228""}",2025-10-31T09:50:51
bq085,"Could you provide, for the United States, France, China, Italy, Spain, Germany, and Iran, the total number of confirmed COVID-19 cases as of April 20, 2020, along with the number of cases per 100,000 people based on their total 2020 populations calculated by summing all relevant population entries from the World Bank data",false,false,false,false,false,azure/o3,"local244,local060,local075,local010","target_countries: enumerates seven requested countries; covid_totals: confirmed cases on 2020-04-20 per target country; pop_totals_2020: total 2020 World Bank population per target country; country_metrics: joins cases and population, calculates cases_per_100k","target_countries: enumerates seven requested countries; covid_totals: confirmed cases on 2020-04-20 per target country; pop_totals_2020: total 2020 World Bank population per target country; country_metrics: joins cases and population, calculates cases_per_100k","{""target_db"": ""covid19_jhu_world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local060,local075,local010""}",2025-10-31T09:51:04
bq130,"Analyze daily new COVID-19 case counts from March to May 2020, identifying the top five states by daily increases. Please compile a ranking based on how often each state appears in these daily top fives. Then, examine the state that ranks fourth overall and identify its top five counties based on their frequency of appearing in the daily top five new case counts.",false,false,false,false,false,azure/o3,"local199,local021,local219,local066","filtered_cases: filters covid case data to March–May 2020, keeping date, state, county, new_cases; state_daily_totals: sums new_cases per state and date from filtered_cases; daily_state_top5: ranks states by daily_new_cases and retains top 5 per date; state_rankings: counts appearances of each state in daily_state_top5 and identifies the 4th-ranked state; county_daily_totals: aggregates new_cases per county and date for the 4th-ranked state; daily_county_top5: ranks counties by daily_new_cases within the state and keeps top 5 per date; county_rankings: counts appearances per county in daily_county_top5 and orders to find top 5 counties","filtered_cases: filters covid case data to March–May 2020, keeping date, state, county, new_cases; state_daily_totals: sums new_cases per state and date from filtered_cases; daily_state_top5: ranks states by daily_new_cases and retains top 5 per date; state_rankings: counts appearances of each state in daily_state_top5 and identifies the 4th-ranked state; county_daily_totals: aggregates new_cases per county and date for the 4th-ranked state; daily_county_top5: ranks counties by daily_new_cases within the state and keeps top 5 per date; county_rankings: counts appearances per county in daily_county_top5 and orders to find top 5 counties","{""target_db"": ""covid19_nyt"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local021,local219,local066""}",2025-10-31T09:51:29
bq087,"Please calculate the overall percentage change in the average weekly search frequency for the symptom 'Anosmia' across the five New York City counties—Bronx County, Queens County, Kings County, New York County, and Richmond County—by comparing the combined data from January 1, 2019, through December 31, 2019, with the combined data from January 1, 2020, through December 31, 2020.",false,false,false,false,false,azure/o3,"local310,local301,local010,local075",symptom_nyc: filters search data for 'Anosmia' in five NYC counties during 2019-2020; weekly_searches: sums filtered search frequency per ISO week across all counties; yearly_avg: calculates average weekly total for each year; pct_change: derives overall percentage change between 2019 and 2020 averages,symptom_nyc: filters search data for 'Anosmia' in five NYC counties during 2019-2020; weekly_searches: sums filtered search frequency per ISO week across all counties; yearly_avg: calculates average weekly total for each year; pct_change: derives overall percentage change between 2019 and 2020 averages,"{""target_db"": ""covid19_symptom_search"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local301,local010,local075""}",2025-10-31T09:51:36
bq088,"Please calculate the average levels of anxiety and depression symptoms from the weekly country data for the United States during the periods from January 1, 2019, to January 1, 2020, and from January 1, 2020, to January 1, 2021. Then, compute the percentage increase in these average symptom levels from the 2019 period to the 2020 period.",false,false,false,false,false,azure/o3,"local015,local021,local064,local074",us_weekly_data: filters to United States rows dated 2019-01-01 to 2021-01-01; labeled_periods: tags each week as 2019 or 2020 period; period_avgs: computes average anxiety and depression per period; pct_change: calculates percentage increase from 2019 to 2020 averages,us_weekly_data: filters to United States rows dated 2019-01-01 to 2021-01-01; labeled_periods: tags each week as 2019 or 2020 period; period_avgs: computes average anxiety and depression per period; pct_change: calculates percentage increase from 2019 to 2020 averages,"{""target_db"": ""covid19_symptom_search"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local021,local064,local074""}",2025-10-31T09:51:44
bq089,"Given the latest population estimates from the 2018 five-year American Community Survey, what is the number of vaccine sites per 1000 people for counties in California?",false,false,false,false,false,azure/o3,"local074,local075,local067,local201","ca_population_2018: pulls 2018 ACS 5-year total population for each California county; ca_vaccine_sites: selects vaccine site locations within California, with associated county identifiers; site_counts: aggregates count of vaccine sites per county; county_rates: joins site_counts to population to calculate sites per 1000 residents","ca_population_2018: pulls 2018 ACS 5-year total population for each California county; ca_vaccine_sites: selects vaccine site locations within California, with associated county identifiers; site_counts: aggregates count of vaccine sites per county; county_rates: joins site_counts to population to calculate sites per 1000 residents","{""target_db"": ""covid19_usa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local075,local067,local201""}",2025-10-31T09:51:52
bq407,"Find the top three counties with populations over 50,000, using the 2020 5-year census data, that had the highest COVID-19 case fatality rates on August 27, 2020. For these counties, provide the name, state, median age, total population, number of confirmed COVID-19 cases per 100,000 people, number of deaths per 100,000 people, and the case fatality rate as a percentage",false,false,false,false,false,azure/o3,"local077,local066,local074,local097","census_2020: filters 2020 ACS county demographics to pop>50000, keeping county_id, name, state, median_age, population; covid_aug27: extracts county confirmed cases and deaths for 2020-08-27; county_rates: joins census_2020 with covid_aug27, computes cases_per_100k, deaths_per_100k, case_fatality_pct; top3_cfr: selects top three counties by case_fatality_pct descending for final output","census_2020: filters 2020 ACS county demographics to pop>50000, keeping county_id, name, state, median_age, population; covid_aug27: extracts county confirmed cases and deaths for 2020-08-27; county_rates: joins census_2020 with covid_aug27, computes cases_per_100k, deaths_per_100k, case_fatality_pct; top3_cfr: selects top three counties by case_fatality_pct descending for final output","{""target_db"": ""covid19_usa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local066,local074,local097""}",2025-10-31T09:52:01
bq137,"Please find all zip code areas located within 10 kilometers of the coordinates (-122.3321, 47.6062) by joining the 2010 census population data (summing only male and female populations with no age constraints) and the zip code area information, and return each area’s polygon, land and water area in meters, latitude and longitude, state code, state name, city, county, and total population.",false,false,false,false,true,azure/o3,"local301,local017,local201,local074","ref_point: single-row CTE holding geography point; nearby_zips: zip polygons within 10km of ref_point; pop_totals_2010: sums 2010 male and female population per zip; zip_centroids: extracts centroid latitude and longitude for nearby_zips; enriched_zips: joins nearby_zips, pop_totals_2010, zip_centroids to output polygon, land_water_area, state, city, county, population","ref_point: single-row CTE holding geography point; nearby_zips: zip polygons within 10km of ref_point; pop_totals_2010: sums 2010 male and female population per zip; zip_centroids: extracts centroid latitude and longitude for nearby_zips; enriched_zips: joins nearby_zips, pop_totals_2010, zip_centroids to output polygon, land_water_area, state, city, county, population","{""target_db"": ""census_bureau_usa"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local017,local201,local074""}",2025-10-31T09:52:18
bq060,Which top 3 countries had the highest net migration in 2017 among those with an area greater than 500 square kilometers? And what are their migration rates?,false,false,false,false,false,azure/o3,"local003,local024,local099,local026","stats_2017: selects 2017 country records with net_migration, population, area; area_eligible: filters to area greater than 500 sq km; with_rate: adds migration_rate as net_migration divided by population; top3_countries: selects top 3 countries by net_migration, returning rate","stats_2017: selects 2017 country records with net_migration, population, area; area_eligible: filters to area greater than 500 sq km; with_rate: adds migration_rate as net_migration divided by population; top3_countries: selects top 3 countries by net_migration, returning rate","{""target_db"": ""census_bureau_international"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local024,local099,local026""}",2025-10-31T09:52:31
bq338,"Can you find the census tracts in the 36047 area that are among the top 20 for the largest percentage increases in population from 2011 to 2018, are also among the top 20 for the largest absolute increases in median income during the same period, and had over 1,000 residents in each of those years?",false,false,false,false,false,azure/o3,"local032,local329,local078,local066","base_stats: selects 2011 and 2018 population and median income for tracts in county 36047; population_growth: computes pop_2011, pop_2018, pct_growth and filters tracts with >1000 residents both years; income_growth: computes income_2011, income_2018, abs_income_change; top20_pct_pop: keeps 20 tracts with largest pct_growth; top20_abs_income: keeps 20 tracts with largest abs_income_change; qualifying_tracts: intersects both top lists, returning tracts meeting all criteria with growth metrics","base_stats: selects 2011 and 2018 population and median income for tracts in county 36047; population_growth: computes pop_2011, pop_2018, pct_growth and filters tracts with >1000 residents both years; income_growth: computes income_2011, income_2018, abs_income_change; top20_pct_pop: keeps 20 tracts with largest pct_growth; top20_abs_income: keeps 20 tracts with largest abs_income_change; qualifying_tracts: intersects both top lists, returning tracts meeting all criteria with growth metrics","{""target_db"": ""census_bureau_acs_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local329,local078,local066""}",2025-10-31T09:52:49
bq061,Which census tract has witnessed the largest increase in median income between 2015 and 2018 in California? Tell me the tract code.,false,false,false,false,false,azure/o3,"local064,local075,local010,local099",ca_years: filters census income records for California and years 2015 and 2018; tract_year_income: aggregates median income per tract per year; income_change: pivots 2015 and 2018 incomes per tract and computes increase; top_tract: selects tract with largest positive median-income increase,ca_years: filters census income records for California and years 2015 and 2018; tract_year_income: aggregates median income per tract per year; income_change: pivots 2015 and 2018 incomes per tract and computes increase; top_tract: selects tract with largest positive median-income increase,"{""target_db"": ""census_bureau_acs_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local075,local010,local099""}",2025-10-31T09:52:55
bq064,"Using the 2017 U.S. Census Tract data from the BigQuery public datasets, you need to proportionally allocate each tract's population and income to the zip codes based on the overlapping area between their geographic boundaries. Then, filter the results to include only those zip codes located within a 5-mile radius of a specific point in Washington State, with coordinates at latitude 47.685833°N and longitude -122.191667°W. Finally, calculate the total population and the average individual income for each zip code (rounded to one decimal place) and sort the results by the average individual income in descending order.",false,false,false,false,true,azure/o3,"local194,local199,local130,local003","census_tracts_2017: tract geometry, population, total income from 2017 Census dataset; zip_boundaries: zip code polygons and centroids from public boundary data; tract_zip_intersections: overlap area and proportion between tracts and zips; allocated_metrics: applies overlap proportion to allocate tract population and income to zips; nearby_zips: zips whose centroid lies within 5-mile radius of 47.685833 -122.191667; zip_level_stats: aggregates allocated values per zip, computes total population and rounded average income, sorted by income descending","census_tracts_2017: tract geometry, population, total income from 2017 Census dataset; zip_boundaries: zip code polygons and centroids from public boundary data; tract_zip_intersections: overlap area and proportion between tracts and zips; allocated_metrics: applies overlap proportion to allocate tract population and income to zips; nearby_zips: zips whose centroid lies within 5-mile radius of 47.685833 -122.191667; zip_level_stats: aggregates allocated values per zip, computes total population and rounded average income, sorted by income descending","{""target_db"": ""census_bureau_acs_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local199,local130,local003""}",2025-10-31T09:53:16
bq461,"Please provide a chronological summary of all scoring plays from the 2014 season game where the Wildcats were the home team and the Fighting Irish were the away team. Include for each scoring event the game clock, cumulative scores for both teams (Wildcats and Fighting Irish), the team that scored, and a description of the event.",false,false,false,false,false,azure/o3,"local060,local283,local219,local196","team_ids: retrieves ids for Wildcats and Fighting Irish; selected_game: selects 2014 game_id with Wildcats home and Fighting Irish away; scoring_events: pulls scoring plays for that game with clock, scorer, points, description; cumulative_scores: computes running totals per team over ordered scoring events","team_ids: retrieves ids for Wildcats and Fighting Irish; selected_game: selects 2014 game_id with Wildcats home and Fighting Irish away; scoring_events: pulls scoring plays for that game with clock, scorer, points, description; cumulative_scores: computes running totals per team over ordered scoring events","{""target_db"": ""ncaa_basketball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local283,local219,local196""}",2025-10-31T09:53:28
bq198,"List the top 5 universities with the most seasons where they achieved the maximum wins in their respective NCAA basketball seasons between 1900-2000, showing each team's total number of such peak-performance seasons, while excluding entries with missing team names.",false,false,false,false,false,azure/o3,"local201,local024,local021,local311",filtered_seasons: selects 1900–2000 season records with non-null university names and win totals; season_max_wins: finds maximum wins per season; season_leaders: keeps universities matching each season's maximum wins; team_season_counts: counts leader seasons per university; ranked_universities: orders universities by season count desc and limits to top five,filtered_seasons: selects 1900–2000 season records with non-null university names and win totals; season_max_wins: finds maximum wins per season; season_leaders: keeps universities matching each season's maximum wins; team_season_counts: counts leader seasons per university; ranked_universities: orders universities by season count desc and limits to top five,"{""target_db"": ""ncaa_basketball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local024,local021,local311""}",2025-10-31T09:53:35
bq462,"Please generate a table from the NCAA basketball dataset that lists the top five records in each of these four categories: (1) Top Venues - the largest venues by seating capacity with Date shown as 'N/A'; (2) Biggest Championship Margins - National Championship games since the 2016 season (season > 2015) with the biggest point margin victories; (3) Highest Scoring Games - games since the 2011 season (season > 2010) with the highest total points scored by both teams combined; and (4) Total Threes - games since the 2011 season (season > 2010) with the highest total three-pointers made by both teams combined. The final table should be organized with columns for Category, Date, Matchup or Venue, and Key Metric, with each category's 5 records presented in descending order of their key metric.",false,false,false,false,false,azure/o3,"local056,local300,local077,local067","venues_top5: selects five largest venues by capacity, sets category and date 'N/A'; champ_margins_top5: grabs post-2015 national championship games, computes victory margin, keeps top five; games_since_2011: filters season>2010 games, adds total_points, total_threes, matchup text; high_scores_top5: selects five highest total_points games, tags category; high_threes_top5: selects five highest total_threes games, tags category; final_rows: union all category tables and project Category, Date, Matchup_or_Venue, Key_Metric ordered per category","venues_top5: selects five largest venues by capacity, sets category and date 'N/A'; champ_margins_top5: grabs post-2015 national championship games, computes victory margin, keeps top five; games_since_2011: filters season>2010 games, adds total_points, total_threes, matchup text; high_scores_top5: selects five highest total_points games, tags category; high_threes_top5: selects five highest total_threes games, tags category; final_rows: union all category tables and project Category, Date, Matchup_or_Venue, Key_Metric ordered per category","{""target_db"": ""ncaa_basketball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local300,local077,local067""}",2025-10-31T09:53:58
bq427,"Could you determine, for each shot type, the average x and y coordinates (adjusted to ensure consistency regarding the left or right basket), the average number of shot attempts, and the average number of successful shots, considering only shots taken before March 15, 2018, excluding those with null shot types or coordinates, ensuring the shots are on the correct side of the court based on the team's basket.",false,false,false,false,true,azure/o3,"local141,local329,local026,local099","pre_2018_shots: filters shots before 2018-03-15 with non-null shot_type and coordinates; correct_side: retains shots taken at team’s offensive basket side; adjusted_coords: computes basket-normalized x and y coordinates; game_level_counts: aggregates attempts and made counts per game and shot_type; shot_type_avgs: averages adjusted_x, adjusted_y, attempts, and made counts across games for each shot_type","pre_2018_shots: filters shots before 2018-03-15 with non-null shot_type and coordinates; correct_side: retains shots taken at team’s offensive basket side; adjusted_coords: computes basket-normalized x and y coordinates; game_level_counts: aggregates attempts and made counts per game and shot_type; shot_type_avgs: averages adjusted_x, adjusted_y, attempts, and made counts across games for each shot_type","{""target_db"": ""ncaa_basketball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local329,local026,local099""}",2025-10-31T09:54:17
bq428,"For the top five team markets with the highest number of distinct players who scored at least 15 points during the second period of games between 2010 and 2018, provide details of each game they played in NCAA basketball historical tournament matches during the same period, as specified in the data model document.",false,false,false,false,true,azure/o3,"local070,local017,local066,local194","period_scorers: selects 2010-2018 player stats with period=2 and points≥15, adding team market and player id; market_player_counts: counts distinct scorers per market; top_markets: keeps five markets with highest scorer counts; tourney_games: pulls NCAA tournament games from 2010-2018 with both team and opponent details; target_games: filters tourney_games where either team market is in top_markets","period_scorers: selects 2010-2018 player stats with period=2 and points≥15, adding team market and player id; market_player_counts: counts distinct scorers per market; top_markets: keeps five markets with highest scorer counts; tourney_games: pulls NCAA tournament games from 2010-2018 with both team and opponent details; target_games: filters tourney_games where either team market is in top_markets","{""target_db"": ""ncaa_basketball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local070,local017,local066,local194""}",2025-10-31T09:54:26
bq144,"Create a dataset by combining NCAA men's basketball tournament game outcomes from the 2014 season onwards, including both the historical tournament games and the 2018 tournament results, with the corresponding pace and efficiency performance metrics for each team and their opponents from the feature_engineering data. The dataset should include the season, game outcome labels (win or loss), team and opponent seeds, school names, pace and efficiency rankings, statistical values, and the differences between the team's and the opponent's metrics to enable a comprehensive analysis of team and opponent dynamics.",false,false,false,false,true,azure/o3,"local300,local064,local078,local037","tourney_games: unions 2014-onward tournament match records including 2018 data with season, winners, losers, seeds, schools; expanded_outcomes: creates team-centric win/loss rows from each game with opponent info; team_metrics: pulls pace and efficiency stats per season and school from feature_engineering; games_with_stats: joins expanded outcomes with team and opponent metrics; feature_diffs: derives metric differences and outputs final analytical dataset","tourney_games: unions 2014-onward tournament match records including 2018 data with season, winners, losers, seeds, schools; expanded_outcomes: creates team-centric win/loss rows from each game with opponent info; team_metrics: pulls pace and efficiency stats per season and school from feature_engineering; games_with_stats: joins expanded outcomes with team and opponent metrics; feature_diffs: derives metric differences and outputs final analytical dataset","{""target_db"": ""ncaa_insights"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local064,local078,local037""}",2025-10-31T09:54:45
bq113,"Which county in Utah experienced the greatest percentage increase in construction employment from 2000 to 2018, calculated by averaging the employment levels during the third month of each quarter in those years? What is the corresponding percentage increase?",false,false,false,false,false,azure/o3,"local130,local097,local264,local021",utah_construct_months: filter to Utah construction records for March June Sept Dec in 2000 and 2018; yearly_avg: average employment per county and year from quarterly third-month values; year_comparison: join 2018 and 2000 averages per county; pct_growth: calculate percentage increase and keep county with highest growth,utah_construct_months: filter to Utah construction records for March June Sept Dec in 2000 and 2018; yearly_avg: average employment per county and year from quarterly third-month values; year_comparison: join 2018 and 2000 averages per county; pct_growth: calculate percentage increase and keep county with highest growth,"{""target_db"": ""bls"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local097,local264,local021""}",2025-10-31T09:54:54
bq112,"Between 1998 and 2017, for Allegheny County in the Pittsburgh area, did the average annual wages for all industries keep pace with the inflation of all consumer items, and what were the respective percentage growth rates (to two decimal places) for wages and the CPI over that period?",false,false,false,false,false,azure/o3,"local244,local021,local141,local075","wage_allegheny: Allegheny County average annual wage per year 1998-2017 for all industries; wage_growth: Selects 1998 and 2017 wage values, returning percent change rounded to two decimals; cpi_annual: Annual CPI All Items index values 1998-2017; cpi_growth: Selects 1998 and 2017 CPI values, returning percent change rounded to two decimals","wage_allegheny: Allegheny County average annual wage per year 1998-2017 for all industries; wage_growth: Selects 1998 and 2017 wage values, returning percent change rounded to two decimals; cpi_annual: Annual CPI All Items index values 1998-2017; cpi_growth: Selects 1998 and 2017 CPI values, returning percent change rounded to two decimals","{""target_db"": ""bls"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local021,local141,local075""}",2025-10-31T09:55:10
bq055,"Can you provide the top three races with the largest percentage differences between Google's 2021 overall hiring data from dar non intersectional hiring and the average percentages in the 2021 BLS data for the technology sectors specifically defined as 'Internet publishing and broadcasting and web search portals,' 'Software publishers,' 'Data processing, hosting, and related services,' or the industry group 'Computer systems design and related services,' along with their respective differences?",false,false,false,false,false,azure/o3,"local219,local329,local300,local060","google_hiring_2021: pulls 2021 overall DAR non-intersectional hiring percentages by race from Google data; bls_tech_2021: selects 2021 BLS employment shares for four specified tech NAICS sectors; bls_avg_by_race: computes average 2021 BLS percentage across selected tech sectors per race; race_differences: joins Google percentages to BLS averages, calculates signed and absolute differences; top_differences: ranks races by absolute difference and returns the top three","google_hiring_2021: pulls 2021 overall DAR non-intersectional hiring percentages by race from Google data; bls_tech_2021: selects 2021 BLS employment shares for four specified tech NAICS sectors; bls_avg_by_race: computes average 2021 BLS percentage across selected tech sectors per race; race_differences: joins Google percentages to BLS averages, calculates signed and absolute differences; top_differences: ranks races by absolute difference and returns the top three","{""target_db"": ""google_dei"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local219,local329,local300,local060""}",2025-10-31T09:55:25
bq075,"Could you provide a combined 2021 report comparing racial (Asian, Black, Hispanic/Latinx, White) and gender (U.S. Women, U.S. Men) distributions across Google’s overall workforce hiring, Google’s overall workforce representation, and the BLS data specifically for the technology sectors defined as Internet publishing and broadcasting and web search portals or Computer systems design and related services?",false,false,false,false,false,azure/o3,"local059,local064,local066,local311","google_hiring_2021: filters 2021 Google hiring data for specified race and gender categories; google_rep_2021: filters 2021 Google workforce representation data for same categories; bls_tech_2021: selects 2021 BLS rows for tech sector codes 51913 and 5415 with race/gender splits; bls_tech_agg: aggregates selected BLS sectors into overall tech distribution by race and gender; combined_distributions: unions Google hiring, Google representation, and aggregated BLS rows with standardized source, race, gender, percentage columns","google_hiring_2021: filters 2021 Google hiring data for specified race and gender categories; google_rep_2021: filters 2021 Google workforce representation data for same categories; bls_tech_2021: selects 2021 BLS rows for tech sector codes 51913 and 5415 with race/gender splits; bls_tech_agg: aggregates selected BLS sectors into overall tech distribution by race and gender; combined_distributions: unions Google hiring, Google representation, and aggregated BLS rows with standardized source, race, gender, percentage columns","{""target_db"": ""google_dei"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local064,local066,local311""}",2025-10-31T09:55:47
bq406,"Please calculate the growth rates for Asians, Black people, Latinx people, Native Americans, White people, US women, US men, global women, and global men from 2014 to 2024 concerning the overall workforce.",false,false,false,false,false,azure/o3,"local130,local017,local097,local026",filtered_data: selects 2014 and 2024 rows for specified demographic groups; group_counts: aggregates headcount per group and year; workforce_totals: totals overall workforce for 2014 and 2024; group_shares: computes workforce share for each group-year; growth_calc: calculates growth rate of shares from 2014 to 2024,filtered_data: selects 2014 and 2024 rows for specified demographic groups; group_counts: aggregates headcount per group and year; workforce_totals: totals overall workforce for 2014 and 2024; group_shares: computes workforce share for each group-year; growth_calc: calculates growth rate of shares from 2014 to 2024,"{""target_db"": ""google_dei"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local017,local097,local026""}",2025-10-31T09:55:58
bq022,"Calculate the minimum and maximum trip duration in minutes (rounded to the nearest whole number), total number of trips, and average fare for each of six equal quantile groups based on trip duration, considering only trips between 0 and 60 minutes.",false,false,false,false,false,azure/o3,"local026,local300,local070,local141","filtered_trips: selects trips with 0–60 minute durations, computes rounded duration_minutes and fare; trips_sextile: applies ntile(6) over duration to label sextile groups; sextile_stats: aggregates each sextile for min and max duration, trip count, and average fare","filtered_trips: selects trips with 0–60 minute durations, computes rounded duration_minutes and fare; trips_sextile: applies ntile(6) over duration to label sextile groups; sextile_stats: aggregates each sextile for min and max duration, trip count, and average fare","{""target_db"": ""chicago"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local300,local070,local141""}",2025-10-31T09:56:10
bq362,Which three companies had the largest increase in trip numbers between two consecutive months in 2018?,false,false,false,false,false,azure/o3,"local141,local060,local201,local021",monthly_trip_counts: counts trips per company per month in 2018; monthly_changes: calculates per-company change versus previous month using lag; max_increase_per_company: extracts each company’s greatest month-over-month trip rise; top_three_companies: keeps three companies with highest such increase,monthly_trip_counts: counts trips per company per month in 2018; monthly_changes: calculates per-company change versus previous month using lag; max_increase_per_company: extracts each company’s greatest month-over-month trip rise; top_three_companies: keeps three companies with highest such increase,"{""target_db"": ""chicago"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local060,local201,local021""}",2025-10-31T09:56:17
bq363,"Calculate the total number of trips and average fare (formatted to two decimal places) for ten equal-sized quantile groups. Each quantile group should contain approximately the same number of trips based on their rounded trip duration in minutes (between 1-50 minutes). Display each group's time range formatted as ""XXm to XXm"" (where the numbers are zero-padded to two digits), the total trips count, and the average fare. The time ranges should represent the minimum and maximum duration values within each quantile. Sort the results chronologically by time range. Use NTILE(10) to create the quantiles from the ordered trip durations.",false,false,false,false,false,azure/o3,"local017,local037,local157,local283","cleaned_trips: filters trips with 1–50 minute durations and adds rounded_duration; quantiled: assigns quantile_id with NTILE(10) over ordered rounded_duration; quantile_bounds: calculates min and max duration within each quantile_id; quantile_aggregates: counts trips and averages fare per quantile_id; formatted_output: formats time_range, rounds avg_fare to two decimals, orders chronologically","cleaned_trips: filters trips with 1–50 minute durations and adds rounded_duration; quantiled: assigns quantile_id with NTILE(10) over ordered rounded_duration; quantile_bounds: calculates min and max duration within each quantile_id; quantile_aggregates: counts trips and averages fare per quantile_id; formatted_output: formats time_range, rounds avg_fare to two decimals, orders chronologically","{""target_db"": ""chicago"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local037,local157,local283""}",2025-10-31T09:56:31
bq076,What is the highest number of motor vehicle theft incidents that occurred in any single month during 2016?,false,false,false,false,false,azure/o3,"local301,local157,local032,local021","mv_theft_2016: filters 2016 motor vehicle theft incidents, extracts month; monthly_counts: counts incidents grouped by month; max_monthly_incidents: retrieves maximum monthly count","mv_theft_2016: filters 2016 motor vehicle theft incidents, extracts month; monthly_counts: counts incidents grouped by month; max_monthly_incidents: retrieves maximum monthly count","{""target_db"": ""chicago"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local157,local032,local021""}",2025-10-31T09:56:38
bq077,"For each year from 2010 to 2016, what is the highest number of motor thefts in one month?",false,false,false,false,false,azure/o3,"local077,local310,local074,local311",motor_theft_filtered: filters records to motor thefts between 2010-2016; monthly_theft_counts: counts motor theft incidents per year-month; yearly_peak_counts: selects maximum monthly count per year,motor_theft_filtered: filters records to motor thefts between 2010-2016; monthly_theft_counts: counts motor theft incidents per year-month; yearly_peak_counts: selects maximum monthly count per year,"{""target_db"": ""chicago"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local310,local074,local311""}",2025-10-31T09:56:44
bq350,"For the detailed molecule data, Please display the drug id, drug type and withdrawal status for approved drugs with a black box warning and known drug type among 'Keytruda', 'Vioxx', 'Premarin', and 'Humira'",false,false,false,false,false,azure/o3,"local301,local253,local099,local074","approved_molecules: filters molecule records to approved status; bb_warning_molecules: retains approved_molecules with black box warnings; target_drugs: selects id, drug_type, withdrawal_status for named drugs with non-null type","approved_molecules: filters molecule records to approved status; bb_warning_molecules: retains approved_molecules with black box warnings; target_drugs: selects id, drug_type, withdrawal_status for named drugs with non-null type","{""target_db"": ""open_targets_platform_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local253,local099,local074""}",2025-10-31T09:56:53
bq379,Which target approved symbol has the overall association score closest to the mean score for psoriasis?,false,false,false,false,false,azure/o3,"local032,local300,local075,local037",psoriasis_targets: fetches approved target symbols with their overall association scores for psoriasis; mean_overall_score: computes mean overall association score across psoriasis approved targets; closest_to_mean: finds target whose score has minimum absolute deviation from mean and returns symbol,psoriasis_targets: fetches approved target symbols with their overall association scores for psoriasis; mean_overall_score: computes mean overall association score across psoriasis approved targets; closest_to_mean: finds target whose score has minimum absolute deviation from mean and returns symbol,"{""target_db"": ""open_targets_platform_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local300,local075,local037""}",2025-10-31T09:57:04
bq078,Retrieve the approved symbol of target genes with the highest overall score that are associated with the disease 'EFO_0000676' from the data source 'IMPC'.,false,false,false,false,false,azure/o3,"local017,local141,local023,local253",disease_imp_assocs: filters IMPC associations for disease 'EFO_0000676'; highest_score: finds maximum overall score within disease_imp_assocs; top_gene_ids: keeps target gene ids matching highest_score; final_symbols: joins top_gene_ids to gene table to return approved symbols,disease_imp_assocs: filters IMPC associations for disease 'EFO_0000676'; highest_score: finds maximum overall score within disease_imp_assocs; top_gene_ids: keeps target gene ids matching highest_score; final_symbols: joins top_gene_ids to gene table to return approved symbols,"{""target_db"": ""open_targets_platform_2"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local141,local023,local253""}",2025-10-31T09:57:15
bq095,"Generate a list of drugs from the table containing molecular details that have completed clinical trials for pancreatic endocrine carcinoma, disease ID EFO_0007416. Please include each drug's name, the target approved symbol, and links to the relevant clinical trials.",false,false,false,false,false,azure/o3,"local196,local244,local037,local219","completed_disease_trials: selects trials with disease_id EFO_0007416 and status 'Completed'; drug_target_symbols: maps each drug_id to its approved target gene symbol; drug_trial_links: joins completed_disease_trials with drugs to list distinct trial identifiers per drug; drug_summary: aggregates drug name, target symbol, concatenated trial links for final result","completed_disease_trials: selects trials with disease_id EFO_0007416 and status 'Completed'; drug_target_symbols: maps each drug_id to its approved target gene symbol; drug_trial_links: joins completed_disease_trials with drugs to list distinct trial identifiers per drug; drug_summary: aggregates drug name, target symbol, concatenated trial links for final result","{""target_db"": ""open_targets_platform_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local244,local037,local219""}",2025-10-31T09:57:22
bq109,"Find the average, variance, max-min difference, and the QTL source(right study) of the maximum log2(h4/h3) for data where right gene id is ""ENSG00000169174"", h4 > 0.8, h3 < 0.02, reported trait includes ""lesterol levels"", right biological feature is ""IPSC"", and the variant is '1_55029009_C_T'.",false,false,false,false,false,azure/o3,"local066,local064,local301,local070","base_filtered: filters rows by gene, variant, feature, h4>0.8, h3<0.02, trait like '%lesterol levels%'; log_ratio_data: adds log2_ratio column computed as log2(h4/h3); study_enriched: joins log_ratio_data to study metadata to fetch qtl_source; stats_summary: calculates average, variance, and max_minus_min of log2_ratio; max_ratio_source: selects qtl_source from study_enriched row with highest log2_ratio","base_filtered: filters rows by gene, variant, feature, h4>0.8, h3<0.02, trait like '%lesterol levels%'; log_ratio_data: adds log2_ratio column computed as log2(h4/h3); study_enriched: joins log_ratio_data to study metadata to fetch qtl_source; stats_summary: calculates average, variance, and max_minus_min of log2_ratio; max_ratio_source: selects qtl_source from study_enriched row with highest log2_ratio","{""target_db"": ""open_targets_genetics_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local064,local301,local070""}",2025-10-31T09:57:35
bq090,How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?,false,false,false,false,false,azure/o3,"local077,local310,local157,local064","long_trades: filters trades to long side, keeping strategy and intrinsic_value; strategy_avgs: computes average intrinsic_value for feeling-lucky and momentum strategies; avg_diff: subtracts momentum average from feeling-lucky average to quantify difference","long_trades: filters trades to long side, keeping strategy and intrinsic_value; strategy_avgs: computes average intrinsic_value for feeling-lucky and momentum strategies; avg_diff: subtracts momentum average from feeling-lucky average to quantify difference","{""target_db"": ""CYMBAL_INVESTMENTS"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local310,local157,local064""}",2025-10-31T09:57:42
bq442,Please collect the information of the top 6 trade report with the highest closing prices. Refer to the document for all the information I want.,false,false,false,false,true,azure/o3,"local300,local064,local099,local021","exploded_sides: unnests Sides array to retrieve tradeDirection per trade; enriched_trades: selects core fields, maps algorithm prefix and computes tradeMultiplier; top6_closing: orders enriched_trades by closePrice desc and limits to six highest","exploded_sides: unnests Sides array to retrieve tradeDirection per trade; enriched_trades: selects core fields, maps algorithm prefix and computes tradeMultiplier; top6_closing: orders enriched_trades by closePrice desc and limits to six highest","{""target_db"": ""CYMBAL_INVESTMENTS"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local064,local099,local021""}",2025-10-31T09:57:50
bq079,"Considering only the latest evaluation group per state for the 'EXPCURR' evaluation type, determine which state has the highest total acreage of timberland and which has the highest total acreage of forestland. For timberland, include plots where the condition status code is 1, the reserved status code is 0, and the site productivity class code is between 1 and 6. For forestland, include plots where the condition status code is 1. Calculate the total acres by summing the adjusted expansion factors for macroplots and subplots, using their respective proportion bases ('MACR' for macroplots and 'SUBP' for subplots) and adjustment factors when greater than zero. For each category (timberland and forestland), provide the state code, evaluation group, state name, and the total acres for the state with the highest total acreage, considering only the latest evaluation group per state.",false,false,false,false,false,azure/o3,"local300,local329,local199,local017","latest_evals: selects latest evaluation_group per state with eval_type 'EXPCURR'; eligible_conditions: joins plots and conditions to latest_evals, keeps condition_status 1, flags timberland (reserved 0, site 1-6) and forestland; adjusted_acres: computes acres as expansion_factor * adjustment_factor when adjustment>0 else expansion_factor, summed separately for MACR and SUBP bases; state_category_totals: aggregates adjusted acres by state, evaluation_group, timberland vs forestland category; top_state_per_category: ranks states per category by acres and returns largest with state name and evaluation_group","latest_evals: selects latest evaluation_group per state with eval_type 'EXPCURR'; eligible_conditions: joins plots and conditions to latest_evals, keeps condition_status 1, flags timberland (reserved 0, site 1-6) and forestland; adjusted_acres: computes acres as expansion_factor * adjustment_factor when adjustment>0 else expansion_factor, summed separately for MACR and SUBP bases; state_category_totals: aggregates adjusted acres by state, evaluation_group, timberland vs forestland category; top_state_per_category: ranks states per category by acres and returns largest with state name and evaluation_group","{""target_db"": ""usfs_fia"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local329,local199,local017""}",2025-10-31T09:58:18
bq024,"For the year 2012, which top 10 evaluation groups have the largest subplot acres when considering only the condition with the largest subplot acres within each group? Please include the evaluation group, evaluation type, condition status code, evaluation description, state code, macroplot acres, and subplot acres.",false,false,false,false,false,azure/o3,"local078,local074,local157,local099","eval_2012: filters evaluations for 2012 and brings in condition acres, type, status, description, state; ranked_conditions: assigns row_number by subplot_acres desc within evaluation_group; largest_per_group: keeps rank 1 record per evaluation_group; top10_groups: orders largest_per_group by subplot_acres desc and selects top 10","eval_2012: filters evaluations for 2012 and brings in condition acres, type, status, description, state; ranked_conditions: assigns row_number by subplot_acres desc within evaluation_group; largest_per_group: keeps rank 1 record per evaluation_group; top10_groups: orders largest_per_group by subplot_acres desc and selects top 10","{""target_db"": ""usfs_fia"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local074,local157,local099""}",2025-10-31T09:58:27
bq220,"Based on the condition, plot_tree, and population tables in bigquery-public-data.usfs_fia, for the evaluation_type set to 'EXPCURR' and condition_status_code equal to 1, which states had the largest average subplot size and the largest average macroplot size, respectively, for each of the years 2015, 2016, and 2017? Please include the type of plot (subplot or macroplot), the specific year, the state, and the corresponding average size in your results.",false,false,false,false,true,azure/o3,"local310,local078,local157,local075","filtered_condition: filters condition to EXPCURR, status 1, years 2015-2017 keeping size inputs; size_metrics: computes subplot_size and macroplot_size using expansion factor, proportion, and adjustment rules; state_year_avg: averages subplot and macroplot sizes per state and year; top_subplot: selects state with max average subplot_size for each year; top_macroplot: selects state with max average macroplot_size for each year; combined_output: merges top states per plot type with labels for final reporting","filtered_condition: filters condition to EXPCURR, status 1, years 2015-2017 keeping size inputs; size_metrics: computes subplot_size and macroplot_size using expansion factor, proportion, and adjustment rules; state_year_avg: averages subplot and macroplot sizes per state and year; top_subplot: selects state with max average subplot_size for each year; top_macroplot: selects state with max average macroplot_size for each year; combined_output: merges top states per plot type with labels for final reporting","{""target_db"": ""usfs_fia"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local078,local157,local075""}",2025-10-31T09:58:41
bq096,"Determine which year had the earliest date after January on which more than 10 sightings of Sterna paradisaea were recorded north of 40 degrees latitude. For each year, find the first day after January with over 10 sightings of this species in that region, and identify the year whose earliest such date is the earliest among all years.",false,false,false,false,false,azure/o3,"local021,local264,local301,local037",species_region_filter: filters sightings for Sterna paradisaea north of 40° latitude and after January; daily_counts_over10: counts sightings per date from filter and keeps days with more than 10; first_day_per_year: selects earliest qualifying date per year; earliest_year: identifies year with the overall earliest such date,species_region_filter: filters sightings for Sterna paradisaea north of 40° latitude and after January; daily_counts_over10: counts sightings per date from filter and keeps days with more than 10; first_day_per_year: selects earliest qualifying date per year; earliest_year: identifies year with the overall earliest such date,"{""target_db"": ""gbif"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local264,local301,local037""}",2025-10-31T09:58:55
bq277,"Which single port, listed under region number '6585', is located within a U.S. state boundary and appears most frequently inside the geographic areas of named tropical storms with wind speeds of at least 35 knots in the North Atlantic basin, excluding those labeled 'NOT_NAMED'?",false,false,false,false,true,azure/o3,"local060,local003,local064,local196","ports_in_region: ports with region_number 6585 and point geometry; us_state_boundaries: polygon geographies of U.S. states; qualifying_ports: ports_in_region whose point lies within any state boundary; storm_areas: North Atlantic storms with wind>=35kts and name not 'NOT_NAMED', polygon geography per storm; port_storm_hits: port-storm pairs where qualifying_port lies within storm_areas polygon; port_hit_counts: aggregates storm hits per port and returns port with highest count","ports_in_region: ports with region_number 6585 and point geometry; us_state_boundaries: polygon geographies of U.S. states; qualifying_ports: ports_in_region whose point lies within any state boundary; storm_areas: North Atlantic storms with wind>=35kts and name not 'NOT_NAMED', polygon geography per storm; port_storm_hits: port-storm pairs where qualifying_port lies within storm_areas polygon; port_hit_counts: aggregates storm hits per port and returns port with highest count","{""target_db"": ""noaa_ports"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local003,local064,local196""}",2025-10-31T09:59:20
bq278,"Please provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels. For each state, include the total number of buildings available for solar installations, the average percentage of Google Maps area covered by Project Sunroof, the average percentage of that coverage which is suitable for solar, the total potential panel count, the total kilowatt capacity, the energy generation potential, the carbon dioxide offset, the current number of buildings with solar panels, and the gap in potential installations calculated by adjusting the total qualified buildings with the coverage and suitability percentages and subtracting the current installations.",false,false,false,false,false,azure/o3,"local264,local023,local199,local024","raw_zip: filters building_solar table to postal code granularity, joins state info; raw_tract: filters building_solar table to census tract granularity, joins state info; zip_state_metrics: aggregates raw_zip per state computing totals, averages, suitability-adjusted potential, and installation gap; tract_state_metrics: aggregates raw_tract per state computing same metrics; combined_levels: concatenates zip_state_metrics and tract_state_metrics with level column for final comparison","raw_zip: filters building_solar table to postal code granularity, joins state info; raw_tract: filters building_solar table to census tract granularity, joins state info; zip_state_metrics: aggregates raw_zip per state computing totals, averages, suitability-adjusted potential, and installation gap; tract_state_metrics: aggregates raw_tract per state computing same metrics; combined_levels: concatenates zip_state_metrics and tract_state_metrics with level column for final comparison","{""target_db"": ""sunroof_solar"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local023,local199,local024""}",2025-10-31T09:59:38
bq102,"Identify which start positions are associated with missense variants in the BRCA1 gene on chromosome 17, where the reference base is 'C' and the alternate base is 'T'. Using data from the gnomAD v2.1.1 version.",false,false,false,false,false,azure/o3,"local264,local301,local066,local067",chr17_c2t: filters gnomAD v2.1.1 variants to chr17 where ref_base='C' and alt_base='T'; missense_only: joins chr17_c2t to consequence data keeping consequence='missense_variant'; brca1_positions: filters missense_only for gene='BRCA1' and selects distinct start positions,chr17_c2t: filters gnomAD v2.1.1 variants to chr17 where ref_base='C' and alt_base='T'; missense_only: joins chr17_c2t to consequence data keeping consequence='missense_variant'; brca1_positions: filters missense_only for gene='BRCA1' and selects distinct start positions,"{""target_db"": ""gnomAD"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local301,local066,local067""}",2025-10-31T09:59:50
bq445,"Using the gnomAD v2.1.1 genomes data for chromosome 17, determine the smallest start position and largest end position of any variant whose nested VEP annotations contain the symbol 'BRCA1'. Then, for all variants whose positions fall within that gene region, retrieve the 'Protein_position' values only if the 'Consequence' includes 'missense_variant', sort them in ascending order by 'Protein_position', and finally output the first such result.",false,false,false,false,false,azure/o3,"local301,local026,local023,local228","brca1_variants: chr17 variants whose VEP annotations include gene symbol 'BRCA1', with start and end positions; brca1_region: calculates min start and max end coordinates across brca1_variants; region_variants: selects chr17 variants whose positions lie within brca1_region boundaries; vep_expanded: explodes VEP annotations of region_variants to separate rows with consequence and protein_position; missense_positions: filters vep_expanded for consequence containing 'missense_variant' and non-null protein_position, casting protein_position to integer; first_missense_pos: orders missense_positions ascending by protein_position and returns first record","brca1_variants: chr17 variants whose VEP annotations include gene symbol 'BRCA1', with start and end positions; brca1_region: calculates min start and max end coordinates across brca1_variants; region_variants: selects chr17 variants whose positions lie within brca1_region boundaries; vep_expanded: explodes VEP annotations of region_variants to separate rows with consequence and protein_position; missense_positions: filters vep_expanded for consequence containing 'missense_variant' and non-null protein_position, casting protein_position to integer; first_missense_pos: orders missense_positions ascending by protein_position and returns first record","{""target_db"": ""gnomAD"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local026,local023,local228""}",2025-10-31T10:00:10
bq103,"Generate summary statistics on genetic variants in the region between positions 55039447 and 55064852 on chromosome 1. This includes the number of variants, the total allele count, the total number of alleles, and distinct gene symbols (using Variant Effect Predictor, VEP, for gene annotation). Additionally, compute the density of mutations by dividing the length of the region by the number of variants.  Using data from the gnomAD v3 version.",false,false,false,false,false,azure/o3,"local064,local300,local032,local228","region_variants: selects gnomAD v3 variants on chr1 positions 55039447–55064852; vep_genes: obtains distinct gene symbols by joining region_variants with VEP annotations; aggregated_counts: aggregates variant count, summed allele_count and allele_number across region_variants; region_length: computes inclusive base pair length of specified genomic interval; density_calc: calculates mutation density as region_length divided by variant_count and assembles final statistics","region_variants: selects gnomAD v3 variants on chr1 positions 55039447–55064852; vep_genes: obtains distinct gene symbols by joining region_variants with VEP annotations; aggregated_counts: aggregates variant count, summed allele_count and allele_number across region_variants; region_length: computes inclusive base pair length of specified genomic interval; density_calc: calculates mutation density as region_length divided by variant_count and assembles final statistics","{""target_db"": ""gnomAD"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local300,local032,local228""}",2025-10-31T10:00:29
bq105,"According to the 2015 and 2016 accident and driver distraction, and excluding cases where the driver’s distraction status is recorded as 'Not Distracted,' 'Unknown if Distracted,' or 'Not Reported,' how many traffic accidents per 100,000 people were caused by driver distraction in each U.S. state for those two years, based on 2010 census population data, and which five states each year had the highest rates?",false,false,false,false,false,azure/o3,"local077,local067,local157,local141",filtered_accidents: selects 2015-2016 crashes where distraction status not in excluded categories; state_year_counts: totals distraction accidents per state and year; population_2010: retrieves 2010 census population per state; state_rates: joins counts to population and computes accidents per 100k residents; yearly_top5: ranks states by annual rate and selects top five per year,filtered_accidents: selects 2015-2016 crashes where distraction status not in excluded categories; state_year_counts: totals distraction accidents per state and year; population_2010: retrieves 2010 census population per state; state_rates: joins counts to population and computes accidents per 100k residents; yearly_top5: ranks states by annual rate and selects top five per year,"{""target_db"": ""nhtsa_traffic_fatalities_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local067,local157,local141""}",2025-10-31T10:00:46
bq108,"Within the 2015 dataset for accidents that occurred from January through August and involved more than one distinct person, what percentage of these accidents had more than one individual with a severe injury (injury severity = 4)",false,false,false,false,false,azure/o3,"local244,local078,local017,local130",date_filtered_records: accident–person rows from Jan–Aug 2015; accident_counts: per accident counts distinct persons and severe injuries; eligible_accidents: accidents with person_count > 1; severe_multi_accidents: eligible accidents with severe_injury_count > 1,date_filtered_records: accident–person rows from Jan–Aug 2015; accident_counts: per accident counts distinct persons and severe injuries; eligible_accidents: accidents with person_count > 1; severe_multi_accidents: eligible accidents with severe_injury_count > 1,"{""target_db"": ""nhtsa_traffic_fatalities"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local078,local017,local130""}",2025-10-31T10:00:56
bq067,"I want to create a labeled dataset from the National Highway Traffic Safety Administration traffic fatality data that predicts whether a traffic accident involving more than one distinct person results in more than one fatality, where the label is 1 if an accident has more than one person with an injury severity code of 4 (fatal injury) and 0 otherwise. For each accident, include the numeric predictors: state_number, the vehicle body_type, the number_of_drunk_drivers, the day_of_week, the hour_of_crash, and a binary indicator for whether the accident occurred in a work zone (1 if it is not “None,” otherwise 0). Also, engineer a feature for the average absolute difference between travel_speed and speed_limit per accident, only considering travel speeds up to 151 mph (excluding codes 997, 998, 999) and speed limits up to 80 mph (excluding codes 98, 99), and categorize this average speed difference into levels from 0 to 4 in 20 mph increments with lower bounds inclusive and upper bounds exclusive. Finally, only include accidents that involve more than one distinct person.",false,false,false,false,true,azure/o3,"local032,local099,local037,local253","person_counts: counts distinct persons per accident and fatalities with injury_severity 4; label_accidents: filters accidents with >1 person and sets label 1 when fatality count>1; drunk_driver_counts: counts distinct drunk drivers per accident from impairment data; avg_speed_diff: computes mean absolute travel_speed minus speed_limit per accident within valid bounds and bins into 20-mph categories 0-4; body_type_mode: selects most common vehicle body_type per accident; accident_base: retrieves state_number, day_of_week, hour_of_crash, work_zone flag per accident; model_dataset: joins all features and label into final training dataset","person_counts: counts distinct persons per accident and fatalities with injury_severity 4; label_accidents: filters accidents with >1 person and sets label 1 when fatality count>1; drunk_driver_counts: counts distinct drunk drivers per accident from impairment data; avg_speed_diff: computes mean absolute travel_speed minus speed_limit per accident within valid bounds and bins into 20-mph categories 0-4; body_type_mode: selects most common vehicle body_type per accident; accident_base: retrieves state_number, day_of_week, hour_of_crash, work_zone flag per accident; model_dataset: joins all features and label into final training dataset","{""target_db"": ""nhtsa_traffic_fatalities"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local099,local037,local253""}",2025-10-31T10:01:24
bq396,Which top 3 states had the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016? Please also provide the respective differences for each state.,false,false,false,false,false,azure/o3,"local032,local075,local021,local023","weekend_2016_accidents: filters 2016 weekend accidents, keeping state and weather_condition; weather_counts: counts accidents per state and weather from weekend_2016_accidents; state_diffs: pivots rainy and clear counts per state calculating absolute difference; top3_states: selects top three states by descending difference","weekend_2016_accidents: filters 2016 weekend accidents, keeping state and weather_condition; weather_counts: counts accidents per state and weather from weekend_2016_accidents; state_diffs: pivots rainy and clear counts per state calculating absolute difference; top3_states: selects top three states by descending difference","{""target_db"": ""nhtsa_traffic_fatalities"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local075,local021,local023""}",2025-10-31T10:01:38
bq441,"Please help me compile the critical details on traffic accidents in 2015, as listed in the info document.",false,false,false,false,true,azure/o3,"local310,local130,local199,local003","filtered_accidents: filters crash records to year 2015 with core accident identifiers and location attributes; time_delays: computes delay_to_scene and delay_to_hospital applying hour validity rules; person_enhancements: adds survived flag, restraint score, alcohol and drug indicators per individual; vehicle_enhancements: derives rollover, airbag deployment, speeding_related, capped collision and surface codes; accident_details: joins all 2015 accident, person, vehicle CTEs, selecting requested columns for final output","filtered_accidents: filters crash records to year 2015 with core accident identifiers and location attributes; time_delays: computes delay_to_scene and delay_to_hospital applying hour validity rules; person_enhancements: adds survived flag, restraint score, alcohol and drug indicators per individual; vehicle_enhancements: derives rollover, airbag deployment, speeding_related, capped collision and surface codes; accident_details: joins all 2015 accident, person, vehicle CTEs, selecting requested columns for final output","{""target_db"": ""nhtsa_traffic_fatalities"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local130,local199,local003""}",2025-10-31T10:01:53
bq097,"What is the increasing amount of the average earnings per job between the years 2012 and 2017 for each geographic region in Massachusetts (indicated by ""MA"" at the end of GeoName)?",false,false,false,false,false,azure/o3,"local201,local283,local067,local264","ma_regions: filter rows where GeoName ends with ' MA' and year in (2012,2017); yearly_avg: compute avg earnings_per_job per GeoName and year; paired_years: join 2012 and 2017 averages per GeoName; earnings_growth: derive increase amount and drop incomplete regions","ma_regions: filter rows where GeoName ends with ' MA' and year in (2012,2017); yearly_avg: compute avg earnings_per_job per GeoName and year; paired_years: join 2012 and 2017 averages per GeoName; earnings_growth: derive increase amount and drop incomplete regions","{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local283,local067,local264""}",2025-10-31T10:02:05
bq120,"Identify the top 10 regions (counties) with the highest total number of SNAP-participating households, using the 2017 5-year ACS county-level data and SNAP enrollment data from January 1, 2017, excluding regions where the total SNAP participation is zero. For each of these regions, calculate the ratio of households earning under $20,000 to the total number of SNAP-participating households.",false,false,false,false,false,azure/o3,"local130,local010,local311,local056",snap_daily_totals: aggregate SNAP-participating household counts by county for 2017-01-01 snapshot; snap_positive: filter snap_daily_totals to counties with total_snap > 0; acs_income_under20k: extract households earning under 20k from 2017 5-year ACS county data; county_snap_income: join snap_positive to acs_income_under20k and calculate under20k_to_snap_ratio; top10_snap_counties: pick top 10 counties ordered by total_snap with computed ratio,snap_daily_totals: aggregate SNAP-participating household counts by county for 2017-01-01 snapshot; snap_positive: filter snap_daily_totals to counties with total_snap > 0; acs_income_under20k: extract households earning under 20k from 2017 5-year ACS county data; county_snap_income: join snap_positive to acs_income_under20k and calculate under20k_to_snap_ratio; top10_snap_counties: pick top 10 counties ordered by total_snap with computed ratio,"{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local010,local311,local056""}",2025-10-31T10:02:24
bq110,What is the change in the number of homeless veterans between 2012 and 2018 for each CoC region in New York that has data available in both years?,false,false,false,false,false,azure/o3,"local070,local066,local244,local264","ny_yearly_vet_counts: filters New York CoC records for homeless veterans in 2012 and 2018, summing counts per coc_id and year; cocs_with_both_years: keeps coc_ids present in both years using HAVING count(distinct year)=2; pivot_counts: converts yearly rows into count_2012 and count_2018 columns per coc_id; change_by_coc: computes count_2018 minus count_2012 to show change per CoC","ny_yearly_vet_counts: filters New York CoC records for homeless veterans in 2012 and 2018, summing counts per coc_id and year; cocs_with_both_years: keeps coc_ids present in both years using HAVING count(distinct year)=2; pivot_counts: converts yearly rows into count_2012 and count_2018 columns per coc_id; change_by_coc: computes count_2018 minus count_2012 to show change per CoC","{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local070,local066,local244,local264""}",2025-10-31T10:02:34
bq395,"Calculate the percentage change in the total number of unsheltered homeless people from 2015 to 2018 for each state by summing the counts over all Continuums of Care (CoCs) within each state. Then, determine the national average of these state percentage changes. Identify the five states whose percentage change is closest to this national average percentage change. Please provide the state abbreviations.",false,false,false,false,false,azure/o3,"local059,local201,local024,local264",yearly_unsheltered: selects unsheltered counts for 2015 and 2018 and sums by state-year; state_pct_change: pivots yearly totals and calculates percent change 2015 to 2018 per state; national_avg_change: computes mean of all state percentage changes; state_variance: adds absolute deviation of each state change from national average; closest_states: orders states by deviation and returns five closest abbreviations,yearly_unsheltered: selects unsheltered counts for 2015 and 2018 and sums by state-year; state_pct_change: pivots yearly totals and calculates percent change 2015 to 2018 per state; national_avg_change: computes mean of all state percentage changes; state_variance: adds absolute deviation of each state change from national average; closest_states: orders states by deviation and returns five closest abbreviations,"{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local201,local024,local264""}",2025-10-31T10:02:46
bq352,Please list the average number of prenatal weeks in 2018 for counties in Wisconsin where more than 5% of the employed population had commutes of 45-59 minutes in 2017.,false,false,false,false,false,azure/o3,"local283,local301,local099,local032",wi_counties: selects Wisconsin county identifiers and names; commute_stats: computes 2017 percent of employed with 45-59 min commutes per WI county; qualifying_counties: filters commute_stats to counties with percentage >5; prenatal_avg_2018: calculates average prenatal weeks in 2018 for births in qualifying counties,wi_counties: selects Wisconsin county identifiers and names; commute_stats: computes 2017 percent of employed with 45-59 min commutes per WI county; qualifying_counties: filters commute_stats to counties with percentage >5; prenatal_avg_2018: calculates average prenatal weeks in 2018 for births in qualifying counties,"{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local301,local099,local032""}",2025-10-31T10:02:58
bq074,"Count the number of counties that experienced an increase in unemployment from 2015 to 2018, using 5-year ACS data, and a decrease in dual-eligible enrollee counts between December 1, 2015, and December 1, 2018.",false,false,false,false,false,azure/o3,"local099,local141,local244,local017",acs_unemployment: selects 2015 and 2018 unemployment rates per county from ACS 5-year; unemployment_change: pivots years and flags counties where 2018 rate > 2015; dual_enrollees: retrieves dual-eligible counts for 2015-12-01 and 2018-12-01; dual_change: pivots counts and flags counties where 2018 < 2015; qualified_counties: joins change flags and counts counties meeting both criteria,acs_unemployment: selects 2015 and 2018 unemployment rates per county from ACS 5-year; unemployment_change: pivots years and flags counties where 2018 rate > 2015; dual_enrollees: retrieves dual-eligible counts for 2015-12-01 and 2018-12-01; dual_change: pivots counts and flags counties where 2018 < 2015; qualified_counties: joins change flags and counts counties meeting both criteria,"{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local099,local141,local244,local017""}",2025-10-31T10:03:08
bq066,"Could you assess the relationship between the poverty rates from the previous year's census data and the percentage of births without maternal morbidity for the years 2016 to 2018? Use only data for births where no maternal morbidity was reported and for each year, use the 5-year census data from the year before to compute the Pearson correlation coefficient",false,false,false,false,false,azure/o3,"local078,local229,local329,local253","no_morb_births: filters 2016–2018 births, groups by region-year, counts total and no-morbidity births; birth_rates: calculates no-morbidity birth percentage per region-year; prior_census: selects 5-year poverty rates for 2015–2017 and labels analysis_year=census_year+1; combined_data: joins birth_rates with prior_census on region and analysis_year; yearly_correlation: computes Pearson correlation between poverty_rate and no_morbidity_percent for each analysis_year","no_morb_births: filters 2016–2018 births, groups by region-year, counts total and no-morbidity births; birth_rates: calculates no-morbidity birth percentage per region-year; prior_census: selects 5-year poverty rates for 2015–2017 and labels analysis_year=census_year+1; combined_data: joins birth_rates with prior_census on region and analysis_year; yearly_correlation: computes Pearson correlation between poverty_rate and no_morbidity_percent for each analysis_year","{""target_db"": ""sdoh"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local229,local329,local253""}",2025-10-31T10:03:26
bq114,"Which three cities have the largest difference between their 1990 EPA PM2.5 measurements (using units_of_measure = 'Micrograms/cubic meter (LC)' and parameter_name = 'Acceptable PM2.5 AQI & Speciation Mass') and their 2020 OpenAQ PM2.5 measurements (where pollutant = 'pm25' based on the year extracted from the timestamp), with both datasets matched by latitude and longitude rounded to two decimals, and the difference ordered from greatest to least?",false,false,false,false,false,azure/o3,"local074,local078,local201,local077","epa_1990_pm25: filter 1990 EPA PM2.5 with required units/parameter, round lat/lon, average measurement per city-location; openaq_2020_pm25: filter 2020 OpenAQ pm25 readings, round lat/lon, average measurement per city-location; matched_locs: join EPA and OpenAQ aggregates on rounded coordinates, keeping city and both averages; diffs_ranked: compute absolute difference between averages and order descending; top_three_cities: take first three cities with greatest differences","epa_1990_pm25: filter 1990 EPA PM2.5 with required units/parameter, round lat/lon, average measurement per city-location; openaq_2020_pm25: filter 2020 OpenAQ pm25 readings, round lat/lon, average measurement per city-location; matched_locs: join EPA and OpenAQ aggregates on rounded coordinates, keeping city and both averages; diffs_ranked: compute absolute difference between averages and order descending; top_three_cities: take first three cities with greatest differences","{""target_db"": ""openaq"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local078,local201,local077""}",2025-10-31T10:03:37
bq116,"Which U.S. state reported the highest total annual revenue in billions of dollars during fiscal year 2016, considering companies that provided four quarters of data and reported measure tags in ('Revenues','SalesRevenueNet','SalesRevenueGoodsNet'), excluding any entries where the state field (stprba) is null or empty?",false,false,false,false,false,azure/o3,"local194,local056,local021,local157",fy2016_measures: filter FY2016 rows with desired measure tags and non-empty stprba; full_year_companies: identify companies reporting all four quarters in fy2016_measures; valid_entries: keep fy2016_measures rows for full_year_companies; state_annual_revenue: sum revenue by state from valid_entries and convert to billions; max_state: select state with highest total annual revenue,fy2016_measures: filter FY2016 rows with desired measure tags and non-empty stprba; full_year_companies: identify companies reporting all four quarters in fy2016_measures; valid_entries: keep fy2016_measures rows for full_year_companies; state_annual_revenue: sum revenue by state from valid_entries and convert to billions; max_state: select state with highest total annual revenue,"{""target_db"": ""sec_quarterly_financials"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local056,local021,local157""}",2025-10-31T10:03:48
bq015,"Identify and rank the top 10 tags from Stack Overflow questions that were referenced in Hacker News comments on or after 2014 by counting how many times each question was mentioned, then splitting the questions’ tag strings by the '|' delimiter, grouping by tag",false,false,false,false,false,azure/o3,"local017,local074,local059,local032","hn_comments_2014_plus: selects Hacker News comments dated >=2014; so_question_links: extracts Stack Overflow question_id from comment text, one row per mention; question_mention_counts: counts mentions per question_id; question_tags: fetches tag string for mentioned questions; tag_split: splits pipe-delimited tags into individual tag rows with mention counts; tag_rankings: aggregates mentions per tag, orders by count desc, selects top 10","hn_comments_2014_plus: selects Hacker News comments dated >=2014; so_question_links: extracts Stack Overflow question_id from comment text, one row per mention; question_mention_counts: counts mentions per question_id; question_tags: fetches tag string for mentioned questions; tag_split: splits pipe-delimited tags into individual tag rows with mention counts; tag_rankings: aggregates mentions per tag, orders by count desc, selects top 10","{""target_db"": ""stackoverflow_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local074,local059,local032""}",2025-10-31T10:04:02
bq041,"Compute the monthly statistics for new StackOverflow users created in 2021. For each month, report the total number of new users, the percentage of these new users who asked at least one question within 30 days of signing up, and among those who asked a question within 30 days, the percentage who then answered at least one question after their first question and within 30 days following their first question.",false,false,false,false,false,azure/o3,"local253,local037,local311,local219",new_users_2021: 2021 signups with extracted signup_month; first_30day_questions: users asking ≥1 question within 30 days of signup; first_question_date: earliest question date per such user; answers_within_30_of_question: users answering ≥1 question within 30 days after first question; monthly_aggregates: joins cohorts to compute monthly totals and percentages for final output,new_users_2021: 2021 signups with extracted signup_month; first_30day_questions: users asking ≥1 question within 30 days of signup; first_question_date: earliest question date per such user; answers_within_30_of_question: users answering ≥1 question within 30 days after first question; monthly_aggregates: joins cohorts to compute monthly totals and percentages for final output,"{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local037,local311,local219""}",2025-10-31T10:04:11
bq123,"You need to determine which day of the week has the third highest percentage of questions on Stack Overflow that receive an answer within an hour. To do this, use the question creation date from the posts_questions table and the earliest answer creation date from the posts_answers table. Once you’ve calculated the percentage of questions that get answered within an hour for each day, identify the day with the third highest percentage and report that percentage.",false,false,false,false,false,azure/o3,"local060,local023,local017,local097","earliest_answers: earliest answer creation per question_id; questions_with_flag: join questions to earliest_answers, flag if first answer within 60 minutes; day_percentages: compute percentage of within-hour answers per weekday; ranked_days: assign descending rank to weekdays by percentage; third_day: select weekday with rank 3 and its percentage","earliest_answers: earliest answer creation per question_id; questions_with_flag: join questions to earliest_answers, flag if first answer within 60 minutes; day_percentages: compute percentage of within-hour answers per weekday; ranked_days: assign descending rank to weekdays by percentage; third_day: select weekday with rank 3 and its percentage","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local023,local017,local097""}",2025-10-31T10:04:23
bq280,"Please provide the display name of the user who has answered the most questions on Stack Overflow, considering only users with a reputation greater than 10.",false,false,false,false,false,azure/o3,"local060,local078,local017,local015","qualified_users: selects user_id and display_name for users with reputation > 10; answer_counts: joins qualified_users to answer posts, counting answers per user; top_user: keeps display_names with maximum answer count","qualified_users: selects user_id and display_name for users with reputation > 10; answer_counts: joins qualified_users to answer posts, counting answers per user; top_user: keeps display_names with maximum answer count","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local078,local017,local015""}",2025-10-31T10:04:32
bq300,"What is the highest number of answers received for a single Python 2 specific question on Stack Overflow, excluding any discussions that involve Python 3?",false,false,false,false,false,azure/o3,"local077,local194,local196,local056",questions_base: selects Stack Overflow questions with tag string; python2_only: keeps python-2 tagged questions excluding python-3 references; answer_counts: counts answers per question; top_answered: picks python2_only question with highest answer count,questions_base: selects Stack Overflow questions with tag string; python2_only: keeps python-2 tagged questions excluding python-3 references; answer_counts: counts answers per question; top_answered: picks python2_only question with highest answer count,"{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local194,local196,local056""}",2025-10-31T10:04:46
bq301,"Retrieve details of accepted answers to Stack Overflow questions posted in January 2016 that have tags including ""javascript"" and at least one of ""xss"", ""cross-site"", ""exploit"", or ""cybersecurity""; the answers themselves must also have been posted in January 2016. For each accepted answer, include the answer's ID, the answerer's reputation, score, and comment count, along with the associated question's tags, score, answer count, the asker's reputation, view count, and comment count.",false,false,false,false,false,azure/o3,"local023,local017,local021,local130","tagged_jan_questions: Jan-2016 questions with 'javascript' plus any of 'xss','cross-site','exploit','cybersecurity', retaining id, accepted_answer_id, asker_id; january_answers: answers created Jan-2016 with id, answerer_id, score; accepted_answers: links tagged_jan_questions to january_answers via accepted_answer_id, outputting answer_id and question_id; question_metrics: enriches tagged_jan_questions with score, answer_count, view_count, comment_count, asker reputation; answer_metrics: gathers score, comment_count, answerer reputation for accepted_answers; final_result: joins accepted_answers with question_metrics and answer_metrics to supply full requested fields","tagged_jan_questions: Jan-2016 questions with 'javascript' plus any of 'xss','cross-site','exploit','cybersecurity', retaining id, accepted_answer_id, asker_id; january_answers: answers created Jan-2016 with id, answerer_id, score; accepted_answers: links tagged_jan_questions to january_answers via accepted_answer_id, outputting answer_id and question_id; question_metrics: enriches tagged_jan_questions with score, answer_count, view_count, comment_count, asker reputation; answer_metrics: gathers score, comment_count, answerer reputation for accepted_answers; final_result: joins accepted_answers with question_metrics and answer_metrics to supply full requested fields","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local017,local021,local130""}",2025-10-31T10:05:09
bq302,What is the monthly proportion of Stack Overflow questions tagged with 'python' in the year 2022?,false,false,false,false,false,azure/o3,"local074,local141,local130,local300",months_2022: lists each month of 2022; posts_2022: selects Stack Overflow questions created in 2022; monthly_totals: counts total questions per 2022 month; python_questions: filters posts_2022 tagged 'python'; monthly_python: counts python-tagged questions per month; monthly_proportion: joins month lists with counts and computes python question share per month,months_2022: lists each month of 2022; posts_2022: selects Stack Overflow questions created in 2022; monthly_totals: counts total questions per 2022 month; python_questions: filters posts_2022 tagged 'python'; monthly_python: counts python-tagged questions per month; monthly_proportion: joins month lists with counts and computes python question share per month,"{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local141,local130,local300""}",2025-10-31T10:05:18
bq303,"From July 1, 2019 through December 31, 2019, for all users with IDs between 16712208 and 18712208 on Stack Overflow, retrieve the user ID and the tags of the relevant question for each of their contributions, including comments on both questions and answers, any answers they posted, and any questions they authored, making sure to correctly associate the comment or answer with its parent question’s tags.",false,false,false,false,false,azure/o3,"local157,local301,local070,local056","user_ids: list user IDs within specified numeric range; question_tags: map each question_id to its tag list; authored_questions: user_ids' questions from 2019-07-01 to 2019-12-31 with tags; user_answers: answers by user_ids in timeframe joined to parent question_tags; user_comments: comments by user_ids in timeframe, resolve root question then attach tags; all_contributions: union of above contributions returning user_id and associated tags","user_ids: list user IDs within specified numeric range; question_tags: map each question_id to its tag list; authored_questions: user_ids' questions from 2019-07-01 to 2019-12-31 with tags; user_answers: answers by user_ids in timeframe joined to parent question_tags; user_comments: comments by user_ids in timeframe, resolve root question then attach tags; all_contributions: union of above contributions returning user_id and associated tags","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local301,local070,local056""}",2025-10-31T10:05:43
bq304,"Retrieve the top 50 most viewed questions for each of the following Android-related tags on StackOverflow: 'android-layout', 'android-activity', 'android-intent', 'android-edittext', 'android-fragments', 'android-recyclerview', 'listview', 'android-actionbar', 'google-maps', and 'android-asynctask'. Each question must contain the word 'how' in either its title or body and must not contain any of the following troubleshooting terms in either its title or body: 'fail', 'problem', 'error', 'wrong', 'fix', 'bug', 'issue', 'solve', or 'trouble'. Only include tags that have at least 50 questions meeting these criteria, and for each such tag, select the top 50 questions ranked by view count.",false,false,false,false,false,azure/o3,"local157,local253,local015,local037","filtered_questions: Questions with listed tags containing 'how' and without troubleshooting terms; select post_id, tags, view_count; expanded_tag_rows: splits tags of filtered questions into individual rows for each desired tag; tag_min50: aggregates qualifying question counts per tag and keeps tags with at least 50; ranked_views: assigns row_number per tag ordered by view_count desc to pick top 50","filtered_questions: Questions with listed tags containing 'how' and without troubleshooting terms; select post_id, tags, view_count; expanded_tag_rows: splits tags of filtered questions into individual rows for each desired tag; tag_min50: aggregates qualifying question counts per tag and keeps tags with at least 50; ranked_views: assigns row_number per tag ordered by view_count desc to pick top 50","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local253,local015,local037""}",2025-10-31T10:05:59
bq310,"What is the title of the most viewed ""how"" question related to Android development on StackOverflow, across specified tags such as 'android-layout', 'android-activity', 'android-intent', and others",false,false,false,false,false,azure/o3,"local097,local157,local194,local099",tag_list: enumerates specified Android-related tags; split_tags: expands question tag strings into individual tag rows; how_questions: selects questions with 'how' in title and matching Android tags; ranked: orders filtered questions by view_count to identify most viewed,tag_list: enumerates specified Android-related tags; split_tags: expands question tag strings into individual tag rows; how_questions: selects questions with 'how' in title and matching Android tags; ranked: orders filtered questions by view_count to identify most viewed,"{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local097,local157,local194,local099""}",2025-10-31T10:06:08
bq305,"Which 10 users have the highest combined view counts for questions they are associated with, where a user is considered associated if they own the question, or their answer is the accepted answer, or their answer's score is greater than 5, or their answer's score exceeds 20% of the total answer scores for that question (and is above 0), or their answer is among the top three highest-scoring answers for that question?",false,false,false,false,false,azure/o3,"local253,local023,local024,local032","question_base: retrieves question id, owner user id, and view count; answer_base: retrieves answer id, question id, owner user id, score, accepted flag; total_answer_scores: calculates total answer score per question; top_three_answers: selects answers ranking within top three scores per question; eligible_associations: unifies question owners and answer owners meeting association rules; user_view_totals: aggregates view counts of associated questions per user; top_users: returns ten users with highest combined view totals","question_base: retrieves question id, owner user id, and view count; answer_base: retrieves answer id, question id, owner user id, score, accepted flag; total_answer_scores: calculates total answer score per question; top_three_answers: selects answers ranking within top three scores per question; eligible_associations: unifies question owners and answer owners meeting association rules; user_view_totals: aggregates view counts of associated questions per user; top_users: returns ten users with highest combined view totals","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local023,local024,local032""}",2025-10-31T10:06:22
bq306,"Identify the top 10 tags for user 1908967, based only on answers posted before June 7, 2018, where each tag’s score is 10 times the number of upvotes (vote_type_id=2) and 15 times the number of accepted answers (vote_type_id=1). Derive tags from the questions associated with those answers, and consider only the upvotes and accepted answers for those answers. Return the tags with the highest total scores in descending order, limited to 10 tags.",false,false,false,false,false,azure/o3,"local021,local228,local097,local253",user_answers: answers by user 1908967 posted before 2018-06-07; answer_votes: counts upvotes and accepts per answer; answer_scores: applies 10*upvotes + 15*accepted scoring per answer; answer_tags: joins answers to parent question tags; tag_scores: aggregates scores per tag and selects top 10 descending,user_answers: answers by user 1908967 posted before 2018-06-07; answer_votes: counts upvotes and accepts per answer; answer_scores: applies 10*upvotes + 15*accepted scoring per answer; answer_tags: joins answers to parent question tags; tag_scores: aggregates scores per tag and selects top 10 descending,"{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local228,local097,local253""}",2025-10-31T10:06:32
bq308,"Show the number of Stack Overflow questions asked each day of the week in 2021, and find out how many and what percentage of those were answered within one hour.",false,false,false,false,false,azure/o3,"local301,local003,local077,local264","q21: selects 2021 questions, annotating day_of_week; first_ans: retrieves earliest answer timestamp per question; q_status: joins q21 with first_ans, flags answers within one hour; weekday_stats: aggregates by day_of_week computing total questions, one_hour_answered count, and percentage","q21: selects 2021 questions, annotating day_of_week; first_ans: retrieves earliest answer timestamp per question; q_status: joins q21 with first_ans, flags answers within one hour; weekday_stats: aggregates by day_of_week computing total questions, one_hour_answered count, and percentage","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local003,local077,local264""}",2025-10-31T10:06:44
bq309,"Retrieve the top 10 longest questions on Stack Overflow, measured by the length of their body text, where each question either has an accepted answer or has no accepted answer but has at least one answer with a score-to-view ratio exceeding 0.01. For each of these questions, include the reputation of the user who asked the question, the user's net votes (calculated as their total up_votes minus down_votes), and the total number of badges the user has earned.",false,false,false,false,false,azure/o3,"local060,local201,local329,local219","question_lengths: computes body_len, view_count, accepted_answer flag for each question; high_ratio_answers: selects answers whose score divided by parent view_count exceeds 0.01; qualifying_questions: keeps questions with accepted answer or at least one high_ratio_answer; ranked_questions: takes top 10 qualifying questions sorted by body_len desc; user_votes: aggregates user votes into net_votes; user_badges: counts badges per user; user_stats: joins users with votes and badges to attach reputation, net_votes, badge_total","question_lengths: computes body_len, view_count, accepted_answer flag for each question; high_ratio_answers: selects answers whose score divided by parent view_count exceeds 0.01; qualifying_questions: keeps questions with accepted answer or at least one high_ratio_answer; ranked_questions: takes top 10 qualifying questions sorted by body_len desc; user_votes: aggregates user votes into net_votes; user_badges: counts badges per user; user_stats: joins users with votes and badges to attach reputation, net_votes, badge_total","{""target_db"": ""stackoverflow"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local201,local329,local219""}",2025-10-31T10:07:12
bq124,"Among all patients, how many individuals remain alive (i.e., with no recorded deceased.dateTime), have a diagnosis of either Diabetes or Hypertension, and are prescribed at least seven distinct active medications?",false,false,false,false,false,azure/o3,"local015,local097,local078,local075",alive_patients: selects patient_ids without deceased.dateTime; dx_patients: patient_ids diagnosed with Diabetes or Hypertension; med_counts: counts distinct active medications per patient; qualified_patients: patients alive with target diagnoses and med_count >= 7,alive_patients: selects patient_ids without deceased.dateTime; dx_patients: patient_ids diagnosed with Diabetes or Hypertension; med_counts: counts distinct active medications per patient; qualified_patients: patients alive with target diagnoses and med_count >= 7,"{""target_db"": ""fhir_synthea"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local097,local078,local075""}",2025-10-31T10:07:20
bq391,"Among living patients whose last names begin with ""A"" and who each have exactly one distinct condition, which eight conditions have the highest number of different active medications prescribed to any single patient, and what are their corresponding codes?",false,false,false,false,false,azure/o3,"local157,local015,local023,local067","a_patients: selects living patients whose last_name starts with 'A'; patient_conditions: joins conditions to a_patients, listing each patient's distinct condition codes; single_condition_patients: filters patient_conditions to patients having exactly one condition, retains their sole condition code; patient_active_meds: counts distinct active medications per single_condition_patient; condition_max_meds: computes maximum active medication count per condition across patients; top_conditions: picks eight conditions with highest max counts, returning condition code and max_med_count","a_patients: selects living patients whose last_name starts with 'A'; patient_conditions: joins conditions to a_patients, listing each patient's distinct condition codes; single_condition_patients: filters patient_conditions to patients having exactly one condition, retains their sole condition code; patient_active_meds: counts distinct active medications per single_condition_patient; condition_max_meds: computes maximum active medication count per condition across patients; top_conditions: picks eight conditions with highest max counts, returning condition code and max_med_count","{""target_db"": ""fhir_synthea"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local015,local023,local067""}",2025-10-31T10:07:34
bq126,"What are the titles, artist names, mediums, and original image URLs of objects with 'Photograph' in their names from the 'Photographs' department, created not by an unknown artist, with an object end date of 1839 or earlier?",false,false,false,false,false,azure/o3,"local196,local141,local097,local201","photo_dept: filter Photographs department and title containing 'Photograph'; early_photos: retain photo_dept rows with object_end_date ≤ 1839; artist_clean: exclude unknown artists and select title, artist name, medium, original image URL","photo_dept: filter Photographs department and title containing 'Photograph'; early_photos: retain photo_dept rows with object_end_date ≤ 1839; artist_clean: exclude unknown artists and select title, artist name, medium, original image URL","{""target_db"": ""the_met"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local141,local097,local201""}",2025-10-31T10:07:40
bq366,"What are the top three most frequently associated labels with artworks from each historical period in The Met's collection, only considering labels linked to 500 or more artworks? Provide me with the period, label, and the associated count.",false,false,false,false,false,azure/o3,"local300,local010,local199,local329",eligible_labels: labels linked to 500+ artworks; period_label_counts: counts artworks per period and eligible label; ranked_labels: assigns row_number per period by descending count; top_three_labels: filters ranked_labels to top three per period,eligible_labels: labels linked to 500+ artworks; period_label_counts: counts artworks per period and eligible label; ranked_labels: assigns row_number per period by descending count; top_three_labels: filters ranked_labels to top three per period,"{""target_db"": ""the_met"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local010,local199,local329""}",2025-10-31T10:07:51
bq414,"Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the ""The Libraries"" department where the cropConfidence is greater than 0.5, the object's title contains the word ""book"".",false,false,false,false,false,azure/o3,"local059,local070,local032,local010",library_objects: filters The Libraries objects with cropConfidence >0.5 and title containing 'book'; formatted_metadata: converts metadata_date to 'YYYY-MM-DD' string for final output,library_objects: filters The Libraries objects with cropConfidence >0.5 and title containing 'book'; formatted_metadata: converts metadata_date to 'YYYY-MM-DD' string for final output,"{""target_db"": ""the_met"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local070,local032,local010""}",2025-10-31T10:07:58
bq200,"Using data from both the regular season and the post-season, identify the pitcher who achieved the highest non-zero pitch speed for each team by confirming whether the pitcher’s ID appears in the relevant home or away player lists for that game, then retrieve that pitcher’s full name along with the maximum valid pitch speed they achieved while playing for that specific team.",false,false,false,false,false,azure/o3,"local078,local021,local300,local130","game_team_map: selects regular and post-season games with home/away team ids and player id lists; valid_pitch_speeds: joins pitches to games, filters speed>0, assigns team when pitcher id in matching player list; pitcher_team_max: aggregates to maximum pitch speed per pitcher per team; team_fastest_pitcher: ranks speeds per team and keeps top pitcher; pitcher_full_names: adds full name to each fastest pitcher via player roster join","game_team_map: selects regular and post-season games with home/away team ids and player id lists; valid_pitch_speeds: joins pitches to games, filters speed>0, assigns team when pitcher id in matching player list; pitcher_team_max: aggregates to maximum pitch speed per pitcher per team; team_fastest_pitcher: ranks speeds per team and keeps top pitcher; pitcher_full_names: adds full name to each fastest pitcher via player roster join","{""target_db"": ""mlb"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local021,local300,local130""}",2025-10-31T10:08:16
bq204,Find the user with the highest total clicks across all records from all available photo collections.,false,false,false,false,false,azure/o3,"local077,local064,local017,local329",base_clicks: unions click records from every photo collection with user_id and click_count; user_totals: sums click_count per user across all collections; top_user: returns user(s) with the highest total_clicks,base_clicks: unions click records from every photo collection with user_id and click_count; user_totals: sums click_count per user across all collections; top_user: returns user(s) with the highest total_clicks,"{""target_db"": ""eclipse_megamovie"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local064,local017,local329""}",2025-10-31T10:08:23
bq389,"Please calculate the monthly average levels of PM10, PM2.5 FRM, PM2.5 non-FRM, volatile organic emissions, SO2 (scaled by a factor of 10), and Lead (scaled by a factor of 100) air pollutants in California for the year 2020.",false,false,false,false,false,azure/o3,"local075,local219,local067,local059",ca_measurements_2020: filters 2020 measurements to California only; normalized_readings: standardizes pollutant labels and applies scaling to SO2 and Lead; monthly_pollutant_avg: computes average concentration per pollutant and month; ordered_results: arranges monthly averages ordered by pollutant and month,ca_measurements_2020: filters 2020 measurements to California only; normalized_readings: standardizes pollutant labels and applies scaling to SO2 and Lead; monthly_pollutant_avg: computes average concentration per pollutant and month; ordered_results: arranges monthly averages ordered by pollutant and month,"{""target_db"": ""epa_historical_air_quality"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local219,local067,local059""}",2025-10-31T10:08:34
bq199,"Identify the top 10 liquor categories in Iowa in 2021 by calculating, for each category, the average of the per-liter retail prices across all sales transactions in that category during 2021. For these top categories, provide their average per-liter retail prices calculated in the same manner for the years 2019, 2020, and 2021.",false,false,false,false,false,azure/o3,"local032,local157,local003,local060",filtered_sales: filters 2019-2021 Iowa liquor rows and derives per_liter_price; yrly_category_avg: averages per_liter_price by category and year; top_cats_2021: selects top 10 categories by 2021 average per_liter_price; final_averages: returns 2019–2021 averages for top categories,filtered_sales: filters 2019-2021 Iowa liquor rows and derives per_liter_price; yrly_category_avg: averages per_liter_price by category and year; top_cats_2021: selects top 10 categories by 2021 average per_liter_price; final_averages: returns 2019–2021 averages for top categories,"{""target_db"": ""iowa_liquor_sales"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local157,local003,local060""}",2025-10-31T10:08:49
bq218,What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?,false,false,false,false,false,azure/o3,"local056,local064,local283,local060",yearly_item_sales: sums sales revenue per item per year; item_growth_pct: joins 2023 vs 2022 totals and computes growth percentage; top5_items: picks top five items by highest 2023 YoY growth,yearly_item_sales: sums sales revenue per item per year; item_growth_pct: joins 2023 vs 2022 totals and computes growth percentage; top5_items: picks top five items by highest 2023 YoY growth,"{""target_db"": ""iowa_liquor_sales"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local064,local283,local060""}",2025-10-31T10:08:59
bq049,"Please show the monthly per capita Bourbon Whiskey sales during 2022 in Dubuque County for the zip code that ranks third in total Bourbon Whiskey sales, using only the population aged 21 and older.",false,false,false,false,false,azure/o3,"local194,local056,local283,local060",all_sales_2022: filters 2022 Dubuque County Bourbon Whiskey transactions; zip_totals: totals 2022 bourbon sales per zip; third_zip: selects zip ranked third by total sales; monthly_sales: aggregates bourbon sales per month for third_zip; population_21: fetches 21+ population for selected zip; per_capita_calc: divides monthly sales by adult population to yield per capita figures,all_sales_2022: filters 2022 Dubuque County Bourbon Whiskey transactions; zip_totals: totals 2022 bourbon sales per zip; third_zip: selects zip ranked third by total sales; monthly_sales: aggregates bourbon sales per month for third_zip; population_21: fetches 21+ population for selected zip; per_capita_calc: divides monthly sales by adult population to yield per capita figures,"{""target_db"": ""iowa_liquor_sales_plus"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local056,local283,local060""}",2025-10-31T10:09:12
bq360,"Among healthcare providers whose practice location is in Mountain View, CA, and who have a specified specialization in the field healthcare provider taxonomy, identify the top 10 most common specializations based on the count of distinct NPIs. Then determine which of those top 10 has a count of distinct NPIs closest to the average count across those 10 specializations.",false,false,false,false,false,azure/o3,"local199,local078,local026,local070",mv_providers: filters providers practicing in Mountain View CA with non-null specialization; specialization_counts: counts distinct NPIs per specialization from mv_providers; top_10_specializations: selects ten specializations with highest NPI counts; avg_npi_count: computes average NPI count across top_10_specializations; nearest_to_average: finds specialization(s) whose count is closest to that average,mv_providers: filters providers practicing in Mountain View CA with non-null specialization; specialization_counts: counts distinct NPIs per specialization from mv_providers; top_10_specializations: selects ten specializations with highest NPI counts; avg_npi_count: computes average NPI count across top_10_specializations; nearest_to_average: finds specialization(s) whose count is closest to that average,"{""target_db"": ""nppes"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local078,local026,local070""}",2025-10-31T10:09:31
bq286,"Can you tell me the name of the most popular female baby in Wyoming for the year 2021, based on the proportion of female babies given that name compared to the total number of female babies given the same name across all states?",false,false,false,false,false,azure/o3,"local074,local194,local099,local310",wy_female_counts: sums counts per name for 2021 female births in Wyoming; national_female_totals: aggregates 2021 female births per name across all states; name_popularity: joins counts to compute Wyoming share of each name; top_name: selects name with highest Wyoming share,wy_female_counts: sums counts per name for 2021 female births in Wyoming; national_female_totals: aggregates 2021 female births per name across all states; name_popularity: joins counts to compute Wyoming share of each name; top_name: selects name with highest Wyoming share,"{""target_db"": ""usa_names"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local194,local099,local310""}",2025-10-31T10:09:39
bq143,"Use CPTAC proteomics and RNAseq data for Clear Cell Renal Cell Carcinoma to select 'Primary Tumor' and 'Solid Tissue Normal' samples. Join the datasets on sample submitter IDs and gene symbols. Calculate the correlation between protein abundance (log2 ratio) and gene expression levels (log-transformed+1 FPKM) for each gene and sample type. Filter out correlations with an absolute value greater than 0.5, and compute the average correlation for each sample type.",false,false,false,false,false,azure/o3,"local201,local264,local017,local141","prot_data: selects protein log2 ratios for Primary Tumor and Solid Tissue Normal samples with sample_submitter_id and gene_symbol; rna_data: selects RNAseq rows for same samples, adds log2(FPKM+1) as expr_value; merged_data: joins prot_data and rna_data on sample_submitter_id and gene_symbol; gene_correlations: computes Pearson correlation per gene and sample_type between protein_abundance and expr_value; strong_correlations: filters gene_correlations to abs(correlation) > 0.5; avg_corr_by_type: calculates average correlation per sample_type across strong_correlations","prot_data: selects protein log2 ratios for Primary Tumor and Solid Tissue Normal samples with sample_submitter_id and gene_symbol; rna_data: selects RNAseq rows for same samples, adds log2(FPKM+1) as expr_value; merged_data: joins prot_data and rna_data on sample_submitter_id and gene_symbol; gene_correlations: computes Pearson correlation per gene and sample_type between protein_abundance and expr_value; strong_correlations: filters gene_correlations to abs(correlation) > 0.5; avg_corr_by_type: calculates average correlation per sample_type across strong_correlations","{""target_db"": ""CPTAC_PDC"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local264,local017,local141""}",2025-10-31T10:09:57
bq046,"Find case barcodes and their corresponding GDC file URLs for female patients aged 30 or younger diagnosed with breast cancer (BRCA) in TCGA database. The query should first identify patients from the Annotations table where entity_type is ""Patient"" and either category is ""History of unacceptable prior treatment related to a prior/other malignancy"" or classification is ""Redaction"". Also identify patients from the Clinical table with disease_code ""BRCA"", age_at_diagnosis less than or equal to 30, and gender ""FEMALE"". Perform a FULL JOIN between these two sets, but only keep patients where both categoryName and classificationName are NULL in the final result. Use GDC metadata from archive release 14 (specifically rel14_caseData, rel14_fileData_current, and rel14_GDCfileID_to_GCSurl_NEW tables) to get the corresponding file URLs. ",false,false,false,false,false,azure/o3,"local077,local037,local017,local301","annot_patients: patients flagged in Annotations table where entity_type='Patient' and category='History of unacceptable prior treatment' or classification='Redaction'; clinical_brca30f: female BRCA patients aged ≤30 extracted from Clinical table; eligible_patients: full join clinical and annotation sets, keep cases with null category and classification; rel14_case_link: map eligible patient barcodes to rel14_caseData case_ids and submitter_ids; file_urls: join rel14_case_link with rel14_fileData_current and rel14_GDCfileID_to_GCSurl_NEW to gather GDC file URLs per case","annot_patients: patients flagged in Annotations table where entity_type='Patient' and category='History of unacceptable prior treatment' or classification='Redaction'; clinical_brca30f: female BRCA patients aged ≤30 extracted from Clinical table; eligible_patients: full join clinical and annotation sets, keep cases with null category and classification; rel14_case_link: map eligible patient barcodes to rel14_caseData case_ids and submitter_ids; file_urls: join rel14_case_link with rel14_fileData_current and rel14_GDCfileID_to_GCSurl_NEW to gather GDC file URLs per case","{""target_db"": ""TCGA_bioclin_v0"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local037,local017,local301""}",2025-10-31T10:10:24
bq161,"Calculate the net difference between the number of pancreatic adenocarcinoma (PAAD) patients in TCGA's dataset who are confirmed to have mutations in both KRAS and TP53 genes, and those without mutations in either gene. Utilize patient clinical and follow-up data alongside genomic mutation details from TCGA’s cancer genomics database, focusing specifically on PAAD studies where the mutations have passed quality filters.",false,false,false,false,false,azure/o3,"local021,local283,local056,local194","paad_patients: extracts distinct TCGA patient ids from clinical tables where cancer_type = 'PAAD'; paad_mutations: selects high-quality KRAS or TP53 mutation calls for PAAD patients; mutation_flags: aggregates mutations per patient to set boolean flags has_kras and has_tp53; classified_patients: labels each patient 'both_mutated' or 'neither_mutated' based on mutation flags, excluding partial cases; group_counts: counts patients per label and computes net difference both minus neither","paad_patients: extracts distinct TCGA patient ids from clinical tables where cancer_type = 'PAAD'; paad_mutations: selects high-quality KRAS or TP53 mutation calls for PAAD patients; mutation_flags: aggregates mutations per patient to set boolean flags has_kras and has_tp53; classified_patients: labels each patient 'both_mutated' or 'neither_mutated' based on mutation flags, excluding partial cases; group_counts: counts patients per label and computes net difference both minus neither","{""target_db"": ""pancancer_atlas_2"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local283,local056,local194""}",2025-10-31T10:10:46
bq151,"Using TCGA dataset, calculate the chi-squared statistic to evaluate the association between KRAS and TP53 gene mutations in patients diagnosed with pancreatic adenocarcinoma (PAAD). Incorporate clinical follow-up data and high-quality mutation annotations to accurately determine the frequency of patients with co-occurring KRAS and TP53 mutations compared to those with each mutation occurring independently. Ensure that patient records are meticulously matched based on unique identifiers to maintain data integrity. This analysis aims to identify and quantify potential correlations between KRAS and TP53 genetic alterations within the PAAD patient population.",false,false,false,false,false,azure/o3,"local130,local194,local015,local037","paad_patients: select unique patient_id with pancreatic adenocarcinoma diagnosis and valid follow-up; filtered_mutations: high-confidence KRAS or TP53 variants for paad_patients; patient_gene_flags: pivot filtered_mutations to set has_kras and has_tp53 indicators per patient; contingency_counts: count patients in four mutation categories (both, KRAS_only, TP53_only, neither); chi_sq_calc: compute expected frequencies and chi-squared statistic from contingency_counts","paad_patients: select unique patient_id with pancreatic adenocarcinoma diagnosis and valid follow-up; filtered_mutations: high-confidence KRAS or TP53 variants for paad_patients; patient_gene_flags: pivot filtered_mutations to set has_kras and has_tp53 indicators per patient; contingency_counts: count patients in four mutation categories (both, KRAS_only, TP53_only, neither); chi_sq_calc: compute expected frequencies and chi-squared statistic from contingency_counts","{""target_db"": ""pancancer_atlas_2"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local194,local015,local037""}",2025-10-31T10:10:55
bq162,"Based on the 5th revision (r5) of the HTAN data, list the imaging assay types available at the HTAN WUSTL center that have Level2 data and any associated higher-level data (Level3, Level4) derived from them through 'entityId' relationships in the 'id_provenance_r5' table; exclude any records where the 'Component' is NULL or contains 'Auxiliary' or 'OtherAssay'; for each imaging assay type, provide the available data levels (Level2, Level3, Level4), and do not include Level1 data or Electron Microscopy assay types.",false,false,false,false,false,azure/o3,"local329,local021,local064,local283","wustl_clean: HTAN WUSTL rows with Component present, excluding Auxiliary, OtherAssay, Electron Microscopy, levels 2-4 only; level2_bases: imaging assay Level2 records from wustl_clean; higher_levels: Level3/4 rows from wustl_clean whose entityId traces back to level2_bases; assay_level_summary: aggregates level2_bases and higher_levels to list distinct available levels per imaging assay type","wustl_clean: HTAN WUSTL rows with Component present, excluding Auxiliary, OtherAssay, Electron Microscopy, levels 2-4 only; level2_bases: imaging assay Level2 records from wustl_clean; higher_levels: Level3/4 rows from wustl_clean whose entityId traces back to level2_bases; assay_level_summary: aggregates level2_bases and higher_levels to list distinct available levels per imaging assay type","{""target_db"": ""HTAN_1"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local021,local064,local283""}",2025-10-31T10:11:17
bq165,"Can you use CytoConverter genomic coordinates to calculate the frequency of chromosomal gains and losses across a cohort of breast cancer (morphology='3111') and adenocarcinoma (topology='0401') samples? Concretely, please include the number and frequency (2 decimals in percentage) of amplifications (gains of more than 1 copy), gains (1 extra copy), losses (1 copy) and homozygous deletions (loss of 2 copies) for each chromosomal band. And sort the result by the ordinal of each chromosome and the starting-ending base-pair position of each band in ascending order.",false,false,false,false,false,azure/o3,"local078,local130,local229,local023","selected_samples: selects sample_id where morphology 3111 or topology 0401; cn_segments: joins selected samples’ copy number segments to cytoband coordinates mapping band; band_events: labels each sample-band as amplification, gain, loss, homo_del by copy number; event_counts: counts distinct samples per band and event_type, adds total cohort size; event_frequencies: computes two-decimal percentage of each event per band; ordered_bands: attaches chromosome ordinal and band start/stop positions for final sort","selected_samples: selects sample_id where morphology 3111 or topology 0401; cn_segments: joins selected samples’ copy number segments to cytoband coordinates mapping band; band_events: labels each sample-band as amplification, gain, loss, homo_del by copy number; event_counts: counts distinct samples per band and event_type, adds total cohort size; event_frequencies: computes two-decimal percentage of each event per band; ordered_bands: attaches chromosome ordinal and band start/stop positions for final sort","{""target_db"": ""mitelman"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local130,local229,local023""}",2025-10-31T10:11:33
bq169,"Retrieve distinct case references, case numbers, investigation numbers, and clone information where a single clone simultaneously exhibits all three of the following genetic alterations: (1) a loss on chromosome 13 between positions 48,303,751 and 48,481,890, (2) a loss on chromosome 17 between positions 7,668,421 and 7,687,490, and (3) a gain on chromosome 11 between positions 108,223,067 and 108,369,102. For each matching clone, display the chromosomal details for each of these three regions (including chromosome number represented by ChrOrd, start position, and end position) and the corresponding karyotype short description from the KaryClone table. Use the CytoConverted and KaryClone.",false,false,false,false,false,azure/o3,"local032,local264,local130,local010",chr13_loss: selects clones with loss on chr13 positions 48303751–48481890 from CytoConverted; chr17_loss: selects clones with loss on chr17 positions 7668421–7687490 from CytoConverted; chr11_gain: selects clones with gain on chr11 positions 108223067–108369102 from CytoConverted; qualifying_clones: finds clones present in all three alteration sets retaining case and investigation identifiers; karyo_info: fetches karyotype_short_desc per clone from KaryClone; clone_region_details: combines qualifying clones with each region record and karyo_info to list chromosomal details,chr13_loss: selects clones with loss on chr13 positions 48303751–48481890 from CytoConverted; chr17_loss: selects clones with loss on chr17 positions 7668421–7687490 from CytoConverted; chr11_gain: selects clones with gain on chr11 positions 108223067–108369102 from CytoConverted; qualifying_clones: finds clones present in all three alteration sets retaining case and investigation identifiers; karyo_info: fetches karyotype_short_desc per clone from KaryClone; clone_region_details: combines qualifying clones with each region record and karyo_info to list chromosomal details,"{""target_db"": ""mitelman"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local264,local130,local010""}",2025-10-31T10:11:52
bq111,"Could you compute, by chromosome, the Pearson correlation between the frequency of copy number aberrations (including amplifications, gains, losses, and deletions) from the Mitelman database for cases with morph = 3111 and topo = 0401, and those computed from TCGA data, returning correlation coefficients and corresponding p-values for each aberration type, ensuring only results with at least five matching records are shown.",false,false,false,false,true,azure/o3,"local015,local026,local056,local017","selected_mitelman_cases: filters Mitelman records for morph 3111 and topo 0401; mitelman_band_freq: frequency of each aberration per chromosome-cytoband from filtered cases; tcga_band_freq: frequency of each aberration per chromosome-cytoband in TCGA; matched_band_freq: aligns Mitelman and TCGA frequencies by chromosome, cytoband, aberration type; chrom_corr: calculates Pearson correlation and p-value per chromosome and aberration type with ≥5 matched bands","selected_mitelman_cases: filters Mitelman records for morph 3111 and topo 0401; mitelman_band_freq: frequency of each aberration per chromosome-cytoband from filtered cases; tcga_band_freq: frequency of each aberration per chromosome-cytoband in TCGA; matched_band_freq: aligns Mitelman and TCGA frequencies by chromosome, cytoband, aberration type; chrom_corr: calculates Pearson correlation and p-value per chromosome and aberration type with ≥5 matched bands","{""target_db"": ""mitelman"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local026,local056,local017""}",2025-10-31T10:12:10
bq451,"Extract genotype data for single nucleotide polymorphisms (SNPs) on chromosome X, excluding positions where the `start` value is between 59999 and 2699519 or between 154931042 and 155260559. For each sample, identify genotype calls where the genotype array has at least one allele. Classify each genotype call into one of the following categories: homozygous reference alleles (both alleles are 0), homozygous alternate alleles (both alleles are the same and greater than 0), or heterozygous alleles (alleles are different, or any allele is null, and at least one allele is greater than 0). Compute the total number of callable sites (the sum of all three genotype categories), the number of homozygous reference, homozygous alternate, and heterozygous genotype calls, the total number of single nucleotide variants (SNVs) as the sum of homozygous alternate and heterozygous genotype calls, the percentage of heterozygous genotype calls among all SNVs, and the percentage of homozygous alternate genotype calls among all SNVs. Output the sample ID along with these computed counts and percentages, and order the results by the percentage of heterozygous genotype calls among SNVs in descending order, then by sample ID.",false,false,false,false,false,azure/o3,"local157,local056,local099,local194","x_snps: selects chromosome X SNPs excluding disallowed position ranges; callable_gts: keeps genotype calls with any allele present from x_snps; categorized_gts: labels each call as hom_ref, hom_alt, or het per allele pattern; sample_counts: aggregates counts of each category and total callable sites per sample; snv_metrics: calculates SNV totals and heterozygous/homo_alt percentages, prepares ordered output","x_snps: selects chromosome X SNPs excluding disallowed position ranges; callable_gts: keeps genotype calls with any allele present from x_snps; categorized_gts: labels each call as hom_ref, hom_alt, or het per allele pattern; sample_counts: aggregates counts of each category and total callable sites per sample; snv_metrics: calculates SNV totals and heterozygous/homo_alt percentages, prepares ordered output","{""target_db"": ""_1000_genomes"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local056,local099,local194""}",2025-10-31T10:12:23
bq452,"Identify variants on chromosome 12 and, for each variant, calculate the chi-squared score using allele counts in cases and controls, where cases are individuals from the 'EAS' super population and controls are individuals from all other super populations. Apply Yates's correction for continuity in the chi-squared calculation, ensuring that the expected counts for each allele in both groups are at least 5. Return the start position, end position, and chi-squared score of the top variants where the chi-squared score is no less than 29.71679.",false,false,false,false,false,azure/o3,"local017,local097,local060,local026","eas_cases: selects sample IDs from EAS super population; allele_totals: sums ref and alt allele counts per variant for cases and controls; expected_counts: derives expected allele counts per variant and removes those with any expected <5; chi_square_scores: computes Yates‐corrected chi-square per variant; top_variants: selects chromosome 12 variants with chi-square ≥29.71679 and returns start, end, score ordered descending","eas_cases: selects sample IDs from EAS super population; allele_totals: sums ref and alt allele counts per variant for cases and controls; expected_counts: derives expected allele counts per variant and removes those with any expected <5; chi_square_scores: computes Yates‐corrected chi-square per variant; top_variants: selects chromosome 12 variants with chi-square ≥29.71679 and returns start, end, score ordered descending","{""target_db"": ""_1000_genomes"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local097,local060,local026""}",2025-10-31T10:12:35
bq453,"In chromosome 17 between positions 41196311 and 41277499, what are the reference names, start and end positions, reference bases, distinct alternate bases, variant types, and the chi-squared scores (calculated from Hardy-Weinberg equilibrium) along with the total number of genotypes, their observed and expected counts for homozygous reference, heterozygous, and homozygous alternate genotypes, as well as allele frequencies (including those from 1KG), for each variant?",false,false,false,false,false,azure/o3,"local283,local017,local099,local329","region_variants: filters chromosome 17 variants within 41196311-41277499, selecting ref, distinct alt bases, variant_type; observed_geno_counts: tallies total, hom_ref, het, hom_alt genotypes per variant; dataset_allele_freqs: computes allele counts and frequencies from observed counts; kg_allele_freqs: retrieves 1KG allele frequencies for each variant; expected_geno_counts: computes HWE expected hom_ref, het, hom_alt counts using allele frequencies and sample size; chi2_stats: calculates chi-squared statistic per variant comparing observed vs expected","region_variants: filters chromosome 17 variants within 41196311-41277499, selecting ref, distinct alt bases, variant_type; observed_geno_counts: tallies total, hom_ref, het, hom_alt genotypes per variant; dataset_allele_freqs: computes allele counts and frequencies from observed counts; kg_allele_freqs: retrieves 1KG allele frequencies for each variant; expected_geno_counts: computes HWE expected hom_ref, het, hom_alt counts using allele frequencies and sample size; chi2_stats: calculates chi-squared statistic per variant comparing observed vs expected","{""target_db"": ""_1000_genomes"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local017,local099,local329""}",2025-10-31T10:13:05
bq454,"For the 1000 Genomes dataset, analyze common autosomal variants (those with an allele frequency of at least 0.05) across different super populations. For each super population, count how many variants are shared by each specific number of samples within that super population. Include in your results the total population size of each super population, whether the variant is common (allele frequency ≥ 0.05), the number of samples having each variant, and the total count of variants shared by that many samples. Only include autosomal variants by explicitly excluding sex chromosomes (X, Y) and mitochondrial DNA (MT) from the analysis. Consider only samples that have at least one alternate allele (non-reference) for the variant.",false,false,false,false,false,azure/o3,"local199,local078,local056,local219","pop_sizes: counts total samples per super population; autosomal_calls: selects genotype calls on autosomes only, keeping samples with alternate alleles; variant_sample_counts: counts distinct samples per variant and super population; variant_freqs: joins counts with pop_sizes to compute allele frequency and flag common; common_variants: filters variant_freqs for allele frequency ≥0.05; sharing_distribution: groups common_variants by super population and sample_count, counting variants shared by that sample count","pop_sizes: counts total samples per super population; autosomal_calls: selects genotype calls on autosomes only, keeping samples with alternate alleles; variant_sample_counts: counts distinct samples per variant and super population; variant_freqs: joins counts with pop_sizes to compute allele frequency and flag common; common_variants: filters variant_freqs for allele frequency ≥0.05; sharing_distribution: groups common_variants by super population and sample_count, counting variants shared by that sample count","{""target_db"": ""_1000_genomes"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local078,local056,local219""}",2025-10-31T10:13:24
bq279,Can you provide the number of distinct active and closed bike share stations for each year 2013 and 2014?,false,false,false,false,false,azure/o3,"local300,local066,local219,local026","station_events: extracts station_id, install_date, closure_date from stations source; station_year_status: derives each station’s 2013 and 2014 status as active or closed; yearly_station_set: ensures unique station-year-status combinations; yearly_counts: aggregates distinct station counts by year and status for final output","station_events: extracts station_id, install_date, closure_date from stations source; station_year_status: derives each station’s 2013 and 2014 status as active or closed; yearly_station_set: ensures unique station-year-status combinations; yearly_counts: aggregates distinct station counts by year and status for final output","{""target_db"": ""austin"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local066,local219,local026""}",2025-10-31T10:13:35
bq281,"What is the highest number of electric bike rides lasting more than 10 minutes taken by subscribers with 'Student Membership' in a single day, excluding rides starting or ending at 'Mobile Station' or 'Repair Shop'?",false,false,false,false,false,azure/o3,"local064,local023,local199,local075",filtered_rides: selects electric bike rides longer than 10 minutes by student subscribers excluding Mobile Station or Repair Shop start/end; daily_ride_counts: aggregates filtered rides by ride_date counting rides; max_daily_rides: identifies day(s) with the highest ride count across daily totals,filtered_rides: selects electric bike rides longer than 10 minutes by student subscribers excluding Mobile Station or Repair Shop start/end; daily_ride_counts: aggregates filtered rides by ride_date counting rides; max_daily_rides: identifies day(s) with the highest ride count across daily totals,"{""target_db"": ""austin"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local023,local199,local075""}",2025-10-31T10:13:44
bq282,"Can you tell me the numeric value of the active council district in Austin which has the highest number of bike trips that start and end within the same district, but not at the same station?",false,false,false,false,false,azure/o3,"local077,local017,local244,local010","active_districts: filters Austin council_district records to only active ones; station_lookup: maps station_id to council_district_id; matched_trips: joins trips to station_lookup twice, same district, different stations; district_counts: counts matched_trips per district, keeping only active districts; top_district: selects district with maximum trip_count","active_districts: filters Austin council_district records to only active ones; station_lookup: maps station_id to council_district_id; matched_trips: joins trips to station_lookup twice, same district, different stations; district_counts: counts matched_trips per district, keeping only active districts; top_district: selects district with maximum trip_count","{""target_db"": ""austin"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local017,local244,local010""}",2025-10-31T10:13:58
bq006,What is the date with the second highest Z-score for daily counts of 'PUBLIC INTOXICATION' incidents in Austin for the year 2016? List the date in the format of '2016-xx-xx'.,false,false,false,false,false,azure/o3,"local078,local196,local015,local067","incidents_2016: filters Austin 'PUBLIC INTOXICATION' incidents occurring in calendar year 2016; daily_counts: aggregates incidents_2016 by event date and counts incidents per day; z_scored_days: computes mean and stddev of daily counts, calculates each day's Z-score, and ranks days descending; second_highest_date: selects the date with rank 2 from z_scored_days and formats as 'YYYY-MM-DD'","incidents_2016: filters Austin 'PUBLIC INTOXICATION' incidents occurring in calendar year 2016; daily_counts: aggregates incidents_2016 by event date and counts incidents per day; z_scored_days: computes mean and stddev of daily counts, calculates each day's Z-score, and ranks days descending; second_highest_date: selects the date with rank 2 from z_scored_days and formats as 'YYYY-MM-DD'","{""target_db"": ""austin"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local196,local015,local067""}",2025-10-31T10:14:12
bq284,"Can you provide a breakdown of the total number of articles into different categories and the percentage of those articles that mention ""education"" within each category from the BBC News?",false,false,false,false,false,azure/o3,"local066,local021,local264,local300","bbc_articles: selects BBC News articles with category, title, and content; flagged_articles: adds flag if title or content contains case-insensitive 'education'; category_stats: sums total and flagged article counts per category; category_percent: calculates education article percentage per category for final output","bbc_articles: selects BBC News articles with category, title, and content; flagged_articles: adds flag if title or content contains case-insensitive 'education'; category_stats: sums total and flagged article counts per category; category_percent: calculates education article percentage per category for final output","{""target_db"": ""bbc"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local021,local264,local300""}",2025-10-31T10:14:18
bq413,"Retrieve the venue titles of publications that have a `date_inserted` from the year 2021 onwards and are associated with a grid whose address city is 'Qianjiang'. For each publication, prioritize the venue title by selecting the journal title first if it exists; if not, then the proceedings title; if that's also unavailable, then the book title; and finally, if none of those are available, the book series title.",false,false,false,false,false,azure/o3,"local066,local059,local078,local264","qianjiang_grids: selects grid IDs whose address city equals 'Qianjiang'; recent_pubs: filters publications with date_inserted on or after 2021-01-01; pubs_with_grids: links recent publications to Qianjiang grids via grid_id; venue_selection: assigns preferred_venue_title using journal, else proceedings, else book, else book_series","qianjiang_grids: selects grid IDs whose address city equals 'Qianjiang'; recent_pubs: filters publications with date_inserted on or after 2021-01-01; pubs_with_grids: links recent publications to Qianjiang grids via grid_id; venue_selection: assigns preferred_venue_title using journal, else proceedings, else book, else book_series","{""target_db"": ""dimensions_ai_covid19"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local059,local078,local264""}",2025-10-31T10:14:23
bq425,"Using data from ChEMBL Release 23, retrieve all distinct molecules associated with the company 'SanofiAventis,' listing the trade name and the most recent approval date for each molecule. Make sure to keep only the latest approval date per molecule and ensure the company field precisely matches 'SanofiAventis' without relying on other fields.",false,false,false,false,false,azure/o3,"local199,local037,local300,local017","sanofi_molecules: Retrieves distinct molecule IDs associated with company name exactly 'SanofiAventis'; molecule_approvals: Gets all approval dates for molecules from sanofi_molecules via approvals table; latest_approvals: Keeps latest approval per molecule using descending date row_number filter; trade_names: Obtains preferred trade name for each molecule from synonym/product tables; final_molecule_list: Combines latest_approvals with trade_names, outputs molecule, trade name, latest approval date","sanofi_molecules: Retrieves distinct molecule IDs associated with company name exactly 'SanofiAventis'; molecule_approvals: Gets all approval dates for molecules from sanofi_molecules via approvals table; latest_approvals: Keeps latest approval per molecule using descending date row_number filter; trade_names: Obtains preferred trade name for each molecule from synonym/product tables; final_molecule_list: Combines latest_approvals with trade_names, outputs molecule, trade name, latest approval date","{""target_db"": ""ebi_chembl"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local037,local300,local017""}",2025-10-31T10:14:34
bq430,"Find pairs of different molecules tested in the same assay and standard type, where both have 10–15 heavy atoms, fewer than 5 activities in that assay, fewer than 2 duplicate activities, non-null standard values, and pChEMBL values over 10. For each pair, report the maximum heavy atom count, the latest publication date (calculated based on the document's rank within the same journal and year, and map it to a synthetic month and day), the highest document ID, classify the change in standard values as 'increase', 'decrease', or 'no-change' based on their values and relations, and generate UUIDs from their activity IDs and canonical SMILES.",false,false,false,false,true,azure/o3,"local244,local329,local194,local283","docs_dated: synthetic publication date per document via journal-year rank on first_page; activities_enriched: join activities to properties, structures, docs_dated; filter heavy_atoms 10-15, pChEMBL>10, non-null standard; assay_stats: count activities per assay and standard_type, keep totals<5; dup_stats: count repeat activities per assay-molecule, keep counts<2; eligible_activities: activities_enriched passing assay_stats and dup_stats filters; activity_pairs: distinct molecule pairs within same assay and standard_type; pair_metrics: for each pair derive max_heavy_atoms, latest_pub_date, max_doc_id, value change label, UUIDs","docs_dated: synthetic publication date per document via journal-year rank on first_page; activities_enriched: join activities to properties, structures, docs_dated; filter heavy_atoms 10-15, pChEMBL>10, non-null standard; assay_stats: count activities per assay and standard_type, keep totals<5; dup_stats: count repeat activities per assay-molecule, keep counts<2; eligible_activities: activities_enriched passing assay_stats and dup_stats filters; activity_pairs: distinct molecule pairs within same assay and standard_type; pair_metrics: for each pair derive max_heavy_atoms, latest_pub_date, max_doc_id, value change label, UUIDs","{""target_db"": ""ebi_chembl"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local329,local194,local283""}",2025-10-31T10:15:05
bq023,"Using the 2018 5-Year American Community Survey (ACS) for median incomes at the census tract level and the 2020 Federal Election Commission (FEC) individual contributions dataset filtered for donors in New York, matched to census tract geographies via a ZIP code to census tract crosswalk, calculate and list the average political donation amount and the median income for each census tract located in Kings County (Brooklyn), New York. ",false,false,false,false,false,azure/o3,"local253,local244,local059,local017","fec_ny_2020: filters 2020 FEC individual contributions to New York state, selecting zip5 and amount; kings_crosswalk: ZIP-to-tract mapping limited to Kings County tracts; donations_with_tract: joins contributions to crosswalk to assign tract geoid; avg_donation: computes average contribution amount per tract; acs_kings_income: pulls 2018 ACS median income for Kings County census tracts; tract_metrics: joins average donation with median income per tract for final output","fec_ny_2020: filters 2020 FEC individual contributions to New York state, selecting zip5 and amount; kings_crosswalk: ZIP-to-tract mapping limited to Kings County tracts; donations_with_tract: joins contributions to crosswalk to assign tract geoid; avg_donation: computes average contribution amount per tract; acs_kings_income: pulls 2018 ACS median income for Kings County census tracts; tract_metrics: joins average donation with median income per tract for final output","{""target_db"": ""fec"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local244,local059,local017""}",2025-10-31T10:15:28
bq094,"Please provide a list of all 2016 committees that supported at least one candidate and received a total amount of individual contributions between $0 and $200 (inclusive of more than $0 and less than $200) where these small-dollar contributions sum to more than $0 overall. For each qualifying committee, include its name, the number of unique candidates it supported, the candidates’ names in alphabetical order (separated by commas), and the total sum of these small-dollar donations received by the committee.",false,false,false,false,false,azure/o3,"local064,local194,local015,local024","indiv_2016_contribs: selects 2016 individual contributions with committee and candidate identifiers, names, amounts; small_dollar_contribs: filters to contributions greater than $0 and under $200; committee_small_totals: sums small-dollar amounts per committee, keeping totals between $0 and $200; committee_candidates: extracts unique committee–candidate name pairs from small_dollar_contribs; candidate_stats: aggregates committee_candidates into candidate count and alphabetical name list per committee; qualifying_committees: joins totals with stats, keeping committees supporting at least one candidate","indiv_2016_contribs: selects 2016 individual contributions with committee and candidate identifiers, names, amounts; small_dollar_contribs: filters to contributions greater than $0 and under $200; committee_small_totals: sums small-dollar amounts per committee, keeping totals between $0 and $200; committee_candidates: extracts unique committee–candidate name pairs from small_dollar_contribs; candidate_stats: aggregates committee_candidates into candidate count and alphabetical name list per committee; qualifying_committees: joins totals with stats, keeping committees supporting at least one candidate","{""target_db"": ""fec"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local194,local015,local024""}",2025-10-31T10:15:53
bq287,"Among all Utah ZIP codes, what is the 2017 American Community Survey employment rate for the population aged 16 or older in the ZIP code that has the fewest FDIC-insured bank locations?",false,false,false,false,false,azure/o3,"local310,local021,local037,local064",utah_bank_locations: Utah FDIC-insured bank rows with extracted 5-digit ZIP; zip_bank_counts: counts bank locations per ZIP; least_served_zip: selects ZIP with minimum bank count; acs_employment_rates: fetches 2017 ACS employment rate for age 16+ by ZIP; zip_employment_result: joins least_served_zip with acs_employment_rates to output employment rate,utah_bank_locations: Utah FDIC-insured bank rows with extracted 5-digit ZIP; zip_bank_counts: counts bank locations per ZIP; least_served_zip: selects ZIP with minimum bank count; acs_employment_rates: fetches 2017 ACS employment rate for age 16+ by ZIP; zip_employment_result: joins least_served_zip with acs_employment_rates to output employment rate,"{""target_db"": ""fda"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local021,local037,local064""}",2025-10-31T10:16:04
bq432,"Please provide the food events data where both \""date_created\"" and \""date_started\"" are between January 1 and January 31, 2015, apply the following data cleansing steps: split reactions and outcomes fields into arrays by commas, handle special numeric patterns in the products_brand_name field (where a digit is followed by comma and another digit) by preserving those numeric patterns while replacing other "", "" with "" -- "", replace "", "" with "" -- "" in products_industry_code, products_role, and products_industry_name fields, and calculate industry_code_length and brand_name_length as the array lengths after splitting. ",false,false,false,false,true,azure/o3,"local219,local070,local003,local064","jan_events: selects events where both date_created and date_started are between 2015-01-01 and 2015-01-31; brand_clean: preserves digit-comma-digit patterns, replaces other ', ' with ' -- ', builds brand_array, calculates brand_name_length; industry_clean: normalizes products_industry_code/role/name by replacing ', ' with ' -- ', splits codes array, derives industry_code_length; reaction_outcome_arrays: splits reactions and outcomes on commas into trimmed arrays; final_events: joins prior CTEs to output fully cleansed, enriched food event records","jan_events: selects events where both date_created and date_started are between 2015-01-01 and 2015-01-31; brand_clean: preserves digit-comma-digit patterns, replaces other ', ' with ' -- ', builds brand_array, calculates brand_name_length; industry_clean: normalizes products_industry_code/role/name by replacing ', ' with ' -- ', splits codes array, derives industry_code_length; reaction_outcome_arrays: splits reactions and outcomes on commas into trimmed arrays; final_events: joins prior CTEs to output fully cleansed, enriched food event records","{""target_db"": ""fda"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local219,local070,local003,local064""}",2025-10-31T10:16:20
bq285,Could you provide me with the zip code of the location that has the highest number of bank institutions in Florida?,false,false,false,false,false,azure/o3,"local264,local229,local157,local301",fl_banks: filters institution records to Florida; zip_counts: aggregates fl_banks by zip_code counting institutions; top_zip: selects zip_codes with highest institution_count sorted descending,fl_banks: filters institution records to Florida; zip_counts: aggregates fl_banks by zip_code counting institutions; top_zip: selects zip_codes with highest institution_count sorted descending,"{""target_db"": ""fda"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local229,local157,local301""}",2025-10-31T10:16:26
bq288,"What is the total number of all banking institutions in the state that has the highest sum of assets from banks established between January 1, 1900, and December 31, 2000, with institution names starting with 'Bank'?",false,false,false,false,false,azure/o3,"local311,local097,local244,local059",filtered_banks: banks with name starting 'Bank' and established between 1900-01-01 and 2000-12-31; state_asset_totals: sums assets per state from filtered_banks; top_state: selects state with highest summed assets; state_institution_count: counts all banking institutions in that state for result,filtered_banks: banks with name starting 'Bank' and established between 1900-01-01 and 2000-12-31; state_asset_totals: sums assets per state from filtered_banks; top_state: selects state with highest summed assets; state_institution_count: counts all banking institutions in that state for result,"{""target_db"": ""fda"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local311,local097,local244,local059""}",2025-10-31T10:16:35
bq418,"Determine which three lowest-level Reactome pathways (with TAS evidence) have the highest chi-squared statistics, considering only Homo sapiens targets associated with sorafenib under the conditions that the median assay value is ≤ 100 and both low and high assay values are ≤ 100 or null. For each of these three pathways, how many of these targets and non-targets lie within the pathway and outside it?",false,false,false,false,false,azure/o3,"local201,local157,local199,local070",target_set: Homo sapiens sorafenib targets passing median≤100 and low/high≤100 or null filters; leaf_pathways: lowest-level Reactome pathways with TAS evidence; gene_flags: all Homo sapiens genes flagged as target or non_target; pathway_genes: maps leaf_pathways to member genes; pathway_counts: aggregates counts of targets and non_targets inside and outside each pathway; chi_ranked: computes chi-square per pathway and selects top three,target_set: Homo sapiens sorafenib targets passing median≤100 and low/high≤100 or null filters; leaf_pathways: lowest-level Reactome pathways with TAS evidence; gene_flags: all Homo sapiens genes flagged as target or non_target; pathway_genes: maps leaf_pathways to member genes; pathway_counts: aggregates counts of targets and non_targets inside and outside each pathway; chi_ranked: computes chi-square per pathway and selects top three,"{""target_db"": ""targetome_reactome"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local157,local199,local070""}",2025-10-31T10:16:48
bq330,"Which Colorado zip code has the highest concentration of bank locations per block group, based on the overlap between zip codes and block groups?",false,false,false,false,true,azure/o3,"local023,local301,local037,local264","co_geos: retrieves Colorado ZIP code and block group geometries with identifiers; zip_bg_overlap: intersects co_geos geometries, calculates overlap_area and overlap_ratio per zip–block_group pair; banks_by_zip: counts bank locations falling within each Colorado ZIP code polygon; banks_distributed: allocates banks_by_zip counts to block groups using overlap_ratio, yielding estimated banks_per_bg; zip_bank_density: computes average banks_per_bg per ZIP, ranks to identify zip with highest block-group concentration","co_geos: retrieves Colorado ZIP code and block group geometries with identifiers; zip_bg_overlap: intersects co_geos geometries, calculates overlap_area and overlap_ratio per zip–block_group pair; banks_by_zip: counts bank locations falling within each Colorado ZIP code polygon; banks_distributed: allocates banks_by_zip counts to block groups using overlap_ratio, yielding estimated banks_per_bg; zip_bank_density: computes average banks_per_bg per ZIP, ranks to identify zip with highest block-group concentration","{""target_db"": ""fda"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local301,local037,local264""}",2025-10-31T10:17:04
bq398,What are the top three debt indicators for Russia based on the highest debt values?,false,false,false,false,false,azure/o3,"local300,local056,local201,local219",russia_records: filters debt dataset to rows for Russia; indicator_values: aggregates to highest recorded debt value per indicator for Russia; ranked_indicators: orders indicators by debt value desc and picks top three,russia_records: filters debt dataset to rows for Russia; indicator_values: aggregates to highest recorded debt value per indicator for Russia; ranked_indicators: orders indicators by debt value desc and picks top three,"{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local056,local201,local219""}",2025-10-31T10:17:11
bq399,"Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?",false,false,false,false,false,azure/o3,"local021,local003,local010,local311","high_income_1980s: selects 1980-1989 records for countries labeled high income; country_avg_births: averages crude birth rate per country for decade, keeping region; region_max_births: selects highest-average country per region with its mean birth rate","high_income_1980s: selects 1980-1989 records for countries labeled high income; country_avg_births: averages crude birth rate per country for decade, keeping region; region_max_births: selects highest-average country per region with its mean birth rate","{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local003,local010,local311""}",2025-10-31T10:17:19
bq457,"Get details of repositories that use specific feature toggle libraries. For each repository, include the full name with owner, hosting platform type, size in bytes, primary programming language, fork source name (if any), last update timestamp, the artifact and library names of the feature toggle used, and the library's programming languages. Include repositories that depend on the specified feature toggle libraries, defined by their artifact names, library names, platforms, and languages.",false,false,false,false,true,azure/o3,"local244,local064,local329,local021","feature_toggle_libs: curated list of toggle libraries with artifact, name, platform, languages; dependency_matches: dependency records whose artifact matches feature_toggle_libs; repo_feature_usage: associates repositories with matched library and language details; repo_details: retrieves full name, host platform, size, primary language, fork source, updated_at for involved repositories","feature_toggle_libs: curated list of toggle libraries with artifact, name, platform, languages; dependency_matches: dependency records whose artifact matches feature_toggle_libs; repo_feature_usage: associates repositories with matched library and language details; repo_details: retrieves full name, host platform, size, primary language, fork source, updated_at for involved repositories","{""target_db"": ""libraries_io"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local064,local329,local021""}",2025-10-31T10:17:32
bq227,"Could you provide the annual percentage shares, rounded to two decimal places, of the top 5 minor crime categories from 2008 in London's total crimes, with each year displayed in one row?",false,false,false,false,false,azure/o3,"local021,local067,local078,local075",categories_2008: counts minor crime occurrences per category for 2008; top5_categories: selects five highest-count minor categories from 2008; annual_totals: aggregates total crime counts per year citywide; annual_top5_counts: aggregates yearly counts for categories in top5 set; yearly_percentages: joins annual_top5_counts with totals to compute category share rounded to two decimals,categories_2008: counts minor crime occurrences per category for 2008; top5_categories: selects five highest-count minor categories from 2008; annual_totals: aggregates total crime counts per year citywide; annual_top5_counts: aggregates yearly counts for categories in top5 set; yearly_percentages: joins annual_top5_counts with totals to compute category share rounded to two decimals,"{""target_db"": ""london"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local067,local078,local075""}",2025-10-31T10:17:44
bq232,Could you provide the total number of 'Other Theft' incidents within the 'Theft and Handling' category for each year in the Westminster borough?,false,false,false,false,false,azure/o3,"local300,local229,local015,local141","filtered_incidents: isolates Westminster borough incidents with 'Theft and Handling' major and 'Other Theft' minor; yearly_totals: extracts year from incident date, counts incidents per year, orders chronologically","filtered_incidents: isolates Westminster borough incidents with 'Theft and Handling' major and 'Other Theft' minor; yearly_totals: extracts year from incident date, counts incidents per year, orders chronologically","{""target_db"": ""london"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local300,local229,local015,local141""}",2025-10-31T10:17:55
bq228,"Please provide a list of the top three major crime categories in the borough of Barking and Dagenham, along with the number of incidents in each category.",false,false,false,false,false,azure/o3,"local067,local074,local026,local310",barking_dagenham_incidents: filters crime records to Barking and Dagenham borough; category_counts: counts incidents per major_category from filtered data; top_three_categories: orders category_counts descending and limits to top three categories,barking_dagenham_incidents: filters crime records to Barking and Dagenham borough; category_counts: counts incidents per major_category from filtered data; top_three_categories: orders category_counts descending and limits to top three categories,"{""target_db"": ""london"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local067,local074,local026,local310""}",2025-10-31T10:18:05
bq229,"Using the bigquery-public-data.open_images dataset, can you provide a count of how many distinct image URLs are categorized as 'cat' (where the image has label '/m/01yrx' with confidence=1) and how many distinct image URLs are categorized as 'other' (meaning they have no cat label '/m/01yrx' at all)?",false,false,false,false,false,azure/o3,"local075,local059,local037,local194",labelled_cats: distinct image_ids with label '/m/01yrx' and confidence 1; all_images: distinct image_id and url from images table; cat_urls: join labelled_cats to all_images to get unique cat URLs; other_urls: select URLs from all_images whose image_id not in labelled_cats,labelled_cats: distinct image_ids with label '/m/01yrx' and confidence 1; all_images: distinct image_id and url from images table; cat_urls: join labelled_cats to all_images to get unique cat URLs; other_urls: select URLs from all_images whose image_id not in labelled_cats,"{""target_db"": ""open_images"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local059,local037,local194""}",2025-10-31T10:18:16
bq230,"Using the crops dataset, find the total 2022 production figures, measured in bushels, for corn from the 'FIELD CROPS' category and mushrooms from the 'HORTICULTURE' group for each U.S. state. Only include data rows where 'statisticcat_desc' is 'PRODUCTION', 'agg_level_desc' is 'STATE', 'value' is not null, and ensure that for corn the 'unit_desc' is 'BU'. Combine both results so that each state’s 2022 corn and mushroom totals are presented.",false,false,false,false,false,azure/o3,"local077,local021,local311,local097",base_2022: filters 2022 STATE-level PRODUCTION rows with non-null value; corn_state_totals: aggregates bushels for corn in FIELD CROPS per state; mushroom_state_totals: aggregates production for mushrooms in HORTICULTURE per state; combined_totals: merges corn and mushroom state totals into single row per state,base_2022: filters 2022 STATE-level PRODUCTION rows with non-null value; corn_state_totals: aggregates bushels for corn in FIELD CROPS per state; mushroom_state_totals: aggregates production for mushrooms in HORTICULTURE per state; combined_totals: merges corn and mushroom state totals into single row per state,"{""target_db"": ""usda_nass_agriculture"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local021,local311,local097""}",2025-10-31T10:18:27
bq326,"Based on the World Bank global population dataset and the World Bank health nutrition population dataset, how many countries experienced an increase of more than 1% from the previous year to 2018 in both their total population and per capita current health expenditure (PPP)?",false,false,false,false,false,azure/o3,"local017,local015,local064,local037","pop_years: fetch 2017 and 2018 total population by country; pop_growth_gt1: calculate 2018 vs 2017 population percent increase, keep >1%; health_years: fetch 2017 and 2018 per capita health expenditure PPP by country; health_growth_gt1: calculate 2018 vs 2017 health spend percent increase, keep >1%; qualified_countries: intersect countries with >1% growth in both metrics; final_count: count countries in qualified_countries","pop_years: fetch 2017 and 2018 total population by country; pop_growth_gt1: calculate 2018 vs 2017 population percent increase, keep >1%; health_years: fetch 2017 and 2018 per capita health expenditure PPP by country; health_growth_gt1: calculate 2018 vs 2017 health spend percent increase, keep >1%; qualified_countries: intersect countries with >1% growth in both metrics; final_count: count countries in qualified_countries","{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local015,local064,local037""}",2025-10-31T10:18:40
bq424,"List the top 10 countries with respect to the total amount of long-term external debt in descending order, excluding those without a specified region.",false,false,false,false,false,azure/o3,"local023,local219,local010,local017",debt_lt: isolates long-term external debt records with country and amount; valid_country_regions: retrieves country-region mappings excluding null or unspecified regions; country_totals: sums long-term debt per country after joining debt_lt with valid_country_regions; top10_countries: ranks countries by total debt descending and keeps top ten,debt_lt: isolates long-term external debt records with country and amount; valid_country_regions: retrieves country-region mappings excluding null or unspecified regions; country_totals: sums long-term debt per country after joining debt_lt with valid_country_regions; top10_countries: ranks countries by total debt descending and keeps top ten,"{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local219,local010,local017""}",2025-10-31T10:18:49
bq327,"How many debt indicators for Russia have a value of 0, excluding NULL values?",false,false,false,false,false,azure/o3,"local003,local026,local070,local010",debt_values: filters records to Russia’s debt indicators with non-null values; zero_debt_values: retains only rows where indicator_value equals 0; distinct_zero_indicators: selects unique indicator_ids from zero_debt_values and counts them,debt_values: filters records to Russia’s debt indicators with non-null values; zero_debt_values: retains only rows where indicator_value equals 0; distinct_zero_indicators: selects unique indicator_ids from zero_debt_values and counts them,"{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local026,local070,local010""}",2025-10-31T10:18:56
bq328,Which region has the highest median GDP (constant 2015 US$) value?,false,false,false,false,false,azure/o3,"local015,local196,local037,local075","clean_gdp: selects region and constant 2015 GDP rows, removes nulls; region_median: computes median GDP per region via window/aggregate; top_region: orders regions by median descending, keeps highest","clean_gdp: selects region and constant 2015 GDP rows, removes nulls; region_median: computes median GDP per region via window/aggregate; top_region: orders regions by median descending, keeps highest","{""target_db"": ""world_bank"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local196,local037,local075""}",2025-10-31T10:19:02
bq393,"I want to identify users who had activity followed by inactivity. Specifically, find the user ID and their corresponding month number (counting from their first activity month) for the user with the highest month number who became inactive (no activity recorded) after their last recorded activity month. For this analysis, only consider data up until September 10, 2024, and ensure the month number represents the count of months since the user's first activity. The user should have at least one month where they were expected to be active (within their activity span) but actually had no records.",false,false,false,false,false,azure/o3,"local201,local229,local157,local010","monthly_activity: lists distinct user_id and activity_month up to 2024-09-10; span_stats: derives first_month, last_month, and month_count_since_first per user; inactive_candidates: filters users whose last_month precedes 2024-09, confirming post-activity inactivity; ranked_user: selects user with greatest month_count_since_first for final output","monthly_activity: lists distinct user_id and activity_month up to 2024-09-10; span_stats: derives first_month, last_month, and month_count_since_first per user; inactive_candidates: filters users whose last_month precedes 2024-09, confirming post-activity inactivity; ranked_user: selects user with greatest month_count_since_first for final output","{""target_db"": ""hacker_news"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local229,local157,local010""}",2025-10-31T10:19:49
bq403,Which three years in 2012-2017 have the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms? Please output three years and respective differences.,false,false,false,false,false,azure/o3,"local037,local066,local070,local141",filtered_filings: selects 2012-2017 IRS 990 filings with nonnull revenue and functional_expenses; yearly_medians: computes per-year median revenue and median functional expenses; med_diff: calculates absolute difference between the two medians per year; top_years: ranks differences ascending and selects three smallest years,filtered_filings: selects 2012-2017 IRS 990 filings with nonnull revenue and functional_expenses; yearly_medians: computes per-year median revenue and median functional expenses; med_diff: calculates absolute difference between the two medians per year; top_years: ranks differences ascending and selects three smallest years,"{""target_db"": ""irs_990"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local037,local066,local070,local141""}",2025-10-31T10:20:00
bq397,"After removing any duplicate records from the rev_transactions dataset, identify each channel grouping that has transactions from more than one country. For each such channel grouping, find the country with the highest total number of transactions and report both the country name and the sum of transactions for that channel grouping.",false,false,false,false,false,azure/o3,"local201,local060,local244,local023",deduped_txns: removes exact duplicate records from rev_transactions; channel_country_totals: counts transactions per channel_grouping and country; multi_country_channels: keeps channel_groupings appearing in more than one country; top_country_per_channel: selects highest-transaction country and sum for each qualifying channel_grouping,deduped_txns: removes exact duplicate records from rev_transactions; channel_country_totals: counts transactions per channel_grouping and country; multi_country_channels: keeps channel_groupings appearing in more than one country; top_country_per_channel: selects highest-transaction country and sum for each qualifying channel_grouping,"{""target_db"": ""ecommerce"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local060,local244,local023""}",2025-10-31T10:20:08
bq402,"Calculate the conversion rate from unique visitors to purchasers by using data exclusively from the `web_analytics` table in the `data-to-insights.ecommerce` dataset. A visitor is defined as a unique `fullVisitorId` present in the table, while a purchaser is a visitor who has at least one transaction recorded (`totals.transactions` is not null). The conversion rate is computed by dividing the number of unique purchasers by the total number of unique visitors. Additionally, calculate the average number of transactions per purchaser, considering only those visitors who have made at least one transaction.",false,false,false,false,false,azure/o3,"local283,local023,local024,local264","visitors: retrieves distinct fullVisitorId as total visitors; purchaser_txn: filters non-null transactions and sums transactions per visitor; conversion_stats: computes visitor count, purchaser count, conversion rate, and average transactions per purchaser","visitors: retrieves distinct fullVisitorId as total visitors; purchaser_txn: filters non-null transactions and sums transactions per visitor; conversion_stats: computes visitor count, purchaser count, conversion rate, and average transactions per purchaser","{""target_db"": ""ecommerce"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local023,local024,local264""}",2025-10-31T10:20:16
ga001,I want to know the preferences of customers who purchased the Google Navy Speckled Tee in December 2020. What other product was purchased with the highest total quantity alongside this item?,false,false,false,false,false,azure/o3,"local024,local015,local301,local026",tee_orders_dec2020: selects order_id and customer_id for December 2020 orders containing 'Google Navy Speckled Tee'; co_purchase_lines: retrieves other product lines from those orders with their quantities; product_totals: sums quantities per product to identify highest volume co-purchase,tee_orders_dec2020: selects order_id and customer_id for December 2020 orders containing 'Google Navy Speckled Tee'; co_purchase_lines: retrieves other product lines from those orders with their quantities; product_totals: sums quantities per product to identify highest volume co-purchase,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local015,local301,local026""}",2025-10-31T10:20:34
ga002,Tell me the most purchased other products and their quantities by customers who bought the Google Red Speckled Tee each month for the three months starting from November 2020.,false,false,false,false,false,azure/o3,"local329,local056,local196,local141",tee_buyers: customers buying 'Google Red Speckled Tee' Nov 2020–Jan 2021 with purchase_month; other_purchases: purchase lines by tee_buyers in same month excluding the tee product; product_month_totals: aggregates total quantity per month and product for other_purchases; monthly_top_products: keeps product(s) with highest quantity each month from product_month_totals,tee_buyers: customers buying 'Google Red Speckled Tee' Nov 2020–Jan 2021 with purchase_month; other_purchases: purchase lines by tee_buyers in same month excluding the tee product; product_month_totals: aggregates total quantity per month and product for other_purchases; monthly_top_products: keeps product(s) with highest quantity each month from product_month_totals,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local056,local196,local141""}",2025-10-31T10:20:57
ga003,"I'm trying to evaluate which board types were most effective on September 15, 2018. Can you find out the average scores for each board type from the quick play mode completions on that day?",false,false,false,false,false,azure/o3,"local157,local099,local078,local077",quick_play_sept15: selects quick play completions from 2018-09-15 retaining board_type and score; board_type_avg: averages score per board_type using quick_play_sept15,quick_play_sept15: selects quick play completions from 2018-09-15 retaining board_type and score; board_type_avg: averages score per board_type using quick_play_sept15,"{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local099,local078,local077""}",2025-10-31T10:21:02
ga004,Can you figure out the average difference in pageviews between users who bought something and those who didn’t in December 2020? Just label anyone who was involved in purchase events as a purchaser.,false,false,false,false,false,azure/o3,"local199,local010,local219,local244","dec_events: filters events occurring during December 2020; pageviews_dec: aggregates pageview counts per user from dec_events; purchasers_dec: selects distinct users with purchase events in dec_events; user_stats: merges pageviews_dec with purchasers_dec, flags purchaser status, fills missing counts with zero; avg_views: calculates average pageviews per purchaser flag and their difference","dec_events: filters events occurring during December 2020; pageviews_dec: aggregates pageview counts per user from dec_events; purchasers_dec: selects distinct users with purchase events in dec_events; user_stats: merges pageviews_dec with purchasers_dec, flags purchaser status, fills missing counts with zero; avg_views: calculates average pageviews per purchaser flag and their difference","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local010,local219,local244""}",2025-10-31T10:21:15
ga008,"Could you provide the total number of page views for each day in November 2020 as well as the average number of page views per user on those days, restricted to users who made at least one purchase in November 2020?",false,false,false,false,false,azure/o3,"local077,local060,local023,local253",purchasing_users: selects user_ids with at least one purchase in November 2020; nov_views: filters page_view records in November 2020 for purchasing_users; daily_user_views: counts views per user per day from nov_views; daily_metrics: aggregates daily total views and average views per user,purchasing_users: selects user_ids with at least one purchase in November 2020; nov_views: filters page_view records in November 2020 for purchasing_users; daily_user_views: counts views per user per day from nov_views; daily_metrics: aggregates daily total views and average views per user,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local060,local023,local253""}",2025-10-31T10:21:33
ga017,How many distinct users viewed the most frequently visited page during January 2021?,false,false,false,false,false,azure/o3,"local056,local310,local157,local023",jan_views: filters views to January 2021 retaining page_id and user_id; page_totals: aggregates jan_views to visit counts per page; top_page: selects page_id(s) with highest visit count; top_page_users: distinct user_ids who viewed the top page(s),jan_views: filters views to January 2021 retaining page_id and user_id; page_totals: aggregates jan_views to visit counts per page; top_page: selects page_id(s) with highest visit count; top_page_users: distinct user_ids who viewed the top page(s),"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local310,local157,local023""}",2025-10-31T10:21:45
ga007,"Please find out what percentage of the page views on January 2, 2021, were for PDP type pages.",false,false,false,false,true,azure/o3,"local264,local066,local015,local141","jan2_views: selects page views for 2021-01-02; parsed_urls: splits url into segments, gets 4th, 5th, last parts, plus '+' and category flags; pdp_flagged: applies criteria to mark is_pdp for each view; daily_counts: totals views and pdp views, calculates percentage","jan2_views: selects page views for 2021-01-02; parsed_urls: splits url into segments, gets 4th, 5th, last parts, plus '+' and category flags; pdp_flagged: applies criteria to mark is_pdp for each view; daily_counts: totals views and pdp views, calculates percentage","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local066,local015,local141""}",2025-10-31T10:22:01
ga013,"I want to know all the pages visited by user 1402138.5184246691 on January 2, 2021. Please show the names of these pages and adjust the names to PDP or PLP where necessary.",false,false,false,false,true,azure/o3,"local253,local199,local070,local196","user_day_visits: filters web logs for user 1402138.5184246691 on 2021-01-02; parsed_urls: splits each url into segments, flags plus sign and category keyword presence; classified_pages: assigns adjusted_page_name as PDP, PLP, or original based on rules; distinct_pages: lists unique adjusted pages with earliest visit time for ordered output","user_day_visits: filters web logs for user 1402138.5184246691 on 2021-01-02; parsed_urls: splits each url into segments, flags plus sign and category keyword presence; classified_pages: assigns adjusted_page_name as PDP, PLP, or original based on rules; distinct_pages: lists unique adjusted pages with earliest visit time for ordered output","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local199,local070,local196""}",2025-10-31T10:22:13
ga018,"On January 2nd, 2021, I want to determine the percentage of times users transition from a product list page (PLP) view to a product detail page (PDP) view within the same session, using only page_view events. Could you calculate how many PLP views eventually led to a PDP view in the same session on that date, and then provide the resulting percentage of PLP-to-PDP transitions?",false,false,false,false,true,azure/o3,"local244,local228,local056,local264","filtered_views: page_view events on 2021-01-02 with session identifiers and url; classified_views: labels each event PLP or PDP using segment and keyword rules; plp_lead_flags: flags each PLP if any later PDP in same session via window scan; summary_stats: computes total PLP views, PLP leading to PDP, and transition percentage","filtered_views: page_view events on 2021-01-02 with session identifiers and url; classified_views: labels each event PLP or PDP using segment and keyword rules; plp_lead_flags: flags each PLP if any later PDP in same session via window scan; summary_stats: computes total PLP views, PLP leading to PDP, and transition percentage","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local228,local056,local264""}",2025-10-31T10:22:38
ga032,"Can you generate the navigation flow for user with pseudo_id '1362228.4966015575' on January 28th 2021, showing only the page_view events? Please connect the page titles with '>>' between each step, convert product detail pages to 'PDP' and product listing pages to 'PLP' based on the URL structure, and merge adjacent identical pages so they only appear once in the sequence. I need to understand how this specific user navigated through our website on that day.",false,false,false,false,true,azure/o3,"local064,local056,local060,local066","user_pageviews: filters page_view events for pseudo_id 1362228.4966015575 on 2021-01-28; classified_pages: tags each view as PDP, PLP, or original title per URL rules; sequenced_pages: orders views chronologically and adds previous label via lag; dedup_steps: removes consecutive duplicate labels to merge adjacent same pages; nav_flow: concatenates dedup labels in order using '>>' delimiter","user_pageviews: filters page_view events for pseudo_id 1362228.4966015575 on 2021-01-28; classified_pages: tags each view as PDP, PLP, or original title per URL rules; sequenced_pages: orders views chronologically and adds previous label via lag; dedup_steps: removes consecutive duplicate labels to merge adjacent same pages; nav_flow: concatenates dedup labels in order using '>>' delimiter","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local056,local060,local066""}",2025-10-31T10:23:01
ga031,"I want to know the user session conversion rate on January 2nd, 2021, using only 'page_view' events. The conversion rate should be calculated as the percentage of user visits that reached both the Home and Checkout Confirmation pages in one session, relative to those that landed on the Home page.",false,false,false,false,false,azure/o3,"local097,local026,local067,local060",date_page_views: page_view events for 2021-01-02 with session_id and page_name; session_flags: per session flag visit_home and visit_confirm using aggregated page_names; home_sessions: sessions with visit_home=true; converted_sessions: sessions with visit_home and visit_confirm=true; conversion_rate: counts home_sessions and converted_sessions to calculate conversion percentage,date_page_views: page_view events for 2021-01-02 with session_id and page_name; session_flags: per session flag visit_home and visit_confirm using aggregated page_names; home_sessions: sessions with visit_home=true; converted_sessions: sessions with visit_home and visit_confirm=true; conversion_rate: counts home_sessions and converted_sessions to calculate conversion percentage,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local097,local026,local067,local060""}",2025-10-31T10:23:13
ga006,"For the date range November 1–30, 2020, can you retrieve each user_pseudo_id and its average purchase revenue in USD per session for users who had more than one purchase session, considering only events with event_name='purchase' and a non-null ecommerce.purchase_revenue_in_usd, grouping sessions by the ga_session_id from event_params",false,false,false,false,false,azure/o3,"local003,local219,local067,local070","nov_purchases: Nov 1–30 2020 purchase events with revenue, extracts ga_session_id; session_revenue: totals revenue per user_pseudo_id and ga_session_id; user_session_metrics: counts purchase sessions and averages revenue per user; multi_session_users: keeps users with session_count > 1 for final output","nov_purchases: Nov 1–30 2020 purchase events with revenue, extracts ga_session_id; session_revenue: totals revenue per user_pseudo_id and ga_session_id; user_session_metrics: counts purchase sessions and averages revenue per user; multi_session_users: keeps users with session_count > 1 for final output","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local219,local067,local070""}",2025-10-31T10:23:29
ga009,"Could you tell me the average number of engaged sessions per user for December 2020, counting only those sessions where the event parameter 'session_engaged' is equal to '1' and using 'user_pseudo_id' combined with the 'ga_session_id' to identify distinct sessions?",false,false,false,false,false,azure/o3,"local194,local157,local264,local199",dec2020_events: selects events dated December 2020; engaged_sessions: filters dec2020_events to session_engaged='1' and deduplicates user_pseudo_id+ga_session_id; sessions_per_user: counts engaged sessions per user_pseudo_id; avg_sessions_per_user: calculates average engaged session count across users,dec2020_events: selects events dated December 2020; engaged_sessions: filters dec2020_events to session_engaged='1' and deduplicates user_pseudo_id+ga_session_id; sessions_per_user: counts engaged sessions per user_pseudo_id; avg_sessions_per_user: calculates average engaged session count across users,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local157,local264,local199""}",2025-10-31T10:23:41
ga010,Can you give me an overview of our website traffic for December 2020? I'm particularly interested in the channel with the fourth highest number of sessions.,false,false,false,false,true,azure/o3,"local283,local023,local067,local099",dec_traffic: filters session logs to December 2020 rows; channel_mapped: assigns standard channel based on source and medium rules; channel_totals: counts sessions per channel for the month; ranked_channels: orders channels by session count with rank numbers; fourth_channel: selects record where rank equals four for reporting,dec_traffic: filters session logs to December 2020 rows; channel_mapped: assigns standard channel based on source and medium rules; channel_totals: counts sessions per channel for the month; ranked_channels: orders channels by session count with rank numbers; fourth_channel: selects record where rank equals four for reporting,"{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local023,local067,local099""}",2025-10-31T10:24:08
ga014,"Can you provide the total number of sessions for each traffic channel in December 2020, using the information from the 'event_params' ",false,false,false,false,true,azure/o3,"local130,local201,local003,local032","base_events: filter events to December 2020 and pick session_id plus source, medium, campaign params; session_first_touch: keep each session’s earliest event with marketing attributes; channel_mapping: derive traffic_channel per session using channel-group rules; channel_session_counts: aggregate distinct sessions by traffic_channel","base_events: filter events to December 2020 and pick session_id plus source, medium, campaign params; session_first_touch: keep each session’s earliest event with marketing attributes; channel_mapping: derive traffic_channel per session using channel-group rules; channel_session_counts: aggregate distinct sessions by traffic_channel","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local201,local003,local032""}",2025-10-31T10:24:16
ga011,"What is the page with the second highest total page views, after cleaning up its URL (removing extra slashes) and extracting the correct page path, on the website 'shop.googlemerchandisestore.com' during December 2020?",false,false,false,false,false,azure/o3,"local228,local097,local077,local074","dec_hits: select December 2020 rows for host 'shop.googlemerchandisestore.com'; cleaned_paths: normalize request URLs by stripping protocol, host, query and collapsing extra slashes; page_totals: sum pageviews per normalized path; ranked_pages: rank paths by views descending to find second highest","dec_hits: select December 2020 rows for host 'shop.googlemerchandisestore.com'; cleaned_paths: normalize request URLs by stripping protocol, host, query and collapsing extra slashes; page_totals: sum pageviews per normalized path; ranked_pages: rank paths by views descending to find second highest","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local228,local097,local077,local074""}",2025-10-31T10:24:26
ga012,"On November 30, 2020, identify the item category with the highest tax rate by dividing tax value in usd by purchase revenue in usd for purchase events, and then retrieve the transaction IDs, total item quantities, and both purchase revenue in usd and purchase revenue for those purchase events in that top-tax-rate category.",false,false,false,false,false,azure/o3,"local099,local196,local300,local228","nov30_purchases: filters purchase events for 2020-11-30 with category, transaction_id, quantity, tax_value_usd, purchase_revenue_usd, purchase_revenue; category_tax_rates: sums tax_value_usd and purchase_revenue_usd per category, computes tax_rate; highest_rate_category: selects category having maximum tax_rate; target_events: keeps nov30_purchases rows belonging to highest_rate_category; transaction_summary: aggregates target_events by transaction_id summing quantity, purchase_revenue_usd, purchase_revenue","nov30_purchases: filters purchase events for 2020-11-30 with category, transaction_id, quantity, tax_value_usd, purchase_revenue_usd, purchase_revenue; category_tax_rates: sums tax_value_usd and purchase_revenue_usd per category, computes tax_rate; highest_rate_category: selects category having maximum tax_rate; target_events: keeps nov30_purchases rows belonging to highest_rate_category; transaction_summary: aggregates target_events by transaction_id summing quantity, purchase_revenue_usd, purchase_revenue","{""target_db"": ""ga4"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local099,local196,local300,local228""}",2025-10-31T10:24:48
ga019,Could you determine what percentage of users either did not uninstall our app within seven days or never uninstalled it after installing during August and September 2018?,false,false,false,false,false,azure/o3,"local067,local329,local015,local077",installs_aug_sep: filters installs in Aug-Sep 2018; one row per user with install_date; earliest_uninstall: selects each user's earliest uninstall_date; early_uninstalls: identifies users whose earliest uninstall ≤ install_date + 7 days; retained_or_never: users from installs without early_uninstalls match (late or no uninstall); percent_stats: aggregates total installs and retained_or_never users to calculate percentage,installs_aug_sep: filters installs in Aug-Sep 2018; one row per user with install_date; earliest_uninstall: selects each user's earliest uninstall_date; early_uninstalls: identifies users whose earliest uninstall ≤ install_date + 7 days; retained_or_never: users from installs without early_uninstalls match (late or no uninstall); percent_stats: aggregates total installs and retained_or_never users to calculate percentage,"{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local067,local329,local015,local077""}",2025-10-31T10:25:03
ga030,"Can you group users by the week of their first session start, starting from July 2, 2018? For each group, calculate the retention rate in the fourth week (i.e., the percentage of users from the original group who returned in the fourth week after their first session). Please identify the cohort with the highest retention rate in the fourth week, and name the group by the Monday date of the cohort's first session week. Return the result in the format ""YYYY-MM-DD"".",false,false,false,false,true,azure/o3,"local075,local032,local017,local300","first_sessions: extracts each user_id and their earliest session_start_date; cohorts: filters first_sessions from 2018-07-02 onward and assigns cohort_start Monday of that week; user_week_activity: joins sessions to cohorts, computing week_offset between session_date and cohort_start; week4_flags: identifies users having any session with week_offset = 4; retention_by_cohort: counts total cohort users and week4 returners, calculates retention_rate per cohort_start; best_cohort: selects cohort_start with highest retention_rate, formats as YYYY-MM-DD","first_sessions: extracts each user_id and their earliest session_start_date; cohorts: filters first_sessions from 2018-07-02 onward and assigns cohort_start Monday of that week; user_week_activity: joins sessions to cohorts, computing week_offset between session_date and cohort_start; week4_flags: identifies users having any session with week_offset = 4; retention_by_cohort: counts total cohort users and week4 returners, calculates retention_rate per cohort_start; best_cohort: selects cohort_start with highest retention_rate, formats as YYYY-MM-DD","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local075,local032,local017,local300""}",2025-10-31T10:25:24
ga005,"Conduct a weekly cohort analysis for user retention, starting from July 9, 2018, and ending on October 2, 2018. Group users by the week of their first session_start event (with weeks starting on Monday), and identify new users as those where the event_date matches the date of their user_first_touch_timestamp. Calculate the Week 2 retention rate for each weekly cohort, defined as the percentage of users who had a session_start event exactly 2 weeks after their first week. Only include cohorts from July 9, 2018 through September 17, 2018 (the last cohort that can be analyzed for 2-week retention given the available data). Present the results with each weekly cohort and its corresponding Week 2 retention rate, ordered by cohort date.",false,false,false,false,true,azure/o3,"local229,local310,local329,local311","session_events: filters session_start events between 2018-07-09 and 2018-10-02 with user_id and event_date; new_users_cohort: selects events where event_date equals first_touch_date, derives Monday cohort_start_date per user; cohort_sizes: counts distinct cohort users per cohort_start_date; week2_returning_users: identifies cohort users having session_start on cohort_start_date + 14 days; cohort_retention_rates: joins counts with week2 returns and calculates retention percentage, restricts cohorts through 2018-09-17, orders by cohort_start_date","session_events: filters session_start events between 2018-07-09 and 2018-10-02 with user_id and event_date; new_users_cohort: selects events where event_date equals first_touch_date, derives Monday cohort_start_date per user; cohort_sizes: counts distinct cohort users per cohort_start_date; week2_returning_users: identifies cohort users having session_start on cohort_start_date + 14 days; cohort_retention_rates: joins counts with week2 returns and calculates retention percentage, restricts cohorts through 2018-09-17, orders by cohort_start_date","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local229,local310,local329,local311""}",2025-10-31T10:25:47
ga028,"Please perform a 7-day retention analysis for users who first session start the app during the week starting on July 2, 2018. For each week from Week 0 (the week of their first session) to Week 4, provide the total number of new users in Week 0 and the number of retained users for each subsequent week. Ensuring that you only count events up to October 2, 2018, and group dates by Monday-based weeks",false,false,false,false,true,azure/o3,"local283,local017,local070,local228","first_sessions: finds min session_date per user; cohort_users: filters first_sessions to week_start 2018-07-02 cohort; events_with_offsets: events till 2018-10-02 for cohort, compute week_start and offset; user_week_flags: distinct user and week_offset rows 0-4; retention_summary: counts cohort size and retained users by week_offset","first_sessions: finds min session_date per user; cohort_users: filters first_sessions to week_start 2018-07-02 cohort; events_with_offsets: events till 2018-10-02 for cohort, compute week_start and offset; user_week_flags: distinct user and week_offset rows 0-4; retention_summary: counts cohort size and retained users by week_offset","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local283,local017,local070,local228""}",2025-10-31T10:26:12
ga020,"Which quickplay event type had the lowest user retention rate during the second week after their initial engagement, for users who first engaged between August 1 and August 15, 2018, as measured by the presence of session_start events??",false,false,false,false,true,azure/o3,"local097,local141,local244,local010","cohort_quickplay_users: selects each user’s earliest quickplay event Aug 1–15 2018, capturing quickplay_type and cohort_date; cohort_sizes: counts distinct cohort users per quickplay_type; week2_retained_users: finds cohort users with any session_start 8–14 days after cohort_date; retention_rates: computes week-2 retention percent per quickplay_type and flags the lowest","cohort_quickplay_users: selects each user’s earliest quickplay event Aug 1–15 2018, capturing quickplay_type and cohort_date; cohort_sizes: counts distinct cohort users per quickplay_type; week2_retained_users: finds cohort users with any session_start 8–14 days after cohort_date; retention_rates: computes week-2 retention percent per quickplay_type and flags the lowest","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local097,local141,local244,local010""}",2025-10-31T10:26:26
ga021,"What is the retention rate for users two weeks after their initial quickplay event, calculated separately for each quickplay event type, within the period from July 2, 2018, to July 16, 2018? Please focus on users who started a session (session_start) during this period.",false,false,false,false,true,azure/o3,"local253,local219,local032,local067","cohort_users: distinct users with session_start between July 2–16 2018; quickplay_events: quickplay events for cohort_users with event_type and event_date; initial_quickplay: first quickplay per user and type within window; retained_users: users repeating same quickplay type exactly 14 days after initial; retention_stats: cohort and retained counts per type, compute retention rate","cohort_users: distinct users with session_start between July 2–16 2018; quickplay_events: quickplay events for cohort_users with event_type and event_date; initial_quickplay: first quickplay per user and type within window; retained_users: users repeating same quickplay type exactly 14 days after initial; retention_stats: cohort and retained counts per type, compute retention rate","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local219,local032,local067""}",2025-10-31T10:26:43
ga022,"Could you please help me get the weekly customer retention rate in September 2018 for new customers who first used our app (first_open event) within the first week starting from September 1st, 2018 (timezone in Shanghai)? The retention rates should cover the following weeks 1, 2, and 3 period after the initial use and display them in column format.",false,false,false,false,true,azure/o3,"local003,local074,local015,local194","cohort_users: selects users with first_open between 2018-09-01 and 2018-09-07 Shanghai; user_events: pulls all September 2018 events for cohort users with Shanghai timestamps; week_activity: joins events to cohort, assigns weeks_since_signup 1-3; distinct_week_visits: keeps unique user-week rows to prevent double counts; retention_rates: totals cohort and retained users per week, outputs week1-3 percentages","cohort_users: selects users with first_open between 2018-09-01 and 2018-09-07 Shanghai; user_events: pulls all September 2018 events for cohort users with Shanghai timestamps; week_activity: joins events to cohort, assigns weeks_since_signup 1-3; distinct_week_visits: keeps unique user-week rows to prevent double counts; retention_rates: totals cohort and retained users per week, outputs week1-3 percentages","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local074,local015,local194""}",2025-10-31T10:27:01
ga025,"For all users who first opened the app in September 2018 and then uninstalled within seven days, I want to know what percentage of them experienced an app crash (app_exception). The calculation should be done by converting the timestamps to dates first, and then calculating the days to uninstall based on the dates. Only users who uninstalled within 7 days and experienced a crash should be considered in the final percentage.",false,false,false,false,false,azure/o3,"local196,local067,local310,local064","user_events: converts event timestamps to dates and keeps relevant event types; first_open_sept18: earliest app_opened per user limited to September 2018; uninstall_within_7: joins uninstall events to first open, filters days difference ≤7; crashed_users: selects users in uninstall cohort with any app_exception event; percentage_stats: aggregates totals and computes crash percentage among uninstall cohort","user_events: converts event timestamps to dates and keeps relevant event types; first_open_sept18: earliest app_opened per user limited to September 2018; uninstall_within_7: joins uninstall events to first open, filters days difference ≤7; crashed_users: selects users in uninstall cohort with any app_exception event; percentage_stats: aggregates totals and computes crash percentage among uninstall cohort","{""target_db"": ""firebase"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local067,local310,local064""}",2025-10-31T10:27:14
