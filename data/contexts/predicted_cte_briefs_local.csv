instance_id,user_query,used_gold_tables,used_gold_joins,used_predicted_tables_cols,used_predicted_tables_cols_raw,model,examples_used,predicted_cte_briefs,raw_output,example_selection,timestamp
local002,"Can you calculate the 5-day symmetric moving average of predicted toy sales for December 5 to 8, 2018, using daily sales data from January 1, 2017, to August 29, 2018, with a simple linear regression model? Finally provide the sum of those four 5-day moving averages?",false,false,false,true,azure/o3,"local037,local017,local056,local194",toy_sales_source: joins sales tables; filters English category 'toys'; keeps purchase_date and price; daily_sales: aggregates total toy sales per calendar date 2017-01-01 to 2018-08-29; regression_params: calculates least-squares slope and intercept for daily sales trend; prediction_dates: creates date series 2018-12-03 through 2018-12-10 for forecasting; predicted_sales: applies regression formula to prediction_dates to estimate daily toy sales; moving_avg: computes symmetric 5-day moving average for Dec 5-8 predictions; final_total: sums the four moving average values into single figure,toy_sales_source: joins sales tables; filters English category 'toys'; keeps purchase_date and price; daily_sales: aggregates total toy sales per calendar date 2017-01-01 to 2018-08-29; regression_params: calculates least-squares slope and intercept for daily sales trend; prediction_dates: creates date series 2018-12-03 through 2018-12-10 for forecasting; predicted_sales: applies regression formula to prediction_dates to estimate daily toy sales; moving_avg: computes symmetric 5-day moving average for Dec 5-8 predictions; final_total: sums the four moving average values into single figure,"{""target_db"": ""E_commerce"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local037,local017,local056,local194""}",2025-10-17T16:17:21
local003,"According to the RFM definition document, calculate the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. Use the customer unique identifier. Clearly define how to calculate Recency based on the latest purchase timestamp and specify the criteria for classifying RFM segments. The average sales should be computed as the total spend divided by the total number of orders. Please analyze and report the differences in average sales across the RFM segments",false,false,false,true,azure/o3,"local067,local070,local066,local010","delivered_order_totals: filters delivered orders, joins items, sums price per order, retains purchase timestamp and customer_unique_id; customer_rfm_metrics: aggregates per customer to recency_days, order_count, total_spend, avg_sales_per_order; rfm_thresholds: computes quartile boundaries for recency, frequency, monetary across all customers; customer_rfm_scores: assigns 1–4 score to each metric based on thresholds; rfm_segments: maps combined RFM scores into human-readable segment categories; segment_sales_analysis: calculates mean avg_sales_per_order per segment to reveal differences","delivered_order_totals: filters delivered orders, joins items, sums price per order, retains purchase timestamp and customer_unique_id; customer_rfm_metrics: aggregates per customer to recency_days, order_count, total_spend, avg_sales_per_order; rfm_thresholds: computes quartile boundaries for recency, frequency, monetary across all customers; customer_rfm_scores: assigns 1–4 score to each metric based on thresholds; rfm_segments: maps combined RFM scores into human-readable segment categories; segment_sales_analysis: calculates mean avg_sales_per_order per segment to reveal differences","{""target_db"": ""E_commerce"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local067,local070,local066,local010""}",2025-10-17T16:17:41
local004,"Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?",false,false,false,true,azure/o3,"local037,local026,local003,local064","order_pay_totals: sums payment_value per order_id; customer_agg: joins orders to pay totals, returns order_count, total_payment, first_purchase, last_purchase per customer; customer_metrics: computes avg_payment and lifespan_weeks (min 1) from aggregates; top_customers: selects three customers with highest avg_payment including required metrics","order_pay_totals: sums payment_value per order_id; customer_agg: joins orders to pay totals, returns order_count, total_payment, first_purchase, last_purchase per customer; customer_metrics: computes avg_payment and lifespan_weeks (min 1) from aggregates; top_customers: selects three customers with highest avg_payment including required metrics","{""target_db"": ""E_commerce"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local037,local026,local003,local064""}",2025-10-17T16:17:53
local007,"Could you help me calculate the average single career span value in years for all baseball players? Please precise the result as a float number. First, calculate the difference in years, months, and days between the debut and final game dates. For each player, the career span is computed as the sum of the absolute number of years, plus the absolute number of months divided by 12, plus the absolute number of days divided by 365. Round each part to two decimal places before summing. Finally, average the career spans and round the result to a float number.",false,false,false,true,azure/o3,"local329,local253,local075,local229","valid_players: filters players with non-null debut and final_game; career_components: computes absolute year, month, day differences per player; player_spans: rounds components to two decimals, converts months and days to fractions, sums to career_span; avg_career_span: averages career_span across all players as float","valid_players: filters players with non-null debut and final_game; career_components: computes absolute year, month, day differences per player; player_spans: rounds components to two decimals, converts months and days to fractions, sums to career_span; avg_career_span: averages career_span across all players as float","{""target_db"": ""Baseball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local253,local075,local229""}",2025-10-17T16:18:01
local008,"I would like to know the given names of baseball players who have achieved the highest value of games played, runs, hits, and home runs, with their corresponding score values.",false,false,false,true,azure/o3,"local201,local264,local301,local060","career_totals: sums g, r, h, hr per player across all seasons; max_values: finds maximum career total for each stat; stat_leaders: selects player totals matching each stat’s maximum; leader_names: adds name_given to stat_leaders for final output","career_totals: sums g, r, h, hr per player across all seasons; max_values: finds maximum career total for each stat; stat_leaders: selects player totals matching each stat’s maximum; leader_names: adds name_given to stat_leaders for final output","{""target_db"": ""Baseball"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local264,local301,local060""}",2025-10-17T16:18:12
local009,What is the distance of the longest route where Abakan is either the departure or destination city (in kilometers)?,false,false,false,true,azure/o3,"local199,local201,local157,local078",abakan_airports: selects airport_code with parsed latitude and longitude for Abakan; flights_with_coords: adds departure and arrival lat/lon by joining airports_data twice; abakan_routes: keeps flights where either endpoint airport_code matches Abakan; route_distances: computes great-circle distance between endpoints in kilometers; max_distance: returns maximum distance among Abakan routes,abakan_airports: selects airport_code with parsed latitude and longitude for Abakan; flights_with_coords: adds departure and arrival lat/lon by joining airports_data twice; abakan_routes: keeps flights where either endpoint airport_code matches Abakan; route_distances: computes great-circle distance between endpoints in kilometers; max_distance: returns maximum distance among Abakan routes,"{""target_db"": ""Airlines"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local201,local157,local078""}",2025-10-17T16:18:20
local010,"Distribute all the unique city pairs into the distance ranges 0, 1000, 2000, 3000, 4000, 5000, and 6000+, based on their average distance of all routes between them. Then how many pairs are there in the distance range with the fewest unique city paires?",false,false,false,true,azure/o3,"local310,local023,local130,local074","airport_city_map: maps airport codes to city with extracted latitude and longitude; flight_distances: calculates great-circle distance per flight via joined departure and arrival coordinates; city_pair_averages: aggregates average distance for each unordered city pair; distance_buckets: bins city pairs into 0–1000,1000–2000,...,6000+ distance ranges; bucket_counts: counts distinct city pairs within each distance bucket; minimal_bucket_count: isolates minimum pair count across all buckets","airport_city_map: maps airport codes to city with extracted latitude and longitude; flight_distances: calculates great-circle distance per flight via joined departure and arrival coordinates; city_pair_averages: aggregates average distance for each unordered city pair; distance_buckets: bins city pairs into 0–1000,1000–2000,...,6000+ distance ranges; bucket_counts: counts distinct city pairs within each distance bucket; minimal_bucket_count: isolates minimum pair count across all buckets","{""target_db"": ""Airlines"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local023,local130,local074""}",2025-10-17T16:18:36
local015,"Please calculate the fatality rate for motorcycle collisions, separated by helmet usage. Specifically, calculate two percentages: 1) the percentage of motorcyclist fatalities in collisions where parties (drivers or passengers) were wearing helmets, and 2) the percentage of motorcyclist fatalities in collisions where parties were not wearing helmets. For each group, compute this by dividing the total number of motorcyclist fatalities by the total number of collisions involving that group. Use the parties table to determine helmet usage (from party_safety_equipment fields).",false,false,false,true,azure/o3,"local141,local059,local037,local228",motorcycle_collisions: selects case_id and motorcyclist_killed_count where motorcycle_collision is true; rider_helmet_usage: flags case_ids with any motorcycle party whose safety equipment fields include helmet; collision_helmet_status: joins collisions with helmet flags to label each case helmet or no_helmet; fatality_summary: counts collisions and sums motorcyclist fatalities per helmet label for rate calculation,motorcycle_collisions: selects case_id and motorcyclist_killed_count where motorcycle_collision is true; rider_helmet_usage: flags case_ids with any motorcycle party whose safety equipment fields include helmet; collision_helmet_status: joins collisions with helmet flags to label each case helmet or no_helmet; fatality_summary: counts collisions and sums motorcyclist fatalities per helmet label for rate calculation,"{""target_db"": ""California_Traffic_Collision"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local059,local037,local228""}",2025-10-17T16:18:48
local017,In which year were the two most common causes of traffic accidents different from those in other years?,false,false,false,true,azure/o3,"local157,local010,local199,local228",joined_collisions: joins collisions to case_ids to attach db_year with primary_collision_factor cause; yearly_cause_counts: aggregates accident counts per db_year and cause; top2_per_year: ranks causes within each year and keeps top two; overall_top2: derives two most frequent causes across all years; anomalous_years: selects years whose top-two causes differ from the overall top-two set,joined_collisions: joins collisions to case_ids to attach db_year with primary_collision_factor cause; yearly_cause_counts: aggregates accident counts per db_year and cause; top2_per_year: ranks causes within each year and keeps top two; overall_top2: derives two most frequent causes across all years; anomalous_years: selects years whose top-two causes differ from the overall top-two set,"{""target_db"": ""California_Traffic_Collision"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local157,local010,local199,local228""}",2025-10-17T16:18:58
local018,"For the primary collision factor violation category that was the most common cause of traffic accidents in 2021, how many percentage points did its share of annual road incidents in 2021 decrease compared to its share in 2011?",false,false,false,true,azure/o3,"local329,local157,local301,local017",joined_collisions: join collisions with case_ids to attach db_year and category; category_yearly_counts: count collisions per db_year and category; category_yearly_share: compute percentage share per category-year; top_2021_category: select category with highest share in 2021; share_comparison: fetch shares for that category in 2011 and 2021 and difference,joined_collisions: join collisions with case_ids to attach db_year and category; category_yearly_counts: count collisions per db_year and category; category_yearly_share: compute percentage share per category-year; top_2021_category: select category with highest share in 2021; share_comparison: fetch shares for that category in 2011 and 2021 and difference,"{""target_db"": ""California_Traffic_Collision"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local157,local301,local017""}",2025-10-17T16:19:09
local019,"For the NXT title that had the shortest match (excluding titles with ""title change""), what were the names of the two wrestlers involved?",false,false,false,true,azure/o3,"local229,local310,local329,local253",nxt_matches: joins Matches with Belts where belt name contains 'NXT'; non_title_change: filters nxt_matches with title_change = false; min_duration: finds minimum match duration in non_title_change; shortest_match: selects non_title_change rows matching min_duration; wrestler_pairs: joins shortest_match to Wrestlers twice to retrieve winner and loser names,nxt_matches: joins Matches with Belts where belt name contains 'NXT'; non_title_change: filters nxt_matches with title_change = false; min_duration: finds minimum match duration in non_title_change; shortest_match: selects non_title_change rows matching min_duration; wrestler_pairs: joins shortest_match to Wrestlers twice to retrieve winner and loser names,"{""target_db"": ""WWE"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local229,local310,local329,local253""}",2025-10-17T16:19:21
local026,"Please help me identify the top 3 bowlers who, in the overs where the maximum runs were conceded in each match, gave up the highest number of runs in a single over across all matches. For each of these bowlers, provide the match in which they conceded these maximum runs. Only consider overs that had the most runs conceded within their respective matches, and among these, determine which bowlers conceded the most runs in a single over overall.",false,false,false,true,azure/o3,"local229,local228,local023,local024","delivery_runs: merges ball_by_ball, batsman_scored, extra_runs, totals runs per delivery, retains bowler and over identifiers; over_totals: sums delivery_runs to total runs conceded per match, innings, over, and bowler; match_over_max: computes maximum runs conceded in any over for each match; worst_overs: filters over_totals to overs equal to each match’s maximum, keeping bowler and run details; top_bowlers: ranks worst_overs by runs descending and selects top three bowlers with corresponding match identifiers","delivery_runs: merges ball_by_ball, batsman_scored, extra_runs, totals runs per delivery, retains bowler and over identifiers; over_totals: sums delivery_runs to total runs conceded per match, innings, over, and bowler; match_over_max: computes maximum runs conceded in any over for each match; worst_overs: filters over_totals to overs equal to each match’s maximum, keeping bowler and run details; top_bowlers: ranks worst_overs by runs descending and selects top three bowlers with corresponding match identifiers","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local229,local228,local023,local024""}",2025-10-17T16:19:42
local020,Which bowler has the lowest bowling average per wicket taken?,false,false,false,true,azure/o3,"local023,local026,local021,local024","per_ball_runs: joins deliveries with batsman_scored and extra_runs to capture total runs per ball and bowler; bowler_total_runs: sums runs conceded for each bowler; bowler_wickets: counts wickets per bowler from wicket_taken, excluding run-outs and similar; bowler_averages: joins totals and wickets, calculating runs per wicket for bowlers with wickets>0; lowest_avg: retrieves bowler(s) with the smallest bowling average","per_ball_runs: joins deliveries with batsman_scored and extra_runs to capture total runs per ball and bowler; bowler_total_runs: sums runs conceded for each bowler; bowler_wickets: counts wickets per bowler from wicket_taken, excluding run-outs and similar; bowler_averages: joins totals and wickets, calculating runs per wicket for bowlers with wickets>0; lowest_avg: retrieves bowler(s) with the smallest bowling average","{""target_db"": ""IPL"", ""candidates_total"": 42, ""same_db_total"": 6, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local023,local026,local021,local024""}",2025-10-17T16:19:52
local021,Could you calculate the average of the total runs scored by all strikers who have scored more than 50 runs in any single match?,false,false,false,true,azure/o3,"local023,local228,local229,local024","delivery_runs: joins ball and scored tables, returns striker, match id, runs per delivery; striker_match_runs: aggregates total runs per striker per match; qualified_strikers: retains striker ids with match total runs greater than 50; striker_total_runs: sums runs across all matches for each qualified striker; final_average: calculates average of striker total runs for output","delivery_runs: joins ball and scored tables, returns striker, match id, runs per delivery; striker_match_runs: aggregates total runs per striker per match; qualified_strikers: retains striker ids with match total runs greater than 50; striker_total_runs: sums runs across all matches for each qualified striker; final_average: calculates average of striker total runs for output","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local023,local228,local229,local024""}",2025-10-17T16:20:07
local022,Retrieve the names of players who scored no less than 100 runs in a match while playing for the team that lost that match.,false,false,false,true,azure/o3,"local228,local024,local023,local026",player_match_runs: aggregates total runs per player per match from delivery and scoring tables; century_in_match: filters player_match_runs for totals ≥100; losing_side_centuries: joins century_in_match with player_match and match where team_id ≠ match_winner; player_names: selects distinct player names from losing_side_centuries via player table,player_match_runs: aggregates total runs per player per match from delivery and scoring tables; century_in_match: filters player_match_runs for totals ≥100; losing_side_centuries: joins century_in_match with player_match and match where team_id ≠ match_winner; player_names: selects distinct player names from losing_side_centuries via player table,"{""target_db"": ""IPL"", ""candidates_total"": 42, ""same_db_total"": 6, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local228,local024,local023,local026""}",2025-10-17T16:20:19
local023,"Please help me find the names of top 5 players with the highest average runs per match in season 5, along with their batting averages.",false,false,false,true,azure/o3,"local026,local229,local024,local021","season_5_deliveries: joins ball_by_ball, batsman_scored, and match to retain only season 5 deliveries; match_player_runs: aggregates runs per striker per match from season 5 deliveries; player_season_averages: sums season runs and match count per player, computing average runs per match; top_5_averages: joins player names, orders by average desc, limits to five players for output","season_5_deliveries: joins ball_by_ball, batsman_scored, and match to retain only season 5 deliveries; match_player_runs: aggregates runs per striker per match from season 5 deliveries; player_season_averages: sums season runs and match count per player, computing average runs per match; top_5_averages: joins player names, orders by average desc, limits to five players for output","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local026,local229,local024,local021""}",2025-10-17T16:20:34
local024,"Can you help me find the top 5 countries whose players have the highest average of their individual average runs per match across all seasons? Specifically, for each player, calculate their average runs per match over all matches they played, then compute the average of these player averages for each country, and include these country batting averages in the result.",false,false,false,true,azure/o3,"local228,local023,local229,local021","delivery_runs: joins ball_by_ball with batsman_scored to get striker, match_id, and runs per delivery; player_match_totals: aggregates delivery_runs to total runs per player per match; player_avg_runs: calculates each player's average runs per match across all matches; country_avg_runs: joins player_avg_runs with player table, averaging player averages per country; top_countries: selects top five countries by descending country batting average","delivery_runs: joins ball_by_ball with batsman_scored to get striker, match_id, and runs per delivery; player_match_totals: aggregates delivery_runs to total runs per player per match; player_avg_runs: calculates each player's average runs per match across all matches; country_avg_runs: joins player_avg_runs with player table, averaging player averages per country; top_countries: selects top five countries by descending country batting average","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local228,local023,local229,local021""}",2025-10-17T16:20:45
local025,"For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected.",false,false,false,true,azure/o3,"local229,local024,local026,local023","over_runs: aggregates batsman_scored and extra_runs per match, innings, over, adding total runs and bowler; max_over_per_match: selects the single over with highest total runs for each match using ranking; max_over_with_bowler: joins player table to attach bowler name to each match’s max over; avg_max_over_runs: computes average of these highest over totals across all matches","over_runs: aggregates batsman_scored and extra_runs per match, innings, over, adding total runs and bowler; max_over_per_match: selects the single over with highest total runs for each match using ranking; max_over_with_bowler: joins player table to attach bowler name to each match’s max over; avg_max_over_runs: computes average of these highest over totals across all matches","{""target_db"": ""IPL"", ""candidates_total"": 42, ""same_db_total"": 6, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local229,local024,local026,local023""}",2025-10-17T16:21:00
local028,"Could you generate a report that shows the number of delivered orders for each month in the years 2016, 2017, and 2018? Each column represents a year, and each row represents a month",false,false,false,true,azure/o3,"local066,local070,local015,local199","delivered_orders: filters olist_orders for delivered status with delivery date, extracts year and month; month_counts: counts orders per month-year for 2016–2018; calendar_months: generates rows for all twelve months; monthly_pivot: joins calendar to counts and pivots counts into 2016, 2017, 2018 columns","delivered_orders: filters olist_orders for delivered status with delivery date, extracts year and month; month_counts: counts orders per month-year for 2016–2018; calendar_months: generates rows for all twelve months; monthly_pivot: joins calendar to counts and pivots counts into 2016, 2017, 2018 columns","{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local070,local015,local199""}",2025-10-17T16:21:08
local031,"What is the highest monthly delivered orders volume in the year with the lowest annual delivered orders volume among 2016, 2017, and 2018?",false,false,false,true,azure/o3,"local032,local310,local300,local194",delivered_orders: filters delivered orders 2016–2018 and extracts date parts; yearly_volumes: counts delivered orders per year; lowest_volume_year: selects year with minimum yearly count; monthly_volumes: counts delivered orders per month within lowest year; peak_month_volume: retrieves month with highest count in lowest year,delivered_orders: filters delivered orders 2016–2018 and extracts date parts; yearly_volumes: counts delivered orders per year; lowest_volume_year: selects year with minimum yearly count; monthly_volumes: counts delivered orders per month within lowest year; peak_month_volume: retrieves month with highest count in lowest year,"{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local310,local300,local194""}",2025-10-17T16:21:16
local029,"Please identify the top three customers, based on their customer_unique_id, who have the highest number of delivered orders, and provide the average payment value, city, and state for each of these customers.",false,false,false,true,azure/o3,"local059,local024,local003,local075","delivered_orders: filters delivered orders and joins customers and payments to retrieve customer_unique_id and payment_value; customer_stats: aggregates delivered_orders to compute delivered_order_count and avg_payment_value per customer; top3_customers: orders customer_stats by delivered_order_count desc, selects top three, and appends customer city and state","delivered_orders: filters delivered orders and joins customers and payments to retrieve customer_unique_id and payment_value; customer_stats: aggregates delivered_orders to compute delivered_order_count and avg_payment_value per customer; top3_customers: orders customer_stats by delivered_order_count desc, selects top three, and appends customer city and state","{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local024,local003,local075""}",2025-10-17T16:21:30
local030,"Among all cities with delivered orders, find the five cities whose summed payments are the lowest, then calculate the average of their total payments and the average of their total delivered order counts.",false,false,false,true,azure/o3,"local099,local283,local196,local066","delivered_orders: selects orders with non-null delivered date; order_payments_sum: sums payment_value per order; city_totals: joins customers and delivered_orders with order_payments_sum, aggregating total payments and delivered order count per city; lowest_cities: selects five cities with smallest total payments; final_averages: averages total payments and order counts across lowest cities","delivered_orders: selects orders with non-null delivered date; order_payments_sum: sums payment_value per order; city_totals: joins customers and delivered_orders with order_payments_sum, aggregating total payments and delivered order count per city; lowest_cities: selects five cities with smallest total payments; final_averages: averages total payments and order counts across lowest cities","{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local099,local283,local196,local066""}",2025-10-17T16:21:50
local032,"Could you help me find the sellers who excel in the following categories, considering only delivered orders: the seller with the highest number of distinct customer unique IDs, the seller with the highest profit (calculated as price minus freight value), the seller with the highest number of distinct orders, and the seller with the most 5-star ratings? For each category, please provide the seller ID and the corresponding value, labeling each row with a description of the achievement.",false,false,false,true,azure/o3,"local244,local099,local329,local141","delivered_orders: delivered status orders joined to customers for customer_unique_id; delivered_items: delivered_orders joined to order_items yielding seller_id, order_id, price, freight_value, customer_unique_id; seller_core_metrics: per seller compute distinct customer_unique_ids, distinct orders, and total profit; seller_five_stars: join delivered_items to reviews filtered to 5-star then count per seller; category_winners: select seller with highest value for each metric and attach achievement label","delivered_orders: delivered status orders joined to customers for customer_unique_id; delivered_items: delivered_orders joined to order_items yielding seller_id, order_id, price, freight_value, customer_unique_id; seller_core_metrics: per seller compute distinct customer_unique_ids, distinct orders, and total profit; seller_five_stars: join delivered_items to reviews filtered to 5-star then count per seller; category_winners: select seller with highest value for each metric and attach achievement label","{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local099,local329,local141""}",2025-10-17T16:22:04
local034,"Could you help me calculate the average of the total number of payments made using the most preferred payment method for each product category, where the most preferred payment method in a category is the one with the highest number of payments?",false,false,false,true,azure/o3,"local067,local228,local010,local301",order_category_map: maps each order to product categories via items and products; category_payment_detail: joins payments to order_category_map to label payment rows with category; payment_type_totals: counts payments per category and payment_type; preferred_payment_counts: selects top payment_type per category by count; avg_preferred_payment_count: averages these top counts across categories,order_category_map: maps each order to product categories via items and products; category_payment_detail: joins payments to order_category_map to label payment rows with category; payment_type_totals: counts payments per category and payment_type; preferred_payment_counts: selects top payment_type per category by count; avg_preferred_payment_count: averages these top counts across categories,"{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local067,local228,local010,local301""}",2025-10-17T16:22:16
local037,"Identify the top three product categories whose most commonly used payment type has the highest number of payments across all categories, and specify the number of payments made in each category using that payment type.",false,false,false,true,azure/o3,"local010,local070,local300,local099",order_category_items: joins order_items with products and translation to assign English category to each order item; payments_with_category: attaches payment_type to each item via order_payments join; category_payment_counts: counts payments per category and payment_type; category_top_payment: picks most common payment_type and its count per category; top_categories: ranks categories by top payment count and keeps three winners,order_category_items: joins order_items with products and translation to assign English category to each order item; payments_with_category: attaches payment_type to each item via order_payments join; category_payment_counts: counts payments per category and payment_type; category_top_payment: picks most common payment_type and its count per category; top_categories: ranks categories by top payment count and keeps three winners,"{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local070,local300,local099""}",2025-10-17T16:22:33
local035,"In the “olist_geolocation” table, please identify which two consecutive cities, when sorted by geolocation_state, geolocation_city, geolocation_zip_code_prefix, geolocation_lat, and geolocation_lng, have the greatest distance between them based on the difference in distance computed between each city and its immediate predecessor in that ordering.",false,false,false,true,azure/o3,"local066,local141,local017,local056","sorted_locations: deduplicates and orders geolocations by state, city, zip_prefix, lat, lng; consecutive_distances: uses lag to capture predecessor coordinates and compute haversine distance between successive records; max_distance_pair: selects the two consecutive cities with the maximum computed distance","sorted_locations: deduplicates and orders geolocations by state, city, zip_prefix, lat, lng; consecutive_distances: uses lag to capture predecessor coordinates and compute haversine distance between successive records; max_distance_pair: selects the two consecutive cities with the maximum computed distance","{""target_db"": ""Brazilian_E_Commerce"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local141,local017,local056""}",2025-10-17T16:22:42
local038,"Could you help me determine which actor starred most frequently in English-language children's category films that were rated either G or PG, had a running time of 120 minutes or less, and were released between 2000 and 2010? Please provide the actor's full name.",false,false,false,true,azure/o3,"local264,local201,local157,local070","english_films: selects English films released 2000–2010 with rating G/PG and length ≤120; child_films: joins english_films with film_category→category to keep 'Children' films; actor_counts: joins child_films to film_actor and counts films per actor; max_count: gets highest film_count from actor_counts; top_actor: joins actor_counts, max_count, and actor to output actor full name","english_films: selects English films released 2000–2010 with rating G/PG and length ≤120; child_films: joins english_films with film_category→category to keep 'Children' films; actor_counts: joins child_films to film_actor and counts films per actor; max_count: gets highest film_count from actor_counts; top_actor: joins actor_counts, max_count, and actor to output actor full name","{""target_db"": ""Pagila"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local201,local157,local070""}",2025-10-17T16:22:53
local039,"Please help me find the film category with the highest total rental hours in cities where the city's name either starts with ""A"" or contains a hyphen. ",false,false,false,true,azure/o3,"local032,local015,local201,local003",city_scope: selects city_id with names starting 'A' or containing '-'; eligible_customers: finds customer_id whose address city_id is in city_scope; rental_durations: computes hours for each rental by eligible_customers; category_hours: sums rental hours per category via inventory and film_category; top_category: selects category with maximum total_hours,city_scope: selects city_id with names starting 'A' or containing '-'; eligible_customers: finds customer_id whose address city_id is in city_scope; rental_durations: computes hours for each rental by eligible_customers; category_hours: sums rental hours per category via inventory and film_category; top_category: selects category with maximum total_hours,"{""target_db"": ""Pagila"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local015,local201,local003""}",2025-10-17T16:23:08
local040,"In the combined dataset that unifies the trees data with the income data by ZIP code, filling missing ZIP values where necessary, which three boroughs, restricted to records with median and mean income both greater than zero and a valid borough name, contain the highest number of trees, and what is the average mean income for each of these three boroughs?",false,false,false,true,azure/o3,"local099,local070,local264,local023","trees_clean: selects trees with valid boroname, fills missing zipcode when possible; income_filtered: keeps income rows where mean and median income exceed zero; joined_data: joins trees_clean with income_filtered on zipcode; borough_stats: aggregates joined_data for tree_count and average mean income per borough; top_three_boroughs: returns three boroughs with highest tree_count","trees_clean: selects trees with valid boroname, fills missing zipcode when possible; income_filtered: keeps income rows where mean and median income exceed zero; joined_data: joins trees_clean with income_filtered on zipcode; borough_stats: aggregates joined_data for tree_count and average mean income per borough; top_three_boroughs: returns three boroughs with highest tree_count","{""target_db"": ""modern_data"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local099,local070,local264,local023""}",2025-10-17T16:23:17
local041,What percentage of trees in the Bronx have a health status of Good?,false,false,false,true,azure/o3,"local003,local329,local021,local059",bronx_trees: select trees where boroname = 'Bronx'; health_counts: aggregate bronx_trees to total trees and count Good health trees; good_pct: compute percentage of Good trees using health_counts,bronx_trees: select trees where boroname = 'Bronx'; health_counts: aggregate bronx_trees to total trees and count Good health trees; good_pct: compute percentage of Good trees using health_counts,"{""target_db"": ""modern_data"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local329,local021,local059""}",2025-10-17T16:23:23
local049,Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?,false,false,false,true,azure/o3,"local056,local199,local194,local130","unicorns: filters valuation >= 1B, joins dates and industries, extracts join year; yearly_industry_counts: counts unicorns per industry per year 2019-2021; industry_totals: aggregates yearly counts to find highest total industry; top_industry_yearly: retains yearly counts for top industry; avg_new_unicorns: calculates average yearly count for selected industry","unicorns: filters valuation >= 1B, joins dates and industries, extracts join year; yearly_industry_counts: counts unicorns per industry per year 2019-2021; industry_totals: aggregates yearly counts to find highest total industry; top_industry_yearly: retains yearly counts for top industry; avg_new_unicorns: calculates average yearly count for selected industry","{""target_db"": ""modern_data"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local199,local194,local130""}",2025-10-17T16:23:35
local054,"Could you tell me the first names of customers who spent less than $1 on albums by the best-selling artist, along with the amounts they spent?",false,false,false,true,azure/o3,"local199,local253,local329,local078",artist_sales: total revenue per artist via albums-tracks-invoice_items; best_artist: artist_id with highest revenue from artist_sales; customer_spending: sum spend per customer on tracks by best_artist; low_spenders: customers with spend < 1 joined to first names,artist_sales: total revenue per artist via albums-tracks-invoice_items; best_artist: artist_id with highest revenue from artist_sales; customer_spending: sum spend per customer on tracks by best_artist; low_spenders: customers with spend < 1 joined to first names,"{""target_db"": ""chinook"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local253,local329,local078""}",2025-10-17T16:23:42
local055,"Identify the artist with the highest overall sales of albums (tie broken by alphabetical order) and the artist with the lowest overall sales of albums (tie broken by alphabetical order), then calculate the amount each customer spent specifically on those two artists’ albums. Next, compute the average spending for the customers who purchased from the top-selling artist and the average spending for the customers who purchased from the lowest-selling artist, and finally return the absolute difference between these two averages.",false,false,false,true,azure/o3,"local024,local037,local075,local074","line_items_with_artist: joins invoice_items to tracks, albums, artists; computes line_total and artist_id; artist_totals: sums line_total by artist to get total_sales; target_artists: picks highest and lowest total_sales, tie-broken by name; customer_spend: joins line_items_with_artist, invoices, customers, filters target_artists, sums spend per customer and artist_role; avg_spend: averages spend per artist_role for absolute difference","line_items_with_artist: joins invoice_items to tracks, albums, artists; computes line_total and artist_id; artist_totals: sums line_total by artist to get total_sales; target_artists: picks highest and lowest total_sales, tie-broken by name; customer_spend: joins line_items_with_artist, invoices, customers, filters target_artists, sums spend per customer and artist_role; avg_spend: averages spend per artist_role for absolute difference","{""target_db"": ""chinook"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local037,local075,local074""}",2025-10-17T16:23:56
local198,"Using the sales data, what is the median value of total sales made in countries where the number of customers is greater than 4?",false,false,false,true,azure/o3,"local074,local194,local311,local032","customer_counts: counts distinct customers per country; eligible_countries: filters to countries with more than four customers; country_sales: joins invoices to eligible countries, returning invoice totals; median_sales: orders totals from country_sales and derives overall median value","customer_counts: counts distinct customers per country; eligible_countries: filters to countries with more than four customers; country_sales: joins invoices to eligible countries, returning invoice totals; median_sales: orders totals from country_sales and derives overall median value","{""target_db"": ""chinook"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local194,local311,local032""}",2025-10-17T16:24:01
local056,Which customer has the highest average monthly change in payment amounts? Provide the customer's full name.,false,false,false,true,azure/o3,"local201,local301,local059,local130",monthly_totals: sums payment amounts per customer for each year-month; monthly_diff: calculates month-over-month change using lag per customer; avg_monthly_change: averages monthly_diff per customer excluding first month; top_customer: picks customer with highest average change and returns full name,monthly_totals: sums payment amounts per customer for each year-month; monthly_diff: calculates month-over-month change using lag per customer; avg_monthly_change: averages monthly_diff per customer excluding first month; top_customer: picks customer with highest average change and returns full name,"{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 41, ""same_db_total"": 3, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local301,local059,local130""}",2025-10-17T16:24:11
local058,"Can you provide a list of hardware product segments along with their unique product counts for 2020 in the output, ordered by the highest percentage increase in unique fact sales products from 2020 to 2021?",false,false,false,true,azure/o3,"local301,local070,local199,local060","sales_20_21: select distinct product_code and fiscal_year for years 2020-2021; sales_with_segment: join sales_20_21 to dim to append segment; segment_counts: count distinct products by segment and fiscal_year; segment_growth: combine 2020 and 2021 counts per segment, calculate percentage increase","sales_20_21: select distinct product_code and fiscal_year for years 2020-2021; sales_with_segment: join sales_20_21 to dim to append segment; segment_counts: count distinct products by segment and fiscal_year; segment_growth: combine 2020 and 2021 counts per segment, calculate percentage increase","{""target_db"": ""education_business"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local070,local199,local060""}",2025-10-17T16:24:20
local059,"For the calendar year 2021, what is the overall average quantity sold of the top three best-selling hardware products (by total quantity sold) in each division?",false,false,false,true,azure/o3,"local066,local310,local130,local097","filtered_sales_2021: 2021 calendar year sales with product_code and sold_quantity; product_totals: joins sales to product dimension and sums quantity per division, product; ranked_products: assigns rank by total_sold within division, retaining top three; division_top3_avg: computes average total_sold across top three products for each division","filtered_sales_2021: 2021 calendar year sales with product_code and sold_quantity; product_totals: joins sales to product dimension and sums quantity per division, product; ranked_products: assigns rank by total_sold within division, retaining top three; division_top3_avg: computes average total_sold across top three products for each division","{""target_db"": ""education_business"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local310,local130,local097""}",2025-10-17T16:24:27
local060,"In the United States, for Q4 2019 and Q4 2020, first select only those cities where total sales (with no promotions) rose by at least 20% from Q4 2019 to Q4 2020. Among these cities, rank products by their overall sales (still excluding promotions) in those quarters and take the top 20%. Then compute each top product’s share of total sales in Q4 2019 and Q4 2020 and calculate the difference in share from Q4 2019 to Q4 2020, returning the results in descending order of that share change.",false,false,false,true,azure/o3,"local253,local056,local141,local229",q4_us_sales: US sales in Q4 2019 and Q4 2020 excluding promotions; city_year_totals: sums q4_us_sales by city and year; growth_cities: retains cities with 2020 sales at least 120% of 2019; eligible_sales: q4_us_sales filtered to growth_cities; top_products: aggregates eligible_sales by product across both years and selects top 20 percent; product_year_sales: totals eligible_sales for each top product and year; share_deltas: calculates 2019 and 2020 sales shares for each top product and their difference,q4_us_sales: US sales in Q4 2019 and Q4 2020 excluding promotions; city_year_totals: sums q4_us_sales by city and year; growth_cities: retains cities with 2020 sales at least 120% of 2019; eligible_sales: q4_us_sales filtered to growth_cities; top_products: aggregates eligible_sales by product across both years and selects top 20 percent; product_year_sales: totals eligible_sales for each top product and year; share_deltas: calculates 2019 and 2020 sales shares for each top product and their difference,"{""target_db"": ""complex_oracle"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local056,local141,local229""}",2025-10-17T16:24:47
local063,"Among all products sold in the United States with promo_id=999, considering only those cities whose sales increased by at least 20% from Q4 2019 (calendar_quarter_id=1772) to Q4 2020 (calendar_quarter_id=1776), which product that ranks in the top 20% of total sales has the smallest percentage-point change in its share of total sales between these two quarters?",false,false,false,true,azure/o3,"local244,local229,local310,local097","us_promo_sales: USA sales for promo 999 in quarters 1772 and 1776 with city info; city_growth: total sales per city and quarter, flag cities with ≥20% increase 1772→1776; eligible_sales: keeps us_promo_sales rows from growth-qualified cities; quarter_totals: sums eligible_sales amount_sold per quarter; product_quarter_sales: aggregates eligible_sales by product and quarter; top_products: totals product sales across both quarters and selects top 20 percent; product_share_delta: combines product_quarter_sales, quarter_totals, top_products to compute sales share per quarter and change","us_promo_sales: USA sales for promo 999 in quarters 1772 and 1776 with city info; city_growth: total sales per city and quarter, flag cities with ≥20% increase 1772→1776; eligible_sales: keeps us_promo_sales rows from growth-qualified cities; quarter_totals: sums eligible_sales amount_sold per quarter; product_quarter_sales: aggregates eligible_sales by product and quarter; top_products: totals product sales across both quarters and selects top 20 percent; product_share_delta: combines product_quarter_sales, quarter_totals, top_products to compute sales share per quarter and change","{""target_db"": ""complex_oracle"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local229,local310,local097""}",2025-10-17T16:25:09
local061,"What is the average projected monthly sales in USD for France in 2021, considering only product sales with promotions where promo_total_id = 1 and channels where channel_total_id = 1, by taking each product’s monthly sales from 2019 and 2020, calculating the growth rate from 2019 to 2020 for that same product and month, applying this growth rate to project 2021 monthly sales, converting all projected 2021 amounts to USD with the 2021 exchange rates, and finally averaging and listing them by month?",false,false,false,true,azure/o3,"local201,local074,local244,local021","base_sales: filters 2019-2020 France sales with promo_total_id 1 and channel_total_id 1, adds calendar_year and month; monthly_sales: sums amount_sold per prod_id, calendar_year, calendar_month; growth_rates: joins 2019 and 2020 monthly_sales, computing percentage growth per prod_id and month; projections_2021: applies growth to 2020 amounts to estimate 2021 monthly sales per prod_id; usd_rates_2021: selects 2021 monthly exchange rates to USD from currency table; projected_usd: joins projections with usd_rates_2021, converts projected sales to USD; monthly_average: averages projected USD sales across products, outputting calendar_month and avg_projected_sales_usd","base_sales: filters 2019-2020 France sales with promo_total_id 1 and channel_total_id 1, adds calendar_year and month; monthly_sales: sums amount_sold per prod_id, calendar_year, calendar_month; growth_rates: joins 2019 and 2020 monthly_sales, computing percentage growth per prod_id and month; projections_2021: applies growth to 2020 amounts to estimate 2021 monthly sales per prod_id; usd_rates_2021: selects 2021 monthly exchange rates to USD from currency table; projected_usd: joins projections with usd_rates_2021, converts projected sales to USD; monthly_average: averages projected USD sales across products, outputting calendar_month and avg_projected_sales_usd","{""target_db"": ""complex_oracle"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local074,local244,local021""}",2025-10-17T16:25:29
local050,"What is the median of the average monthly projected sales in USD for France in 2021, calculated by using the monthly sales data from 2019 and 2020 (filtered by promo_total_id=1 and channel_total_id=1), applying the growth rate from 2019 to 2020 to project 2021, converting to USD based on the currency table, and then determining the monthly averages before finding their median?",false,false,false,true,azure/o3,"local130,local015,local311,local003","france_sales_19_20: selects sales 2019-2020 for France, promo_total_id=1 and channel_total_id=1 with amount and calendar month/year; monthly_totals: aggregates selected sales to total amount per year and month; monthly_growth: derives per-month growth factor as 2020_total / 2019_total; projected_2021_local: multiplies 2020 monthly totals by growth factor to estimate 2021 sales in local currency; projected_2021_usd: converts projected 2021 figures to USD using currency table exchange rates; monthly_avg_usd: averages projected USD sales per month (handles multiple rows if any duplicates); median_of_avgs: orders monthly averages and selects the median value","france_sales_19_20: selects sales 2019-2020 for France, promo_total_id=1 and channel_total_id=1 with amount and calendar month/year; monthly_totals: aggregates selected sales to total amount per year and month; monthly_growth: derives per-month growth factor as 2020_total / 2019_total; projected_2021_local: multiplies 2020 monthly totals by growth factor to estimate 2021 sales in local currency; projected_2021_usd: converts projected 2021 figures to USD using currency table exchange rates; monthly_avg_usd: averages projected USD sales per month (handles multiple rows if any duplicates); median_of_avgs: orders monthly averages and selects the median value","{""target_db"": ""complex_oracle"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local015,local311,local003""}",2025-10-17T16:25:55
local062,"Please group all Italian customers into ten buckets for December 2021 by summing their profits from all products purchased (where profit is calculated as quantity_sold multiplied by the difference between unit_price and unit_cost), then divide the overall range of total monthly profits into ten equal intervals. For each bucket, provide the number of customers, and identify the minimum and maximum total profits within that bucket.",false,false,false,true,azure/o3,"local074,local228,local015,local003","italian_customers: selects IDs of customers linked to country 'Italy'; dec_2021_sales: filters sales rows to December 2021 using time dimension; sales_profit: joins dec_2021_sales to costs, computes row-level profit; customer_month_profit: aggregates total profit per Italian customer for December; profit_range: calculates minimum, maximum profit and interval_width for deciles; bucketed_customers: assigns each customer to 1–10 bucket using profit_range; bucket_summary: counts customers and finds min/max profit per bucket","italian_customers: selects IDs of customers linked to country 'Italy'; dec_2021_sales: filters sales rows to December 2021 using time dimension; sales_profit: joins dec_2021_sales to costs, computes row-level profit; customer_month_profit: aggregates total profit per Italian customer for December; profit_range: calculates minimum, maximum profit and interval_width for deciles; bucketed_customers: assigns each customer to 1–10 bucket using profit_range; bucket_summary: counts customers and finds min/max profit per bucket","{""target_db"": ""complex_oracle"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local228,local015,local003""}",2025-10-17T16:26:07
local067,Can you provide the highest and lowest profits for Italian customers segmented into ten evenly divided tiers based on their December 2021 sales profits?,false,false,false,true,azure/o3,"local017,local026,local283,local199",dec_sales: selects Italy customer sales for December 2021; profit_rows: joins costs to compute profit per sale row; customer_profit: aggregates total December profit per Italian customer; tier_assign: applies NTILE(10) over profits to label tiers; tier_bounds: calculates min and max profit within each tier,dec_sales: selects Italy customer sales for December 2021; profit_rows: joins costs to compute profit per sale row; customer_profit: aggregates total December profit per Italian customer; tier_assign: applies NTILE(10) over profits to label tiers; tier_bounds: calculates min and max profit within each tier,"{""target_db"": ""complex_oracle"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local026,local283,local199""}",2025-10-17T16:26:25
local070,"Please examine our database records for Chinese cities (country_code_2 = 'cn') during July 2021 and identify both the shortest and longest streaks of consecutive date entries. For each date in these streaks, return exactly one record per date along with the corresponding city name. In your output, please ensure the first letter of each city name is capitalized and the rest are lowercase. Display the dates and city names for both the shortest and longest consecutive date streaks, ordered by date.",false,false,false,true,azure/o3,"local059,local311,local157,local078",july_cn: filters Chinese records for July 2021 and title-cases city names; dated_seq: assigns row_number per city and computes streak_key for consecutive dates; streaks: groups by city and streak_key to derive streak length and boundaries; extremal_streaks: picks streaks with global shortest and longest length; streak_dates: selects one record per date from july_cn belonging to extremal streaks,july_cn: filters Chinese records for July 2021 and title-cases city names; dated_seq: assigns row_number per city and computes streak_key for consecutive dates; streaks: groups by city and streak_key to derive streak length and boundaries; extremal_streaks: picks streaks with global shortest and longest length; streak_dates: selects one record per date from july_cn belonging to extremal streaks,"{""target_db"": ""city_legislation"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local311,local157,local078""}",2025-10-17T16:26:43
local071,Could you review our records in June 2022 and identify which countries have the longest streak of consecutive inserted city dates? Please list the 2-letter length country codes of these countries.,false,false,false,true,azure/o3,"local032,local070,local311,local067",june_dates: distinct June-2022 insert_date per country; dated_rows: adds row_number and day_offset to detect consecutive sequences per country; streak_lengths: groups dated_rows into streaks and counts length per country; max_streak_per_country: selects longest streak length for each country; top_countries: filters countries whose longest streak equals overall maximum,june_dates: distinct June-2022 insert_date per country; dated_rows: adds row_number and day_offset to detect consecutive sequences per country; streak_lengths: groups dated_rows into streaks and counts length per country; max_streak_per_country: selects longest streak length for each country; top_countries: filters countries whose longest streak equals overall maximum,"{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local032,local070,local311,local067""}",2025-10-17T16:26:50
local072,"Identify the country with data inserted on nine different days in January 2022. Then, find the longest consecutive period with data insertions for this country during January 2022, and calculate the proportion of entries that are from its capital city within this longest consecutive insertion period.",false,false,false,true,azure/o3,"local074,local003,local099,local010","jan_inserts: filters cities to January 2022 rows and attaches country name; daily_counts: counts distinct insert dates per country within January dataset; target_country: selects country having exactly nine distinct insert days; country_daily_dates: lists target country's distinct January dates and assigns row_number for each; longest_streak: groups dates by date-row_number gap to find longest consecutive run, returns start and end dates; streak_entries: fetches all jan_inserts rows for target country between longest streak start and end; capital_ratio: aggregates streak_entries to compute capital row count, total rows, and capital proportion","jan_inserts: filters cities to January 2022 rows and attaches country name; daily_counts: counts distinct insert dates per country within January dataset; target_country: selects country having exactly nine distinct insert days; country_daily_dates: lists target country's distinct January dates and assigns row_number for each; longest_streak: groups dates by date-row_number gap to find longest consecutive run, returns start and end dates; streak_entries: fetches all jan_inserts rows for target country between longest streak start and end; capital_ratio: aggregates streak_entries to compute capital row count, total rows, and capital proportion","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local003,local099,local010""}",2025-10-17T16:27:20
local068,"Calculate the number of new cities inserted in April, May, and June for each year from 2021 to 2023. For each month, compute the cumulative running total of cities added for that specific month across the years up to and including the given year (i.e., sum the counts of that month over the years). Additionally, calculate the year-over-year growth percentages for both the monthly total and the running total for each month, comparing each year to the previous year. Present the results only for 2022 and 2023, listing the year, the month, the total number of cities added in that month, the cumulative running total for that month, and the year-over-year growth percentages for both the monthly total and the running total. Use the data from 2021 solely as a baseline for calculating growth rates, and exclude it from the final output.",false,false,false,true,azure/o3,"local130,local244,local064,local032","april_may_june_inserts: selects insert_date, derives year and month for city adds in Apr-Jun 2021-2023; monthly_counts: counts cities per year and month from filtered inserts; running_totals: computes cumulative sum of monthly counts across years per month; growth_metrics: calculates YoY percentage change for monthly count and cumulative total versus prior year; final_output: filters to 2022-2023 and selects year, month, counts, running totals, growth metrics","april_may_june_inserts: selects insert_date, derives year and month for city adds in Apr-Jun 2021-2023; monthly_counts: counts cities per year and month from filtered inserts; running_totals: computes cumulative sum of monthly counts across years per month; growth_metrics: calculates YoY percentage change for monthly count and cumulative total versus prior year; final_output: filters to 2022-2023 and selects year, month, counts, running totals, growth metrics","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local130,local244,local064,local032""}",2025-10-17T16:27:31
local073,"For each pizza order, please list a single result row containing the row ID, order ID, customer ID, pizza name, and the final set of ingredients. The final set of ingredients should be determined by taking the standard toppings from the pizza’s recipe, removing any toppings specified as exclusions, then adding any toppings specified as extras. The resulting ingredients must be presented in alphabetical order, prefixed by ‘2x’ if the same ingredient appears multiple times (for example, if both standard and extra or added multiple times), and concatenated into a string that begins with the pizza name followed by ‘: ’. Group by row ID, order ID, pizza name, and order time so that each order appears once, and return the listing of toppings in ascending order by row ID, ensuring that ‘Meatlovers’ pizzas receive a pizza_id of 1 while all others receive a pizza_id of 2.",false,false,false,true,azure/o3,"local003,local070,local024,local301","orders_with_names: select orders joined to pizza_names, set pizza_id=1 for Meatlovers else 2; standard_toppings: expand each order's recipe toppings into one row per topping; customer_exclusions: expand order exclusions into one row per topping; customer_extras: expand order extras into one row per topping; resolved_toppings: apply exclusions, add extras, count occurrences, sort alphabetically per order; ingredients_string: concatenate resolved_toppings with 2x prefixes into 'pizza_name: ingredients' string per order","orders_with_names: select orders joined to pizza_names, set pizza_id=1 for Meatlovers else 2; standard_toppings: expand each order's recipe toppings into one row per topping; customer_exclusions: expand order exclusions into one row per topping; customer_extras: expand order extras into one row per topping; resolved_toppings: apply exclusions, add extras, count occurrences, sort alphabetically per order; ingredients_string: concatenate resolved_toppings with 2x prefixes into 'pizza_name: ingredients' string per order","{""target_db"": ""modern_data"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local070,local024,local301""}",2025-10-17T16:27:42
local066,"Based on our customer pizza order information, summarize the total quantity of each ingredient used in the pizzas we delivered. Output the name and quantity for each ingredient.",false,false,false,true,azure/o3,"local141,local097,local228,local264","delivered_orders: filters customer and runner orders to delivered rows, retaining order_id, pizza_id, exclusions, extras; recipe_toppings: splits pizza_recipes.toppings string into pizza_id and topping_id rows; base_toppings: joins delivered_orders to recipe_toppings listing default toppings per delivered order; excluded_toppings: parses exclusions into order-topping rows to remove; extra_toppings: parses extras into order-topping rows to add; final_usage: combines base_toppings and extra_toppings minus excluded, counts topping_id, joins topping_name for output","delivered_orders: filters customer and runner orders to delivered rows, retaining order_id, pizza_id, exclusions, extras; recipe_toppings: splits pizza_recipes.toppings string into pizza_id and topping_id rows; base_toppings: joins delivered_orders to recipe_toppings listing default toppings per delivered order; excluded_toppings: parses exclusions into order-topping rows to remove; extra_toppings: parses extras into order-topping rows to add; final_usage: combines base_toppings and extra_toppings minus excluded, counts topping_id, joins topping_name for output","{""target_db"": ""modern_data"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local141,local097,local228,local264""}",2025-10-17T16:27:56
local065,Calculate the total income from Meat Lovers pizzas priced at $12 and Vegetarian pizzas at $10. Include any extra toppings charged at $1 each. Ensure that canceled orders are filtered out. How much money has Pizza Runner earned in total?,false,false,false,true,azure/o3,"local010,local099,local023,local032","valid_orders: filters pizza_runner_orders to delivered order_ids; priced_pizzas: joins valid_orders with customer_orders and names, keeps Meat Lovers and Vegetarian, assigns $12/$10 base_price; extras_fee: aggregates pizza_get_extras per order, charges $1 per extra; total_income: sums base_price plus extras_fee across all qualified orders","valid_orders: filters pizza_runner_orders to delivered order_ids; priced_pizzas: joins valid_orders with customer_orders and names, keeps Meat Lovers and Vegetarian, assigns $12/$10 base_price; extras_fee: aggregates pizza_get_extras per order, charges $1 per extra; total_income: sums base_price plus extras_fee across all qualified orders","{""target_db"": ""modern_data"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local099,local023,local032""}",2025-10-17T16:28:03
local074,"Please generate a summary of the closing balances at the end of each month for each customer transactions, show the monthly changes and monthly cumulative bank account balances. Ensure that even if a customer has no account activity in a given month, the balance for that month is still included in the output.",false,false,false,true,azure/o3,"local078,local300,local157,local301","signed_txns: converts txn_type to signed amounts and extracts year_month; monthly_net: aggregates signed_txns into monthly_change per customer-year_month; customer_months: constructs complete month sequence for each customer span; monthly_balances: joins sequence with monthly_net, fills nulls, computes cumulative closing_balance","signed_txns: converts txn_type to signed amounts and extracts year_month; monthly_net: aggregates signed_txns into monthly_change per customer-year_month; customer_months: constructs complete month sequence for each customer span; monthly_balances: joins sequence with monthly_net, fills nulls, computes cumulative closing_balance","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local078,local300,local157,local301""}",2025-10-17T16:28:11
local064,"For each customer and each month of 2020, first calculate the month-end balance by adding all deposit amounts and subtracting all withdrawal amounts that occurred during that specific month. Then determine which month in 2020 has the highest count of customers with a positive month-end balance and which month has the lowest count. For each of these two months, compute the average month-end balance across all customers and provide the difference between these two averages",false,false,false,true,azure/o3,"local157,local077,local300,local075","filtered_txns: filters 2020 transactions, assigns year_month and signed amount; monthly_balances: aggregates signed amounts per customer per month as month_end_balance; positive_counts: counts customers with positive month_end_balance per month; extreme_months: finds months with max and min positive customer counts; extreme_avgs: averages month_end_balance across all customers for those months; avg_diff: computes difference between highest and lowest average balances","filtered_txns: filters 2020 transactions, assigns year_month and signed amount; monthly_balances: aggregates signed amounts per customer per month as month_end_balance; positive_counts: counts customers with positive month_end_balance per month; extreme_months: finds months with max and min positive customer counts; extreme_avgs: averages month_end_balance across all customers for those months; avg_diff: computes difference between highest and lowest average balances","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local157,local077,local300,local075""}",2025-10-17T16:28:19
local297,"For each customer, group all deposits and withdrawals by the first day of each month to obtain a monthly net amount, then calculate each month’s closing balance by cumulatively summing these monthly nets. Next, determine the most recent month’s growth rate by comparing its closing balance to the prior month’s balance, treating deposits as positive and withdrawals as negative, and if the previous month’s balance is zero, the growth rate should be the current month’s balance multiplied by 100. Finally, compute the percentage of customers whose most recent month shows a growth rate of more than 5%.",false,false,false,true,azure/o3,"local078,local074,local157,local075",txn_signed: converts withdrawals to negative and floors txn_date to first-of-month; monthly_net: sums signed amounts per customer and month to net; monthly_balance: computes cumulative net per customer to derive closing balance; latest_two_months: selects each customer's latest and prior closing balances; growth_rate: calculates latest month growth with zero-previous adjustment; high_growth_pct: returns percentage of customers with growth_rate above 5,txn_signed: converts withdrawals to negative and floors txn_date to first-of-month; monthly_net: sums signed amounts per customer and month to net; monthly_balance: computes cumulative net per customer to derive closing balance; latest_two_months: selects each customer's latest and prior closing balances; growth_rate: calculates latest month growth with zero-previous adjustment; high_growth_pct: returns percentage of customers with growth_rate above 5,"{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local078,local074,local157,local075""}",2025-10-17T16:28:33
local298,"For each month, calculate the total balance from all users for the previous month (measured as of the 1st of each month), replacing any negative balances with zero. Ensure that data from the first month is used only as a baseline for calculating previous total balance, and exclude it from the final output. Sort the results in ascending order by month. ",false,false,false,true,azure/o3,"local077,local157,local078,local300","txn_monthly: sums signed transaction amounts per customer per month, adding first_of_month stamp; cust_prev_bal: computes cumulative balance before each month per customer and caps negatives at zero; month_totals: aggregates capped balances across customers for each month; ordered_output: discards earliest month and sorts results ascending","txn_monthly: sums signed transaction amounts per customer per month, adding first_of_month stamp; cust_prev_bal: computes cumulative balance before each month per customer and caps negatives at zero; month_totals: aggregates capped balances across customers for each month; ordered_output: discards earliest month and sorts results ascending","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local077,local157,local078,local300""}",2025-10-17T16:29:02
local299,"For a bank database with customer transactions, calculate each customer's daily running balance (where deposits add to the balance and other transaction types subtract). For each customer and each day, compute the 30-day rolling average balance (only after having 30 days of data, and treating negative averages as zero). Then group these daily averages by month and find each customer's maximum 30-day average balance within each month. Sum these maximum values across all customers for each month. Consider the first month of each customer's transaction history as the baseline period and exclude it from the final results, presenting monthly totals of these summed maximum 30-day average balances.",false,false,false,true,azure/o3,"local300,local157,local078,local077","signed_txns: converts txn_type into signed_amount (+ deposits, − others), retains customer_id and txn_date for aggregation; daily_net: aggregates signed_amount to net daily total per customer, one row per date; date_span: builds complete daily date series between each customer's first and last txn_date; daily_balances: joins date_span with daily_net, substitutes zero when null, computes cumulative balance per customer by date; rolling_30avg: derives 30-day rolling average balance per customer, outputs zero when average is negative; monthly_max: finds maximum 30-day average per customer within each year-month; baseline_excluded: filters out rows where year-month equals customer's first transaction month; monthly_totals: sums customer monthly maxima across all customers per month, ordered chronologically","signed_txns: converts txn_type into signed_amount (+ deposits, − others), retains customer_id and txn_date for aggregation; daily_net: aggregates signed_amount to net daily total per customer, one row per date; date_span: builds complete daily date series between each customer's first and last txn_date; daily_balances: joins date_span with daily_net, substitutes zero when null, computes cumulative balance per customer by date; rolling_30avg: derives 30-day rolling average balance per customer, outputs zero when average is negative; monthly_max: finds maximum 30-day average per customer within each year-month; baseline_excluded: filters out rows where year-month equals customer's first transaction month; monthly_totals: sums customer monthly maxima across all customers per month, ordered chronologically","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local300,local157,local078,local077""}",2025-10-17T16:29:29
local300,"For each customer, calculate their daily balances for every day between their earliest and latest transaction dates, including days without transactions by carrying forward the previous day's balance. Treat any negative daily balances as zero. Then, for each month, determine the highest daily balance each customer had during that month. Finally, for each month, sum these maximum daily balances across all customers to obtain a monthly total.",false,false,false,true,azure/o3,"local074,local064,local075,local078","transactions_daily: aggregates net amount per customer and date; date_bounds: earliest and latest txn_date per customer; customer_dates: builds continuous daily calendar per customer using date_bounds; daily_balances: cumulative sum of transactions across customer_dates, negative values set to zero; monthly_customer_peaks: computes max daily balance per customer per month; monthly_total: sums monthly peak balances across all customers per month","transactions_daily: aggregates net amount per customer and date; date_bounds: earliest and latest txn_date per customer; customer_dates: builds continuous daily calendar per customer using date_bounds; daily_balances: cumulative sum of transactions across customer_dates, negative values set to zero; monthly_customer_peaks: computes max daily balance per customer per month; monthly_total: sums monthly peak balances across all customers per month","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local074,local064,local075,local078""}",2025-10-17T16:29:40
local075,"Can you provide a breakdown of how many times each product was viewed, how many times they were added to the shopping cart, and how many times they were left in the cart without being purchased? Also, give me the count of actual purchases for each product. Ensure that products with a page id in (1, 2, 12, 13) are filtered out.",false,false,false,true,azure/o3,"local157,local078,local300,local074","event_lookup: maps raw event names to standardized view, add_to_cart, purchase labels; filtered_events: joins events to page hierarchy, applies lookup, excludes page_ids 1 2 12 13; product_event_counts: tallies views, adds, purchases per product; session_flags: derives add and purchase flags per product visit; left_in_cart_counts: counts visits where added but not purchased for each product; combined_counts: merges event counts with abandoned cart counts per product","event_lookup: maps raw event names to standardized view, add_to_cart, purchase labels; filtered_events: joins events to page hierarchy, applies lookup, excludes page_ids 1 2 12 13; product_event_counts: tallies views, adds, purchases per product; session_flags: derives add and purchase flags per product visit; left_in_cart_counts: counts visits where added but not purchased for each product; combined_counts: merges event counts with abandoned cart counts per product","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local157,local078,local300,local074""}",2025-10-17T16:29:57
local077,"Please analyze our interest data from September 2018 to August 2019. For each month, calculate the average composition for each interest by dividing the composition by the index value. Identify the interest with the highest average composition value each month and report its average composition as the max index composition for that month. Compute the three-month rolling average of these monthly max index compositions. Ensure the output includes the date, the interest name, the max index composition for that month, the rolling average, and the names and max index compositions of the top interests from one month ago and two months ago.",false,false,false,true,azure/o3,"local157,local078,local301,local300",period_metrics: filters interest_metrics to 2018-09–2019-08 and derives month_date; interest_month_avg: computes avg(composition/index_value) per interest and month; monthly_top_interest: retains month’s highest avg value with interest name as max_comp; rolling_enriched: adds 3-month rolling average of max_comp and lag-1 and lag-2 top interest names and values,period_metrics: filters interest_metrics to 2018-09–2019-08 and derives month_date; interest_month_avg: computes avg(composition/index_value) per interest and month; monthly_top_interest: retains month’s highest avg value with interest name as max_comp; rolling_enriched: adds 3-month rolling average of max_comp and lag-1 and lag-2 top interest names and values,"{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local157,local078,local301,local300""}",2025-10-17T16:30:11
local078,"Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value",false,false,false,true,azure/o3,"local301,local075,local064,local300","max_comp_per_category: calculates maximum composition for each interest_id from interest_metrics; peak_event: joins metrics to maxima, keeps earliest month_year observing peak; labeled_peaks: adds interest_name from interest_map to peak_event; extremes: selects top 10 and bottom 10 categories by peak composition","max_comp_per_category: calculates maximum composition for each interest_id from interest_metrics; peak_event: joins metrics to maxima, keeps earliest month_year observing peak; labeled_peaks: adds interest_name from interest_map to peak_event; extremes: selects top 10 and bottom 10 categories by peak composition","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local301,local075,local064,local300""}",2025-10-17T16:30:25
local081,"Considering only the customers who placed orders in 1998, calculate the total amount each customer spent by summing the unit price multiplied by the quantity of all products in their orders, excluding any discounts. Assign each customer to a spending group based on the customer group thresholds, and determine how many customers are in each spending group and what percentage of the total number of customers who placed orders in 1998 each group represents.",false,false,false,true,azure/o3,"local060,local017,local311,local310","orders_1998: selects orderid and customerid for orders dated in 1998; order_detail_values: computes line totals (unitprice*quantity) for 1998 orders; customer_totals: sums line totals per customer to get 1998 spending; customer_grouping: joins customer_totals to threshold table to assign spending group; group_overview: counts customers per group, calculates percent of total 1998 customers","orders_1998: selects orderid and customerid for orders dated in 1998; order_detail_values: computes line totals (unitprice*quantity) for 1998 orders; customer_totals: sums line totals per customer to get 1998 spending; customer_grouping: joins customer_totals to threshold table to assign spending group; group_overview: counts customers per group, calculates percent of total 1998 customers","{""target_db"": ""northwind"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local017,local311,local310""}",2025-10-17T16:30:38
local085,"Among employees who have more than 50 total orders, which three have the highest percentage of late orders, where an order is considered late if the shipped date is on or after its required date? Please list each employee's ID, the number of late orders, and the corresponding late-order percentage.",false,false,false,true,azure/o3,"local017,local199,local228,local141","order_counts: counts total orders per employee; late_counts: counts late orders per employee shipped on/after required date; late_stats: joins counts, computes late percentage, keeps employees with total_orders>50; top_employees: ranks employees by late percentage descending and selects top three","order_counts: counts total orders per employee; late_counts: counts late orders per employee shipped on/after required date; late_stats: joins counts, computes late percentage, keeps employees with total_orders>50; top_employees: ranks employees by late percentage descending and selects top three","{""target_db"": ""northwind"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local199,local228,local141""}",2025-10-17T16:30:44
local096,"For each year, calculate the percentage of films that had exclusively female actors (meaning no male actors and no actors with unknown/unspecified gender). Consider actors with gender marked as 'Male' or 'None' as non-female. For the results, display the year, the total number of movies in that year, and the percentage of movies with exclusively female actors. Extract the year from the Movie.year field by taking the last 4 characters and converting to a number.",false,false,false,true,azure/o3,"local194,local003,local244,local229","movie_years: extract numeric year from Movie.year, one row per movie; movie_cast_genders: join M_Cast to Person to list genders per movie actor; female_only_films: identify movies where every listed gender equals 'Female'; yearly_percentages: aggregate total and female-only movie counts per year, compute percentage","movie_years: extract numeric year from Movie.year, one row per movie; movie_cast_genders: join M_Cast to Person to list genders per movie actor; female_only_films: identify movies where every listed gender equals 'Female'; yearly_percentages: aggregate total and female-only movie counts per year, compute percentage","{""target_db"": ""DB_IMDB"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local003,local244,local229""}",2025-10-17T16:30:54
local097,"Could you analyze our data and identify which ten-year period starting from any movie release year present in the data had the largest number of films, considering consecutive ten-year periods beginning at each unique year? Only output the start year and the total count for that specific period.",false,false,false,true,azure/o3,"local024,local067,local219,local037",movies_per_year: aggregates film counts by release year; decade_totals: computes ten-year rolling sum of films for each start year; max_decade: selects start year with highest film count across decades,movies_per_year: aggregates film counts by release year; decade_totals: computes ten-year rolling sum of films for each start year; max_decade: selects start year with highest film count across decades,"{""target_db"": ""DB_IMDB"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local067,local219,local037""}",2025-10-17T16:31:02
local098,"From the first year each actor appeared in a film to the last, how many actors in the database never had a gap longer than three consecutive years without at least one new movie appearance, meaning there is no four-year span anywhere in their active career without at least a single film credit?",false,false,false,true,azure/o3,"local310,local196,local283,local157",actor_years: distinct appearance years per actor via cast join; actor_gap_stats: calculates max gap between consecutive years for each actor; qualifying_actors: filters actors with max gap <= 3; final_count: counts total qualifying actors,actor_years: distinct appearance years per actor via cast join; actor_gap_stats: calculates max gap between consecutive years for each actor; qualifying_actors: filters actors with max gap <= 3; final_count: counts total qualifying actors,"{""target_db"": ""DB_IMDB"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local196,local283,local157""}",2025-10-17T16:31:11
local099,I need you to look into the actor collaborations and tell me how many actors have made more films with Yash Chopra than with any other director. This will help us understand his influence on the industry better.,false,false,false,true,azure/o3,"local010,local024,local026,local253","yash_chopra_id: isolates PID for Yash Chopra from Person table; actor_director_counts: joins casts and directors on movie, counting films for every actor-director pair; actor_counts_split: calculates each actor's Yash film count and greatest film count with any other director; preferred_yash_actors: filters actors whose Yash count surpasses their max other director count and counts them","yash_chopra_id: isolates PID for Yash Chopra from Person table; actor_director_counts: joins casts and directors on movie, counting films for every actor-director pair; actor_counts_split: calculates each actor's Yash film count and greatest film count with any other director; preferred_yash_actors: filters actors whose Yash count surpasses their max other director count and counts them","{""target_db"": ""DB_IMDB"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local024,local026,local253""}",2025-10-17T16:31:25
local100,"Find out how many actors have a 'Shahrukh number' of 2? This means they acted in a film with someone who acted with Shahrukh Khan, but not directly with him.",false,false,false,true,azure/o3,"local097,local283,local067,local300","shahrukh_pid: fetches Shahrukh Khan’s person identifier; shahrukh_movies: lists movie IDs featuring Shahrukh Khan; first_degree_actors: finds actors who co-starred with Shahrukh, excluding him; movies_of_first_degree: gathers movies containing any first-degree actor; second_degree_actors: identifies actors from those movies not in first-degree nor Shahrukh; final_count: counts distinct second-degree actor IDs","shahrukh_pid: fetches Shahrukh Khan’s person identifier; shahrukh_movies: lists movie IDs featuring Shahrukh Khan; first_degree_actors: finds actors who co-starred with Shahrukh, excluding him; movies_of_first_degree: gathers movies containing any first-degree actor; second_degree_actors: identifies actors from those movies not in first-degree nor Shahrukh; final_count: counts distinct second-degree actor IDs","{""target_db"": ""DB_IMDB"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local097,local283,local067,local300""}",2025-10-17T16:31:44
local114,"Provide a detailed web sales report for each region, including the number of orders, total sales amount, and the name and sales amount of all sales representatives who achieved the highest total sales amount in that region (include all representatives in case of a tie).",false,false,false,true,azure/o3,"local228,local074,local097,local032","orders_with_region: joins web_orders, web_accounts, web_sales_reps to attach region_id and sales_rep_id to each order; region_summary: aggregates orders_with_region to count orders and sum total_amt_usd per region; rep_sales: aggregates orders_with_region by region and sales_rep to compute each rep's total sales; top_reps: selects reps whose regional sales equal the maximum, returning region_id, rep name, and sales","orders_with_region: joins web_orders, web_accounts, web_sales_reps to attach region_id and sales_rep_id to each order; region_summary: aggregates orders_with_region to count orders and sum total_amt_usd per region; rep_sales: aggregates orders_with_region by region and sales_rep to compute each rep's total sales; top_reps: selects reps whose regional sales equal the maximum, returning region_id, rep name, and sales","{""target_db"": ""education_business"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local228,local074,local097,local032""}",2025-10-17T16:31:56
local128,"List the bowlers (including their ID, first name, and last name), match number, game number, handicap score, tournament date, and location for only those bowlers who have won games with a handicap score of 190 or less at all three venues: Thunderbird Lanes, Totem Lanes, and Bolero Lanes. Only include the specific game records where they won with a handicap score of 190 or less at these three locations.",false,false,false,true,azure/o3,"local023,local194,local130,local074","scores_union: unions active and archive bowler scores into single set; tournaments_union: unions tournaments current and archive, keeping tourney id, date, location; match_info: joins tourney matches (current and archive) to tournaments_union, mapping match to date and location; wins_190: filters scores_union joined to match_info for wins with handicap ≤190 at Thunderbird, Totem, or Bolero; qualifying_bowlers: selects bowler IDs winning at all three venues via distinct location count; output_rows: joins wins_190, qualifying_bowlers, and bowlers to return requested bowler and game details","scores_union: unions active and archive bowler scores into single set; tournaments_union: unions tournaments current and archive, keeping tourney id, date, location; match_info: joins tourney matches (current and archive) to tournaments_union, mapping match to date and location; wins_190: filters scores_union joined to match_info for wins with handicap ≤190 at Thunderbird, Totem, or Bolero; qualifying_bowlers: selects bowler IDs winning at all three venues via distinct location count; output_rows: joins wins_190, qualifying_bowlers, and bowlers to return requested bowler and game details","{""target_db"": ""BowlingLeague"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local194,local130,local074""}",2025-10-17T16:32:14
local130,"Could you provide a list of last names for all students who have completed English courses (where completion is defined as having a ClassStatus of 2), along with their quintile ranks based on their individual grades in those courses? The quintile should be determined by calculating how many students have grades greater than or equal to each student's grade, then dividing this ranking by the total number of students who completed English courses. The quintiles should be labeled as ""First"" (top 20%), ""Second"" (top 21-40%), ""Third"" (top 41-60%), ""Fourth"" (top 61-80%), and ""Fifth"" (bottom 20%). Please sort the results from highest performing quintile to lowest (First to Fifth).",false,false,false,true,azure/o3,"local023,local201,local078,local064","english_completions: filters ClassStatus=2 English classes, returning StudentID and grade; student_best_grade: keeps highest English grade per student; total_students: counts students in student_best_grade for percentile math; ranked_students: assigns descending rank and rank_ratio based on grade and total_students; quintile_labels: labels each student First–Fifth by rank_ratio and attaches last name, sorted by quintile order","english_completions: filters ClassStatus=2 English classes, returning StudentID and grade; student_best_grade: keeps highest English grade per student; total_students: counts students in student_best_grade for percentile math; ranked_students: assigns descending rank and rank_ratio based on grade and total_students; quintile_labels: labels each student First–Fifth by rank_ratio and attaches last name, sorted by quintile order","{""target_db"": ""school_scheduling"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local201,local078,local064""}",2025-10-17T16:32:28
local131,"Could you list each musical style with the number of times it appears as a 1st, 2nd, or 3rd preference in a single row per style?",false,false,false,true,azure/o3,"local024,local015,local070,local066","style_seq_counts: tally rows per style and preference sequence; pivot_counts: convert sequence tallies into separate first_pref, second_pref, third_pref columns per style; style_summary: attach style names to pivoted counts for final output","style_seq_counts: tally rows per style and preference sequence; pivot_counts: convert sequence tallies into separate first_pref, second_pref, third_pref columns per style; style_summary: attach style names to pivoted counts for final output","{""target_db"": ""EntertainmentAgency"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local015,local070,local066""}",2025-10-17T16:32:35
local133,"Given a database of musical styles and user preferences, where Musical_Preferences contains user rankings of musical styles (PreferenceSeq=1 for first choice, PreferenceSeq=2 for second choice, PreferenceSeq=3 for third choice): Calculate a weighted score for each musical style by assigning 3 points for each time it was ranked as first choice, 2 points for each second choice, and 1 point for each third choice ranking. Calculate the total weighted score for each musical style that has been ranked by at least one user. Then, compute the absolute difference between each style's total weighted score and the average total weighted score across all such styles.	",false,false,false,true,azure/o3,"local003,local219,local244,local196",weighted_prefs: Adds weight column using 3/2/1 points per PreferenceSeq; style_totals: Sums weights per StyleID and attaches StyleName; avg_score: Calculates average total score across all styles; style_diff: Computes absolute difference between each style_total and average score,weighted_prefs: Adds weight column using 3/2/1 points per PreferenceSeq; style_totals: Sums weights per StyleID and attaches StyleName; avg_score: Calculates average total score across all styles; style_diff: Computes absolute difference between each style_total and average score,"{""target_db"": ""EntertainmentAgency"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local003,local219,local244,local196""}",2025-10-17T16:32:45
local132,"Show all pairs of entertainers and customers who each have up to three style strengths or preferences, where the first and second style preferences of the customers match the first and second style strengths of the entertainers (or in reverse order). Only return the entertainer’s stage name and the customer’s last name",false,false,false,true,azure/o3,"local301,local056,local003,local300","ent_style_ord: ranks entertainer styles by strength, adds style_count per entertainer; ent_top_two: keeps entertainers with style_count<=3, pivots first two StyleIDs; cust_pref_ord: ranks customer preferences by sequence, adds pref_count per customer; cust_top_two: keeps customers with pref_count<=3, pivots first two StyleIDs; matched_pairs: joins entertainer and customer top_two where style1 and style2 match ordered or reversed","ent_style_ord: ranks entertainer styles by strength, adds style_count per entertainer; ent_top_two: keeps entertainers with style_count<=3, pivots first two StyleIDs; cust_pref_ord: ranks customer preferences by sequence, adds pref_count per customer; cust_top_two: keeps customers with pref_count<=3, pivots first two StyleIDs; matched_pairs: joins entertainer and customer top_two where style1 and style2 match ordered or reversed","{""target_db"": ""EntertainmentAgency"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local301,local056,local003,local300""}",2025-10-17T16:33:11
local141,"How did each salesperson's annual total sales compare to their annual sales quota? Provide the difference between their total sales and the quota for each year, organized by salesperson and year.",false,false,false,true,azure/o3,"local077,local301,local157,local021","sales_yearly: aggregates salesorderheader into annual_total_sales per salesperson; quota_yearly: aggregates SalesPersonQuotaHistory into annual_quota per salesperson; compare_gap: joins yearly sales and quotas, returning sales, quota, and sales_minus_quota difference","sales_yearly: aggregates salesorderheader into annual_total_sales per salesperson; quota_yearly: aggregates SalesPersonQuotaHistory into annual_quota per salesperson; compare_gap: joins yearly sales and quotas, returning sales, quota, and sales_minus_quota difference","{""target_db"": ""AdventureWorks"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local301,local157,local021""}",2025-10-17T16:33:18
local152,"Can you provide the top 9 directors by movie count, including their ID, name, number of movies, average inter-movie duration (rounded to the nearest integer), average rating (rounded to 2 decimals), total votes, minimum and maximum ratings, and total movie duration? Sort the output first by movie count in descending order and then by total movie duration in descending order.",false,false,false,true,azure/o3,"local021,local059,local141,local311","director_movies: maps each director to their movies with publication date and duration; movie_ratings: adds avg_rating and total_votes to director_movies; gap_years: calculates average gap between successive movie release years per director; director_stats: aggregates movie count, rating metrics, total votes, and total duration per director; ranked_directors: joins stats, gaps, and names; orders by movie count then total duration, selects top 9","director_movies: maps each director to their movies with publication date and duration; movie_ratings: adds avg_rating and total_votes to director_movies; gap_years: calculates average gap between successive movie release years per director; director_stats: aggregates movie count, rating metrics, total votes, and total duration per director; ranked_directors: joins stats, gaps, and names; orders by movie count then total duration, selects top 9","{""target_db"": ""imdb_movies"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local021,local059,local141,local311""}",2025-10-17T16:33:30
local230,"Determine the top three genres with the most movies rated above 8, and then identify the top four directors who have directed the most films rated above 8 within those genres. List these directors and their respective movie counts.",false,false,false,true,azure/o3,"local078,local264,local064,local056","high_rated_movies: selects movie_ids where avg_rating > 8; genre_movie_counts: joins high_rated_movies with genre and tallies movies per genre; top_genres: keeps three genres with highest tallies; top_genre_movies: filters high_rated_movies to those within top_genres; director_movie_counts: joins top_genre_movies with director_mapping and names, counts films per director, returns top four","high_rated_movies: selects movie_ids where avg_rating > 8; genre_movie_counts: joins high_rated_movies with genre and tallies movies per genre; top_genres: keeps three genres with highest tallies; top_genre_movies: filters high_rated_movies to those within top_genres; director_movie_counts: joins top_genre_movies with director_mapping and names, counts films per director, returns top four","{""target_db"": ""imdb_movies"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local078,local264,local064,local056""}",2025-10-17T16:33:38
local156,"Analyze the annual average purchase price per Bitcoin by region, computed as the total dollar amount spent divided by the total quantity purchased each year, excluding the first year's data for each region. Then, for each year, rank the regions based on these average purchase prices, and calculate the annual percentage change in cost for each region compared to the previous year.",false,false,false,true,azure/o3,"local074,local077,local300,local064","buy_txns: filters BTC BUY transactions, joins prices and members, adds region, txn_year, spend; annual_totals: aggregates total_spend and total_quantity by region and year; annual_avg_price: computes average_price per region-year as total_spend divided by quantity; first_region_years: selects earliest purchase year for each region; filtered_prices: excludes each region's first_year records; yearly_rankings: ranks regions within each year by average_price; pct_changes: calculates year-over-year percent change in average_price per region","buy_txns: filters BTC BUY transactions, joins prices and members, adds region, txn_year, spend; annual_totals: aggregates total_spend and total_quantity by region and year; annual_avg_price: computes average_price per region-year as total_spend divided by quantity; first_region_years: selects earliest purchase year for each region; filtered_prices: excludes each region's first_year records; yearly_rankings: ranks regions within each year by average_price; pct_changes: calculates year-over-year percent change in average_price per region","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local074,local077,local300,local064""}",2025-10-17T16:33:59
local157,"Using the ""bitcoin_prices"" table, please calculate the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021, ensuring that any volume ending in ""K"" or ""M"" is accurately converted to thousands or millions, any ""-"" volume is treated as zero, only non-zero volumes are used to determine the previous day's volume, and the results are ordered by ticker and date.",false,false,false,true,azure/o3,"local077,local301,local075,local074","volume_normalized: convert volume strings to numeric, '-' to 0; aug_window: restricts rows to 2021-08-01 through 2021-08-10; non_zero_lag: on aug_window, keep positive volumes and add prev non-zero volume per ticker via lag; daily_change: joins aug_window to non_zero_lag, computes daily percent change, orders by ticker and date","volume_normalized: convert volume strings to numeric, '-' to 0; aug_window: restricts rows to 2021-08-01 through 2021-08-10; non_zero_lag: on aug_window, keep positive volumes and add prev non-zero volume per ticker via lag; daily_change: joins aug_window to non_zero_lag, computes daily percent change, orders by ticker and date","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local077,local301,local075,local074""}",2025-10-17T16:34:11
local163,"Which university faculty members' salaries are closest to the average salary for their respective ranks? Please provide the ranks, first names, last names, and salaries.university",false,false,false,true,azure/o3,"local329,local201,local099,local015","rank_avg_salary: computes average salary for each FacRank; salary_diff: joins faculty with rank averages, adds absolute salary difference; min_diff_per_rank: selects minimum salary difference per rank; closest_faculty: filters faculty where difference equals rank minimum, returns details","rank_avg_salary: computes average salary for each FacRank; salary_diff: joins faculty with rank averages, adds absolute salary difference; min_diff_per_rank: selects minimum salary difference per rank; closest_faculty: filters faculty where difference equals rank minimum, returns details","{""target_db"": ""education_business"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local201,local099,local015""}",2025-10-17T16:34:17
local168,"Among job postings that specifically have the Data Analyst, require a non-null annual average salary, and are remote, what is the overall average salary when considering only the top three most frequently demanded skills for these positions?",false,false,false,true,azure/o3,"local244,local059,local056,local075","data_analyst_jobs: remote Data Analyst postings with non-null salary_year_avg selected; skill_counts: joins data_analyst_jobs to skills_dim via skills_job_dim, counts postings per skill; top_skills: keeps three skills with highest posting counts; top_skill_jobs: distinct data_analyst_jobs linked to any top_skill for overall average salary","data_analyst_jobs: remote Data Analyst postings with non-null salary_year_avg selected; skill_counts: joins data_analyst_jobs to skills_dim via skills_job_dim, counts postings per skill; top_skills: keeps three skills with highest posting counts; top_skill_jobs: distinct data_analyst_jobs linked to any top_skill for overall average salary","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local059,local056,local075""}",2025-10-17T16:34:28
local169,"What is the annual retention rate of legislators who began their first term between January 1, 1917 and December 31, 1999, measured as the proportion of this cohort still in office on December 31st for each of the first 20 years following their initial term start? The results should show all 20 periods in sequence regardless of whether any legislators were retained in a particular year.",false,false,false,true,azure/o3,"local264,local060,local064,local244","first_terms: earliest term_start per id_bioguide; start_cohort: legislators whose first_term is between 1917-01-01 and 1999-12-31, plus cohort size; years_1_20: generates integers 1 through 20; evaluation_dates: pairs each cohort legislator with December 31 date for each offset year; retained_flags: flags legislators whose evaluation_date falls within any term_start-term_end range; annual_retention: aggregates retained counts per year_number, computes retention rate, returns all 20 years sequentially","first_terms: earliest term_start per id_bioguide; start_cohort: legislators whose first_term is between 1917-01-01 and 1999-12-31, plus cohort size; years_1_20: generates integers 1 through 20; evaluation_dates: pairs each cohort legislator with December 31 date for each offset year; retained_flags: flags legislators whose evaluation_date falls within any term_start-term_end range; annual_retention: aggregates retained counts per year_number, computes retention rate, returns all 20 years sequentially","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local264,local060,local064,local244""}",2025-10-17T16:34:51
local171,"For male legislators from Louisiana, how many distinct legislators were actively serving on December 31 of each year from more than 30 years since their first term up to less than 50 years, grouping the results by the exact number of years elapsed since their first term?",false,false,false,true,azure/o3,"local059,local015,local032,local329",la_male_terms: filters male Louisiana legislators with term_start and term_end; first_term: finds earliest term_start per legislator; dec31_dates: selects December 31 dates from date dimension; active_dec31: pairs legislators whose term covers each Dec 31 date; tenure_window: computes years_elapsed since first term and keeps 31-49; yearly_counts: counts distinct legislators by years_elapsed,la_male_terms: filters male Louisiana legislators with term_start and term_end; first_term: finds earliest term_start per legislator; dec31_dates: selects December 31 dates from date dimension; active_dec31: pairs legislators whose term covers each Dec 31 date; tenure_window: computes years_elapsed since first term and keeps 31-49; yearly_counts: counts distinct legislators by years_elapsed,"{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local015,local032,local329""}",2025-10-17T16:35:05
local167,"Based on the state each female legislator first represented, which state has the highest number of female legislators whose terms included December 31st at any point, and what is that count? Please provide the state's abbreviation.",false,false,false,true,azure/o3,"local066,local010,local310,local199","female_terms: join legislators to terms, keeping only female legislators; terms_including_dec31: filter female_terms where term period includes any December 31; first_state: pick earliest term per legislator to get initial state; state_legislator_counts: count distinct legislators by first_state; top_state: select state with highest legislator count","female_terms: join legislators to terms, keeping only female legislators; terms_including_dec31: filter female_terms where term period includes any December 31; first_state: pick earliest term per legislator to get initial state; state_legislator_counts: count distinct legislators by first_state; top_state: select state with highest legislator count","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local066,local010,local310,local199""}",2025-10-17T16:35:21
local170,"Identify the state abbreviations where, for both male and female legislators, the retention rate remains greater than zero at specific intervals of 0, 2, 4, 6, 8, and 10 years after their first term start date. A legislator is considered retained if they are serving on December 31 of the respective year. Only include states where both gender cohorts maintain non-zero retention rates at all six of these time points during the first decade of service.",false,false,false,true,azure/o3,"local199,local219,local017,local311","first_term: derives first term_start date, initial state, gender per legislator; interval_targets: generates six Dec31 dates at 0,2,4,6,8,10 years after first_start for each legislator; retained_serving: marks legislators active on target dates by overlapping term_start<=date<=term_end; interval_retention_counts: counts retained legislators per state, gender, interval; state_interval_check: filters state-gender groups retaining non-zero counts across all intervals; qualified_states: selects states where both genders satisfy retention requirement","first_term: derives first term_start date, initial state, gender per legislator; interval_targets: generates six Dec31 dates at 0,2,4,6,8,10 years after first_start for each legislator; retained_serving: marks legislators active on target dates by overlapping term_start<=date<=term_end; interval_retention_counts: counts retained legislators per state, gender, interval; state_interval_check: filters state-gender groups retaining non-zero counts across all intervals; qualified_states: selects states where both genders satisfy retention requirement","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local199,local219,local017,local311""}",2025-10-17T16:35:36
local193,"Could you find out the average percentage of the total lifetime sales (LTV) that occur in the first 7 and 30 days after a customer's initial purchase? Also, include the average total lifetime sales (LTV). Please exclude customers with zero lifetime sales. The 7- and 30-day periods should be based on the exact number of hours-minutes-seconds, not calendar days.",false,false,false,true,azure/o3,"local196,local199,local194,local056","first_purchase: earliest payment timestamp per customer aggregated; customer_ltv: total lifetime sales summed per customer; period_sales: sums payments within 7 and 30 days of first purchase per customer; customer_percentages: computes 7-day and 30-day sales percentages of lifetime sales, excludes zero LTV; overall_averages: averages the two percentages and lifetime sales across qualified customers","first_purchase: earliest payment timestamp per customer aggregated; customer_ltv: total lifetime sales summed per customer; period_sales: sums payments within 7 and 30 days of first purchase per customer; customer_percentages: computes 7-day and 30-day sales percentages of lifetime sales, excludes zero LTV; overall_averages: averages the two percentages and lifetime sales across qualified customers","{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 42, ""same_db_total"": 4, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local196,local199,local194,local056""}",2025-10-17T16:35:46
local194,"Please provide a list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films, calculated by dividing the total film revenue equally among the actors for each film.",false,false,false,true,azure/o3,"local059,local229,local301,local023",film_revenue: sums payment amounts per film via rental and inventory; actor_counts: counts actors per film; actor_film_revenue: joins previous CTEs to compute each actor’s equal revenue share per film; ranked_actor_films: assigns row_number per actor ordered by revenue share desc; top3_actor_films: selects rows with rank ≤3 per actor; actor_avg_revenue: averages revenue share across top3 films per actor,film_revenue: sums payment amounts per film via rental and inventory; actor_counts: counts actors per film; actor_film_revenue: joins previous CTEs to compute each actor’s equal revenue share per film; ranked_actor_films: assigns row_number per actor ordered by revenue share desc; top3_actor_films: selects rows with rank ≤3 per actor; actor_avg_revenue: averages revenue share across top3 films per actor,"{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 41, ""same_db_total"": 3, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local059,local229,local301,local023""}",2025-10-17T16:35:56
local195,Please find out how widespread the appeal of our top five actors is. What percentage of our customers have rented films featuring these actors?,false,false,false,true,azure/o3,"local056,local199,local194,local196","actor_rental_counts: aggregates total rentals per actor via film_actor, inventory, rental joins; top_five_actors: selects five actors with highest rental counts from actor_rental_counts; customers_top_actors: distinct customers who rented films featuring any top_five_actors; customer_stats: compares total customers to top actor customers to compute percentage","actor_rental_counts: aggregates total rentals per actor via film_actor, inventory, rental joins; top_five_actors: selects five actors with highest rental counts from actor_rental_counts; customers_top_actors: distinct customers who rented films featuring any top_five_actors; customer_stats: compares total customers to top actor customers to compute percentage","{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 42, ""same_db_total"": 4, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local056,local199,local194,local196""}",2025-10-17T16:36:05
local196,For each rating category of the first movie rented by customers—where the first movie is identified based on the earliest payment date per customer—please provide the average total amount spent per customer and the average number of subsequent rentals (calculated as the total number of rentals minus one) for customers whose first rented movie falls into that rating category.,false,false,false,true,azure/o3,"local024,local194,local075,local032","payment_with_rating: joins payment→rental→inventory→film to capture customer, payment_date, amount, rental_id, rating; first_movie_rating: finds earliest payment_date per customer and extracts its rating; customer_spend_rentals: sums payment amounts and counts distinct rentals per customer; customer_metrics: merges totals with first_movie_rating, deriving subsequent_rentals = rental_count−1; rating_averages: computes average spend and average subsequent_rentals per first-movie rating","payment_with_rating: joins payment→rental→inventory→film to capture customer, payment_date, amount, rental_id, rating; first_movie_rating: finds earliest payment_date per customer and extracts its rating; customer_spend_rentals: sums payment amounts and counts distinct rentals per customer; customer_metrics: merges totals with first_movie_rating, deriving subsequent_rentals = rental_count−1; rating_averages: computes average spend and average subsequent_rentals per first-movie rating","{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 41, ""same_db_total"": 3, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local194,local075,local032""}",2025-10-17T16:36:16
local197,"Among our top 10 paying customers, can you identify the largest change in payment amounts from one month to the immediately following month? Specifically, please determine for which customer and during which month this maximum month-over-month difference occurred, and provide the difference rounded to two decimal places.",false,false,false,true,azure/o3,"local194,local196,local199,local056",customer_totals: total payment per customer aggregated; top_payers: top 10 customers by total spent; monthly_totals: sum of payments per top payer per year_month; monthly_diffs: absolute month-over-month payment change per top payer using lag; max_month_diff: highest monthly change across top payers with customer and month,customer_totals: total payment per customer aggregated; top_payers: top 10 customers by total spent; monthly_totals: sum of payments per top payer per year_month; monthly_diffs: absolute month-over-month payment change per top payer using lag; max_month_diff: highest monthly change across top payers with customer and month,"{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 42, ""same_db_total"": 4, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local194,local196,local199,local056""}",2025-10-17T16:36:26
local199,"Can you identify the year and month with the highest rental orders created by the store's staff for each store? Please list the store ID, the year, the month, and the total rentals for those dates.",false,false,false,true,azure/o3,"local310,local229,local283,local066","rental_with_store: joins rental to staff, adds rental_year and rental_month per row; monthly_totals: aggregates rentals per store, rental_year, rental_month; top_months_per_store: filters monthly_totals to rows with maximum rentals per store","rental_with_store: joins rental to staff, adds rental_year and rental_month per row; monthly_totals: aggregates rentals per store, rental_year, rental_month; top_months_per_store: filters monthly_totals to rows with maximum rentals per store","{""target_db"": ""SQLITE_SAKILA"", ""candidates_total"": 41, ""same_db_total"": 3, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local229,local283,local066""}",2025-10-17T16:36:32
local201,"Identify the first 10 words, sorted alphabetically, that are 4 to 5 characters long, start with 'r', and have at least one anagram of the same length, considering case-sensitive letters. Provide the count of such anagrams for each word.",false,false,false,true,azure/o3,"local196,local056,local026,local097",len_filtered: selects 4-5 letter words and adds sorted-letter signature; sig_counts: aggregates len_filtered by signature retaining counts greater than one; r_words: picks 'r'-starting words with signatures; r_with_counts: joins r_words to sig_counts computing anagram_count as count minus one,len_filtered: selects 4-5 letter words and adds sorted-letter signature; sig_counts: aggregates len_filtered by signature retaining counts greater than one; r_words: picks 'r'-starting words with signatures; r_with_counts: joins r_words to sig_counts computing anagram_count as count minus one,"{""target_db"": ""modern_data"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local056,local026,local097""}",2025-10-17T16:36:46
local202,"For alien data, how many of the top 10 states by alien population have a higher percentage of friendly aliens than hostile aliens, with an average alien age exceeding 200?",false,false,false,true,azure/o3,"local194,local300,local097,local010","state_summary: totals aliens, average age, friendly and hostile counts per state; top_states: selects ten states with highest alien populations; eligible_states: filters top_states where avg_age > 200 and friendly ratio exceeds hostile","state_summary: totals aliens, average age, friendly and hostile counts per state; top_states: selects ten states with highest alien populations; eligible_states: filters top_states where avg_age > 200 and friendly ratio exceeds hostile","{""target_db"": ""city_legislation"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local300,local097,local010""}",2025-10-17T16:36:52
local209,"In the dataset of orders joined with store information, which store has the highest total number of orders, and among that store’s orders, what is the ratio of orders that appear in the deliveries table with a 'DELIVERED' status to the total orders for that store?",false,false,false,true,azure/o3,"local064,local097,local141,local037",store_order_counts: counts total orders per store; top_store: selects store with maximum order count; delivered_orders: counts delivered orders for top store via join with deliveries,store_order_counts: counts total orders per store; top_store: selects store with maximum order count; delivered_orders: counts delivered orders for top store via join with deliveries,"{""target_db"": ""delivery_center"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local097,local141,local037""}",2025-10-17T16:36:59
local210,Can you identify the hubs that saw more than a 20% increase in finished orders from February to March?,false,false,false,true,azure/o3,"local329,local067,local244,local201","feb_mar_orders: finished orders Feb or Mar joined to hubs, returning hub_id, hub_name, month; hub_monthly_totals: count of finished orders per hub-month; hub_growth: pivot counts to feb_count and mar_count, compute percent increase, filter >20%","feb_mar_orders: finished orders Feb or Mar joined to hubs, returning hub_id, hub_name, month; hub_monthly_totals: count of finished orders per hub-month; hub_growth: pivot counts to feb_count and mar_count, compute percent increase, filter >20%","{""target_db"": ""delivery_center"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local067,local244,local201""}",2025-10-17T16:37:10
local212,Can you find 5 delivery drivers with the highest average number of daily deliveries?,false,false,false,true,azure/o3,"local196,local078,local060,local032","delivery_with_date: join deliveries to orders, deriving delivery_date; driver_daily_deliveries: count deliveries per driver per date; driver_avg_daily: average daily delivery counts per driver; top_5_drivers: rank averages, selecting five highest drivers","delivery_with_date: join deliveries to orders, deriving delivery_date; driver_daily_deliveries: count deliveries per driver per date; driver_avg_daily: average daily delivery counts per driver; top_5_drivers: rank averages, selecting five highest drivers","{""target_db"": ""delivery_center"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local078,local060,local032""}",2025-10-17T16:37:17
local218,Can you calculate the median from the highest season goals of each team?,false,false,false,true,azure/o3,"local097,local037,local067,local283","season_goals: sums home and away goals for every team per season; peak_goals: selects each team’s highest season goals total; ordered_peaks: orders peak_goals, adds row numbers and total count for median calculation","season_goals: sums home and away goals for every team per season; peak_goals: selects each team’s highest season goals total; ordered_peaks: orders peak_goals, adds row numbers and total count for median calculation","{""target_db"": ""EU_soccer"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local097,local037,local067,local283""}",2025-10-17T16:37:25
local219,"In each league, considering all seasons, which single team has the fewest total match wins based on comparing home and away goals, including teams with zero wins, ensuring that if multiple teams tie for the fewest wins, only one team is returned for each league?",false,false,false,true,azure/o3,"local024,local201,local037,local130","distinct_teams: collect unique league_id and team_api_id from matches; wins_by_team: count wins per league and team where goals favor that team; team_win_totals: merge distinct_teams with wins_by_team, defaulting win_count to zero; lowest_wins_rank: apply row_number over each league ordered by win_count asc then team_long_name; minimal_winners: choose rank 1 per league returning league and team details","distinct_teams: collect unique league_id and team_api_id from matches; wins_by_team: count wins per league and team where goals favor that team; team_win_totals: merge distinct_teams with wins_by_team, defaulting win_count to zero; lowest_wins_rank: apply row_number over each league ordered by win_count asc then team_long_name; minimal_winners: choose rank 1 per league returning league and team details","{""target_db"": ""EU_soccer"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local024,local201,local037,local130""}",2025-10-17T16:37:39
local221,Tell me top10 teams with the most wins across the league,false,false,false,true,azure/o3,"local196,local021,local283,local300","match_winners: selects winning team identifier from each match where goals higher than opponent; team_win_totals: aggregates wins per team by counting occurrences in match_winners; top10_teams: joins Team names, orders by win count descending, returns ten highest","match_winners: selects winning team identifier from each match where goals higher than opponent; team_win_totals: aggregates wins per team by counting occurrences in match_winners; top10_teams: joins Team names, orders by win count descending, returns ten highest","{""target_db"": ""EU_soccer"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local021,local283,local300""}",2025-10-17T16:37:51
local220,"Which player has participated in the highest number of winning matches and which player has participated in the highest number of losing matches, considering only matches where they actually played (excluding null entries) and where their team won or lost (excluding draws)?",false,false,false,true,azure/o3,"local017,local060,local300,local264","match_outcomes: classifies each match’s home and away result using goal comparison; player_results: unpivots player columns, links to outcomes, filters nulls and draws; player_totals: counts wins and losses per player; max_win_players: selects player(s) with greatest win count joined to Player; max_loss_players: selects player(s) with greatest loss count joined to Player","match_outcomes: classifies each match’s home and away result using goal comparison; player_results: unpivots player columns, links to outcomes, filters nulls and draws; player_totals: counts wins and losses per player; max_win_players: selects player(s) with greatest win count joined to Player; max_loss_players: selects player(s) with greatest loss count joined to Player","{""target_db"": ""EU_soccer"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local017,local060,local300,local264""}",2025-10-17T16:38:01
local228,"For each IPL season, identify the top three batsmen with the highest total runs scored and the top three bowlers with the most wickets taken, excluding ‘run out’, ‘hit wicket’, and ‘retired hurt’ dismissals. In the event of ties in runs or wickets, break the tie using the smaller player ID. Then output these six players in matched positions—batsman 1 with bowler 1, batsman 2 with bowler 2, and batsman 3 with bowler 3—in ascending order of the season ID, along with each player’s total runs or wickets.",false,false,false,true,azure/o3,"local021,local026,local229,local023","season_runs: sums runs per striker and season via batsman_scored-ball_by_ball-match join; batsman_ranked: ranks strikers per season by runs desc then player_id asc, keeping top 3; season_wickets: joins wicket_taken, ball_by_ball and match, filters excluded dismissal kinds, counts wickets per bowler and season; bowler_ranked: ranks bowlers per season by wickets desc then player_id asc, keeping top 3; paired_top_players: joins batsman_ranked and bowler_ranked on season and rank to align top players","season_runs: sums runs per striker and season via batsman_scored-ball_by_ball-match join; batsman_ranked: ranks strikers per season by runs desc then player_id asc, keeping top 3; season_wickets: joins wicket_taken, ball_by_ball and match, filters excluded dismissal kinds, counts wickets per bowler and season; bowler_ranked: ranks bowlers per season by wickets desc then player_id asc, keeping top 3; paired_top_players: joins batsman_ranked and bowler_ranked on season and rank to align top players","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local021,local026,local229,local023""}",2025-10-17T16:38:22
local229,"Find the IDs of players who scored the highest number of partnership runs for each match. The output should include the IDs of two players, each with their individual scores and the total partnership score. For each pair, the player with the higher individual score should be listed as player 1, and the player with the lower score as player 2. In cases where both players have the same score, the player with the higher ID should be player 1, and the player with the lower ID should be player 2. There can be multiple rows for a single match.",false,false,false,true,azure/o3,"local021,local228,local024,local023","ball_runs: joins deliveries with run records to list match_id, striker, non_striker, and runs_scored for each ball; pair_stats: groups ball_runs by match and sorted player pair, summing individual runs for each player and overall partnership runs; match_max: finds maximum partnership total_runs per match from pair_stats; top_partnerships: selects pair_stats rows whose total_runs equals match_max for their match; ordered_output: reorders each partnership so higher individual scorer—or if tied, higher player_id—is player1, providing player1_id, player1_runs, player2_id, player2_runs, total_runs","ball_runs: joins deliveries with run records to list match_id, striker, non_striker, and runs_scored for each ball; pair_stats: groups ball_runs by match and sorted player pair, summing individual runs for each player and overall partnership runs; match_max: finds maximum partnership total_runs per match from pair_stats; top_partnerships: selects pair_stats rows whose total_runs equals match_max for their match; ordered_output: reorders each partnership so higher individual scorer—or if tied, higher player_id—is player1, providing player1_id, player1_runs, player2_id, player2_runs, total_runs","{""target_db"": ""IPL"", ""candidates_total"": 41, ""same_db_total"": 5, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local021,local228,local024,local023""}",2025-10-17T16:38:39
local244,"Calculate the duration of each track, classify them as short, medium, or long, output the minimum and maximum time for each kind (in minutes) and the total revenue for each category, group by the category.",false,false,false,true,azure/o3,"local010,local070,local032,local311","track_length: converts milliseconds to minutes for each track and assigns short/medium/long category; track_revenue: totals quantity multiplied by unit_price per track from invoice lines; category_summary: joins length with revenue and aggregates by category for min_minutes, max_minutes, and total_revenue","track_length: converts milliseconds to minutes for each track and assigns short/medium/long category; track_revenue: totals quantity multiplied by unit_price per track from invoice lines; category_summary: joins length with revenue and aggregates by category for min_minutes, max_minutes, and total_revenue","{""target_db"": ""music"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local070,local032,local311""}",2025-10-17T16:38:46
local253,"Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations.",false,false,false,true,azure/o3,"local074,local077,local064,local194","cleaned_data: strips non-digits from Salary and casts to numeric; city_company_avg: averages salary per company and location; top5_city: ranks companies in target cities, keeping top 5 each; company_national_avg: calculates nationwide average salary per company; final_join: merges top5_city with national averages to output requested columns","cleaned_data: strips non-digits from Salary and casts to numeric; city_company_avg: averages salary per company and location; top5_city: ranks companies in target cities, keeping top 5 each; company_national_avg: calculates nationwide average salary per company; final_join: merges top5_city with national averages to output requested columns","{""target_db"": ""education_business"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local077,local064,local194""}",2025-10-17T16:38:55
local258,"Calculate the total number of wickets taken by each bowler (excluding run-outs and other dismissals not attributed to the bowler), their economy rate (total runs conceded divided by total overs bowled, considering only runs scored off the bat and ignoring any extra runs like wides and no-balls), their strike rate (average number of balls bowled per wicket taken), and their best bowling performance in a single match (the match with the most wickets taken by the bowler, formatted as ""wickets-runs"" where runs are the runs conceded excluding extras).",false,false,false,true,azure/o3,"local024,local023,local229,local021","legal_deliveries: legal deliveries per bowler excluding wides and no-balls; bat_runs: joins legal_deliveries with batsman_scored to get off-bat runs conceded per ball; bowler_wickets: filters wicket_taken for dismissals credited to bowler, excluding run-outs etc; match_bowling: aggregates balls, runs, wickets per bowler per match; career_bowling: computes total balls, overs, economy and strike rate per bowler; best_figures: selects each bowler’s match with most wickets (tie fewest runs) and formats wickets-runs string","legal_deliveries: legal deliveries per bowler excluding wides and no-balls; bat_runs: joins legal_deliveries with batsman_scored to get off-bat runs conceded per ball; bowler_wickets: filters wicket_taken for dismissals credited to bowler, excluding run-outs etc; match_bowling: aggregates balls, runs, wickets per bowler per match; career_bowling: computes total balls, overs, economy and strike rate per bowler; best_figures: selects each bowler’s match with most wickets (tie fewest runs) and formats wickets-runs string","{""target_db"": ""IPL"", ""candidates_total"": 42, ""same_db_total"": 6, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local024,local023,local229,local021""}",2025-10-17T16:39:10
local259,"For each player, list their ID, name, their most frequent role across all matches, batting hand, bowling skill, total runs scored, total matches played, total times they were dismissed, batting average (total runs divided by total dismissals), highest score in a single match, the number of matches in which they scored at least 30 runs, at least 50 runs, and at least 100 runs, total balls faced in their career, strike rate (total runs divided by total balls faced, multiplied by 100), total wickets taken, economy rate (average runs conceded per over), and their best bowling performance in a single match (most wickets taken in a match, formatted as ""wickets taken-runs given"", where the best performance is the one with the most wickets, and if tied, the fewest runs conceded). Ignore the extra runs data.",false,false,false,true,azure/o3,"local024,local229,local228,local023","role_counts: tallies appearance count of each role per player from player_match table; primary_role: selects each player’s most frequent role using role_counts, tie-broken by role alphabetically; matches_played: counts distinct matches participated per player from player_match; delivery_details: joins ball_by_ball, batsman_scored, wicket_taken to attach runs, striker, bowler, wicket indicator; batting_match_totals: aggregates delivery_details by striker and match to runs, balls, dismissals; batting_career_stats: derives total runs, balls, dismissals, average, strike rate, highest score, 30+/50+/100+ match counts per player; bowling_match_totals: aggregates delivery_details by bowler and match to wickets, runs conceded, balls bowled; bowling_career_stats: calculates total wickets, economy rate, best match figures string per bowler using bowling_match_totals","role_counts: tallies appearance count of each role per player from player_match table; primary_role: selects each player’s most frequent role using role_counts, tie-broken by role alphabetically; matches_played: counts distinct matches participated per player from player_match; delivery_details: joins ball_by_ball, batsman_scored, wicket_taken to attach runs, striker, bowler, wicket indicator; batting_match_totals: aggregates delivery_details by striker and match to runs, balls, dismissals; batting_career_stats: derives total runs, balls, dismissals, average, strike rate, highest score, 30+/50+/100+ match counts per player; bowling_match_totals: aggregates delivery_details by bowler and match to wickets, runs conceded, balls bowled; bowling_career_stats: calculates total wickets, economy rate, best match figures string per bowler using bowling_match_totals","{""target_db"": ""IPL"", ""candidates_total"": 42, ""same_db_total"": 6, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local024,local229,local228,local023""}",2025-10-17T16:39:52
local262,"Which problems exceed the total number of times they appear in the solution table when counting all occurrences, across steps 1, 2, and 3, where any non-""Stack"" model's maximum test score is lower than the ""Stack"" model's test score for the same step and version?",false,false,false,true,azure/o3,"local026,local229,local228,local074","stack_scores: selects 'Stack' model test scores per problem, version, step; nonstack_max_scores: computes max test_score among non-Stack models per problem, version, step; step_comparisons: joins Stack and non-Stack scores to compare test performances; valid_steps: keeps steps 1-3 where non-Stack max < Stack score; occurrence_counts: counts qualifying step records per problem; solution_counts: counts solution table rows per problem; exceeding_problems: selects problems whose qualifying count exceeds solution count","stack_scores: selects 'Stack' model test scores per problem, version, step; nonstack_max_scores: computes max test_score among non-Stack models per problem, version, step; step_comparisons: joins Stack and non-Stack scores to compare test performances; valid_steps: keeps steps 1-3 where non-Stack max < Stack score; occurrence_counts: counts qualifying step records per problem; solution_counts: counts solution table rows per problem; exceeding_problems: selects problems whose qualifying count exceeds solution count","{""target_db"": ""stacking"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local229,local228,local074""}",2025-10-17T16:40:08
local263,"Identify the L1_model associated with each model (specified by name and version) that occurs most frequently for each status ('strong' or 'soft'), along with the number of times it occurs. A model has a 'strong' status if, for any of its steps, the maximum test score among non-'Stack' models is less than the 'Stack' model's test score. It has a 'soft' status if the maximum test score among non-'Stack' models equals the 'Stack' model's test score. Count how many times each L1_model is associated with a 'strong' or 'soft' status across all models, and determine which L1_model has the highest occurrence for each status.",false,false,false,true,azure/o3,"local194,local032,local196,local021","stack_step_scores: extracts test_score for 'Stack' models per name, version, step; non_stack_max_scores: obtains max test_score among non-'Stack' models per name, version, step; step_comparison: compares stack_score versus max_non for each step, tagging result; model_status: aggregates step tags per name/version to assign overall strong or soft status, joining L1_model; l1_status_counts: tallies model counts per L1_model and status; top_l1_by_status: picks L1_model with highest count for each status","stack_step_scores: extracts test_score for 'Stack' models per name, version, step; non_stack_max_scores: obtains max test_score among non-'Stack' models per name, version, step; step_comparison: compares stack_score versus max_non for each step, tagging result; model_status: aggregates step tags per name/version to assign overall strong or soft status, joining L1_model; l1_status_counts: tallies model counts per L1_model and status; top_l1_by_status: picks L1_model with highest count for each status","{""target_db"": ""stacking"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local032,local196,local021""}",2025-10-17T16:40:27
local264,"Which model category (L1_model) appears the most frequently across all steps and versions when comparing traditional models to the Stack model, and what is the total count of its occurrences?",false,false,false,true,azure/o3,"local244,local300,local066,local026","raw_models: selects L1_model, step and version columns for analysis; model_frequencies: counts occurrences per L1_model across every step and version; top_model: retrieves L1_model with maximum total count","raw_models: selects L1_model, step and version columns for analysis; model_frequencies: counts occurrences per L1_model across every step and version; top_model: retrieves L1_model with maximum total count","{""target_db"": ""stacking"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local300,local066,local026""}",2025-10-17T16:40:37
local269,"What is the average total quantity across all final packaging combinations, considering only the leaf-level items within each combination after fully expanding any nested packaging relationships?",false,false,false,true,azure/o3,"local194,local024,local099,local075","root_packages: selects packaging IDs never referenced as contains_id, representing top-level packaging combinations; expanded_paths: recursively traverses packaging_relations from root_packages, accumulating path quantity product to each contained item; leaf_paths: filters expanded_paths to items that themselves contain no children, retaining final multiplied quantity per root package; package_totals: sums leaf quantities per root package to derive total quantity for each top-level combination; avg_qty: calculates overall average of total quantities across all root package combinations","root_packages: selects packaging IDs never referenced as contains_id, representing top-level packaging combinations; expanded_paths: recursively traverses packaging_relations from root_packages, accumulating path quantity product to each contained item; leaf_paths: filters expanded_paths to items that themselves contain no children, retaining final multiplied quantity per root package; package_totals: sums leaf quantities per root package to derive total quantity for each top-level combination; avg_qty: calculates overall average of total quantities across all root package combinations","{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local194,local024,local099,local075""}",2025-10-17T16:40:48
local270,"Which top-level packaging containers, meaning those not contained within any other packaging, have any item for which the total quantity accumulated across all nested levels in the hierarchy exceeds 500, and what are the names of both these containers and the corresponding items?",false,false,false,true,azure/o3,"local253,local017,local199,local099",top_level_containers: selects packaging not present as child in packaging_relations; recursive_contents: recursively expands contents for each top-level container calculating cumulative quantity; aggregated_items: sums cumulative quantity per top-level container and product; exceeding_items: filters aggregated_items where sum_qty > 500; named_results: joins exceeding_items with packaging and products to fetch container and item names,top_level_containers: selects packaging not present as child in packaging_relations; recursive_contents: recursively expands contents for each top-level container calculating cumulative quantity; aggregated_items: sums cumulative quantity per top-level container and product; exceeding_items: filters aggregated_items where sum_qty > 500; named_results: joins exceeding_items with packaging and products to fetch container and item names,"{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local253,local017,local199,local099""}",2025-10-17T16:40:59
local272,"For order 423, identify the product IDs, aisles, and positions from which to pick the exact quantities needed for each order line, ensuring that the total picked quantity for each product matches the cumulative quantities ordered without exceeding the available inventory in warehouse 1. Calculate the quantities to be picked from each location by prioritizing inventory with earlier purchased dates and smaller quantities, and ensure that picking respects the sequence and cumulative quantities of the order lines for products with multiple entries.",false,false,false,true,azure/o3,"local010,local194,local099,local015","order_lines_423: fetch order 423 lines with product_id, qty, line_seq, cumulative_demand per product; warehouse1_inventory: inventory rows in warehouse 1 joined to locations and purchases with aisle, position, purchase_date, qty_on_hand; prioritized_inventory: inventory sorted by product, purchase_date, qty ascending and assigned priority_rank; inventory_cume: adds cumulative_available_qty per product across prioritized_inventory; pick_allocations: matches cumulative demand to cumulative availability to derive pick_qty per product-location ensuring totals met","order_lines_423: fetch order 423 lines with product_id, qty, line_seq, cumulative_demand per product; warehouse1_inventory: inventory rows in warehouse 1 joined to locations and purchases with aisle, position, purchase_date, qty_on_hand; prioritized_inventory: inventory sorted by product, purchase_date, qty ascending and assigned priority_rank; inventory_cume: adds cumulative_available_qty per product across prioritized_inventory; pick_allocations: matches cumulative demand to cumulative availability to derive pick_qty per product-location ensuring totals met","{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local194,local099,local015""}",2025-10-17T16:41:17
local273,"Calculate the average pick percentage for each product name, using a first-in-first-out approach that selects from inventory locations based on the earliest purchase date and smallest available quantity, ensuring that the picked quantity reflects only the overlapping range between each order’s required quantity and the inventory’s available quantity, and then grouping and ordering the results by product name?",false,false,false,true,azure/o3,"local196,local056,local077,local032","purchase_dated_inventory: joins inventory and purchases, adding purchase_date and ranking inventory per product by earliest date then smallest qty; order_requirements: selects each orderline with product_id and required qty needed for picking; fifo_allocations: matches order requirements to ranked inventory FIFO, recording picked_qty as overlap of remaining need and available qty; product_pick_totals: aggregates total required_qty and picked_qty per product; product_avg_pick: joins totals with products, computes pick_percentage, orders results alphabetically by product name","purchase_dated_inventory: joins inventory and purchases, adding purchase_date and ranking inventory per product by earliest date then smallest qty; order_requirements: selects each orderline with product_id and required qty needed for picking; fifo_allocations: matches order requirements to ranked inventory FIFO, recording picked_qty as overlap of remaining need and available qty; product_pick_totals: aggregates total required_qty and picked_qty per product; product_avg_pick: joins totals with products, computes pick_percentage, orders results alphabetically by product name","{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local196,local056,local077,local032""}",2025-10-17T16:41:34
local274,"Which products were picked for order 421, and what is the average number of units picked for each product, using FIFO (First-In, First-Out) method?",false,false,false,true,azure/o3,"local067,local060,local229,local283",order_picks: selects product and quantity lines for order 421; product_purchases: lists purchase lots with quantities and dates ordered FIFO per product; fifo_allocation: allocates order pick quantities to earliest purchase lots producing allocated_qty; avg_units_per_product: averages allocated_qty per product; product_results: joins product names to average units for final output,order_picks: selects product and quantity lines for order 421; product_purchases: lists purchase lots with quantities and dates ordered FIFO per product; fifo_allocation: allocates order pick quantities to earliest purchase lots producing allocated_qty; avg_units_per_product: averages allocated_qty per product; product_results: joins product names to average units for final output,"{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local067,local060,local229,local283""}",2025-10-17T16:41:46
local275,"Based on monthly sales data starting in January 2016 and using a centered moving average to adjust for seasonality, which products had a seasonality-adjusted sales ratio that stayed consistently above 2 for every month in the year 2017?",false,false,false,true,azure/o3,"local099,local253,local199,local064",product_sales: selects per-product monthly sales starting Jan 2016; centered_ma: calculates 12-month centered moving average for each product-month; seasonal_ratio: derives actual divided by moving average ratio; ratios_2017: isolates 2017 months with ratio values; consistent_products: returns products whose 2017 ratios exceed 2 in all twelve months,product_sales: selects per-product monthly sales starting Jan 2016; centered_ma: calculates 12-month centered moving average for each product-month; seasonal_ratio: derives actual divided by moving average ratio; ratios_2017: isolates 2017 months with ratio values; consistent_products: returns products whose 2017 ratios exceed 2 in all twelve months,"{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local099,local253,local199,local064""}",2025-10-17T16:41:58
local277,"What is the average forecasted annual sales for products 4160 and 7790 during 2018, using monthly sales data starting from January 2016 for the first 36 months, applying seasonality adjustments from time steps 7 through 30, and employing a weighted regression method to estimate sales?",false,false,false,true,azure/o3,"local056,local253,local097,local099",filtered_sales: keep records for products 4160 and 7790 between 2016-01 and 2018-12; time_series: adds sequential month_index and month_of_year per product; seasonality_index: average qty per product and month_of_year using indices 7-30 to derive seasonal factor; deseasonalized_sales: divides qty by seasonal factor to remove seasonality; weighted_regression: calculates weighted least-squares slope and intercept per product on month_index vs deseasonalized_qty; forecast_2018: predicts 2018 monthly sales by applying model and restoring seasonality; avg_annual_forecast: averages forecasted 2018 sales per product,filtered_sales: keep records for products 4160 and 7790 between 2016-01 and 2018-12; time_series: adds sequential month_index and month_of_year per product; seasonality_index: average qty per product and month_of_year using indices 7-30 to derive seasonal factor; deseasonalized_sales: divides qty by seasonal factor to remove seasonality; weighted_regression: calculates weighted least-squares slope and intercept per product on month_index vs deseasonalized_qty; forecast_2018: predicts 2018 monthly sales by applying model and restoring seasonality; avg_annual_forecast: averages forecasted 2018 sales per product,"{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local056,local253,local097,local099""}",2025-10-17T16:42:17
local279,"Using a recursive monthly inventory adjustment model starting from December 2018 inventory levels, where we restock a product if its ending inventory drops below the minimum required level, determine for each product the month in 2019 where the absolute difference between its ending inventory and the minimum required level is the smallest, and return the product_id, that month, and the absolute difference.",false,false,false,true,azure/o3,"local064,local301,local077,local010","months_2019: generates list of 2019 months for timeline; start_inventory: selects December 2018 ending inventory quantity per product; sales_2019: aggregates monthly sales quantity per product per 2019 month; product_rules: fetches minimum level and restock purchase size per product; recursive_balances: iteratively updates inventory month by month subtracting sales and adding restock when below minimum; min_diff_month: computes absolute difference per month, selects month with smallest value per product","months_2019: generates list of 2019 months for timeline; start_inventory: selects December 2018 ending inventory quantity per product; sales_2019: aggregates monthly sales quantity per product per 2019 month; product_rules: fetches minimum level and restock purchase size per product; recursive_balances: iteratively updates inventory month by month subtracting sales and adding restock when below minimum; min_diff_month: computes absolute difference per month, selects month with smallest value per product","{""target_db"": ""oracle_sql"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local064,local301,local077,local010""}",2025-10-17T16:42:30
local283,"Analyze the soccer match dataset to determine the champion team for each season across all countries and leagues, awarding 3 points for every win, 1 point for every tie, and 0 points for every loss. For each season, return the champion’s team name, the league, the country, and the total points accumulated.",false,false,false,true,azure/o3,"local310,local074,local201,local067","match_points: creates one row per team per match with computed win/tie/loss points; season_points: sums points per team, league, season; ranked_teams: ranks teams by descending points within each league-season; champions: selects rank-1 teams and joins league, country, team names","match_points: creates one row per team per match with computed win/tie/loss points; season_points: sums points per team, league, season; ranked_teams: ranks teams by descending points within each league-season; champions: selects rank-1 teams and joins league, country, team names","{""target_db"": ""EU_soccer"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local310,local074,local201,local067""}",2025-10-17T16:42:45
local284,"For veg whsle data, can you generate a summary of our items' loss rates? Include the average loss rate, and also break down the count of items that are below, above, and within one standard deviation from this average.",false,false,false,true,azure/o3,"local077,local078,local064,local074","raw_data: selects item_code, item_name, numeric loss_rate from veg_loss_rate_df; stats: calculates overall average and stddev of loss_rate; classified_items: categorizes each item as below, within, or above one stddev of average; category_counts: counts items per category and appends overall average and stddev","raw_data: selects item_code, item_name, numeric loss_rate from veg_loss_rate_df; stats: calculates overall average and stddev of loss_rate; classified_items: categorizes each item as below, within, or above one stddev of average; category_counts: counts items per category and appends overall average and stddev","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local077,local078,local064,local074""}",2025-10-17T16:42:58
local285,"For veg whsle data, can you analyze our financial performance over the years 2020 to 2023? I need insights into the average wholesale price, maximum wholesale price, minimum wholesale price, wholesale price difference, total wholesale price, total selling price, average loss rate, total loss, and profit for each category within each year. Round all calculated values to two decimal places.",false,false,false,true,azure/o3,"local157,local077,local075,local074","whsle_base: selects 2020-2023 wholesale records, extracts year, attaches category; whsle_stats: computes avg, max, min, diff wholesale price per category-year; loss_rates: converts loss_rate_% to decimal per item; txn_base: selects 2020-2023 sales, adds year and category, joins wholesale price and loss rate to get revenue, cost, loss; txn_summary: aggregates txn_base to total wholesale cost, selling revenue, average loss rate, total loss, profit per category-year; cat_year_summary: joins whsle_stats with txn_summary and rounds all metrics","whsle_base: selects 2020-2023 wholesale records, extracts year, attaches category; whsle_stats: computes avg, max, min, diff wholesale price per category-year; loss_rates: converts loss_rate_% to decimal per item; txn_base: selects 2020-2023 sales, adds year and category, joins wholesale price and loss rate to get revenue, cost, loss; txn_summary: aggregates txn_base to total wholesale cost, selling revenue, average loss rate, total loss, profit per category-year; cat_year_summary: joins whsle_stats with txn_summary and rounds all metrics","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local157,local077,local075,local074""}",2025-10-17T16:43:25
local286,"Prepare a comprehensive performance report on our sellers, focusing on total sales, average item price, average review scores, and packing times. Ensure that the report includes only those sellers who have sold a quantity of more than 100 products and highlight the product category names in English with the highest sales volume.",false,false,false,true,azure/o3,"local329,local070,local141,local077","orders_with_packing: computes packing_time per order from approved and delivered dates; item_stats: joins order_items to orders_with_packing keeping seller, price, product_id, packing_time; seller_sales: aggregates item_stats for qty_sold, total_sales, avg_price, avg_packing_time per seller; seller_reviews: joins order_items to order_reviews to average review_score per seller; seller_metrics: combines seller_sales and seller_reviews, keeping sellers with qty_sold > 100; category_sales: item_stats joined to products and category translation to count units per seller and english category; top_categories: selects highest-volume english category for each seller from category_sales","orders_with_packing: computes packing_time per order from approved and delivered dates; item_stats: joins order_items to orders_with_packing keeping seller, price, product_id, packing_time; seller_sales: aggregates item_stats for qty_sold, total_sales, avg_price, avg_packing_time per seller; seller_reviews: joins order_items to order_reviews to average review_score per seller; seller_metrics: combines seller_sales and seller_reviews, keeping sellers with qty_sold > 100; category_sales: item_stats joined to products and category translation to count units per seller and english category; top_categories: selects highest-volume english category for each seller from category_sales","{""target_db"": ""electronic_sales"", ""candidates_total"": 42, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local070,local141,local077""}",2025-10-17T16:43:44
local301,"For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year.",false,false,false,true,azure/o3,"local300,local157,local074,local064",filtered_sales: selects weekly sales rows for years 2018-2020; classified_weeks: labels each record as pre or post June 15 within four-week window; period_totals: sums sales per calendar_year and period; pct_change: computes percentage change from pre to post for each year,filtered_sales: selects weekly sales rows for years 2018-2020; classified_weeks: labels each record as pre or post June 15 within four-week window; period_totals: sums sales per calendar_year and period; pct_change: computes percentage change from pre to post for each year,"{""target_db"": ""bank_sales_trading"", ""candidates_total"": 41, ""same_db_total"": 7, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local300,local157,local074,local064""}",2025-10-17T16:43:59
local302,"Analyze the average percentage change in sales between the 12 weeks before and after June 15, 2020, for each attribute type: region, platform, age band, demographic, and customer type. For each attribute type, calculate the average percentage change in sales across all its attribute values. Identify the attribute type with the highest negative impact on sales and provide its average percentage change in sales.",false,false,false,true,azure/o3,"local300,local074,local078,local301","labeled_weeks: labels weekly rows within 12-week window as before or after 15-Jun-2020; attr_sales: unpivots five attribute columns, summing sales per attribute type, value, and period; pct_change_by_value: computes percent change between after and before totals for each attribute type and value; pct_change_by_type: averages these percentage changes across all values per attribute type; worst_attribute: identifies attribute type with lowest average percent change and returns its metric","labeled_weeks: labels weekly rows within 12-week window as before or after 15-Jun-2020; attr_sales: unpivots five attribute columns, summing sales per attribute type, value, and period; pct_change_by_value: computes percent change between after and before totals for each attribute type and value; pct_change_by_type: averages these percentage changes across all values per attribute type; worst_attribute: identifies attribute type with lowest average percent change and returns its metric","{""target_db"": ""bank_sales_trading"", ""candidates_total"": 42, ""same_db_total"": 8, ""used_same_db_pool"": ""true"", ""chosen_ids"": ""local300,local074,local078,local301""}",2025-10-17T16:44:22
local329,"How many unique sessions visited the /regist/input page and then the /regist/confirm page, in that order?",false,false,false,true,azure/o3,"local026,local130,local015,local066",page_hits: filter action_log_with_noise for /regist/input and /regist/confirm entries; first_page_hits: take earliest timestamp per session for each target page; input_before_confirm: keep sessions with confirm time later than input time; session_count: count distinct sessions from previous CTE,page_hits: filter action_log_with_noise for /regist/input and /regist/confirm entries; first_page_hits: take earliest timestamp per session for each target page; input_before_confirm: keep sessions with confirm time later than input time; session_count: count distinct sessions from previous CTE,"{""target_db"": ""log"", ""candidates_total"": 41, ""same_db_total"": 0, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local026,local130,local015,local066""}",2025-10-17T16:44:27
local330,"Using the activity log table, compute the total number of unique user sessions where each web page appears as either a landing page (the first page visited in a session based on timestamp) or an exit page (the last page visited in a session based on timestamp), or both. Count each session only once per page even if the page serves as both landing and exit for that session. ",false,false,false,true,azure/o3,"local077,local310,local064,local070","session_bounds: identifies landing and exit page per session via min/max stamp; landing_exit_pairs: expands landing and exit paths into page-session rows, removing duplicates per session; page_session_counts: aggregates distinct sessions per page to deliver total sessions where page is landing, exit, or both","session_bounds: identifies landing and exit page per session via min/max stamp; landing_exit_pairs: expands landing and exit paths into page-session rows, removing duplicates per session; page_session_counts: aggregates distinct sessions per page to deliver total sessions where page is landing, exit, or both","{""target_db"": ""log"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local077,local310,local064,local070""}",2025-10-17T16:44:34
local331,"Which three distinct third-page visits are most frequently observed immediately after two consecutive visits to the '/detail' page, and how many times does each third-page visit occur?",false,false,false,true,azure/o3,"local229,local032,local056,local074","unified_events: merges all log sources into session, timestamp, page rows; ordered_visits: orders events per session, adds sequential numbers; detail_followups: extracts page following two consecutive '/detail' visits; visit_counts: counts occurrences of each extracted third page; top_three_visits: selects three pages with highest counts for output","unified_events: merges all log sources into session, timestamp, page rows; ordered_visits: orders events per session, adds sequential numbers; detail_followups: extracts page following two consecutive '/detail' visits; visit_counts: counts occurrences of each extracted third page; top_three_visits: selects three pages with highest counts for output","{""target_db"": ""log"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local229,local032,local056,local074""}",2025-10-17T16:44:42
local358,"How many users are there in each age category (20s, 30s, 40s, 50s, and others)?",false,false,false,true,azure/o3,"local015,local010,local059,local228","user_age_calc: computes current age in years from birth_date for every user; age_bucketed: maps ages into categories 20s, 30s, 40s, 50s, or others; age_counts: counts users grouped by age category","user_age_calc: computes current age in years from birth_date for every user; age_bucketed: maps ages into categories 20s, 30s, 40s, 50s, or others; age_counts: counts users grouped by age category","{""target_db"": ""log"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local015,local010,local059,local228""}",2025-10-17T16:44:49
local360,"For each user session in the activity log table, identify the number of events that occurred before the first '/detail' click or '/complete' conversion, counting only events that have a non-empty search type. Find the sessions with the minimum count of such pre-click/pre-conversion events. If multiple sessions share this minimum count, include all of them in the results. Return each qualifying session along with the corresponding path and search type.",false,false,false,true,azure/o3,"local060,local070,local194,local283",target_times: earliest stamp per session with path '/detail' or '/complete'; pre_search_events: events before each target_time having non-empty search_type; session_pre_counts: counts qualifying pre events per session; min_count_sessions: selects sessions whose pre_event_count equals overall minimum; qualifying_events: pre_search_events belonging to min_count_sessions,target_times: earliest stamp per session with path '/detail' or '/complete'; pre_search_events: events before each target_time having non-empty search_type; session_pre_counts: counts qualifying pre events per session; min_count_sessions: selects sessions whose pre_event_count equals overall minimum; qualifying_events: pre_search_events belonging to min_count_sessions,"{""target_db"": ""log"", ""candidates_total"": 42, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local070,local194,local283""}",2025-10-17T16:45:05
local344,"Considering all races where pit stop data is available, and focusing on instances when a driver was not behind another car on the previous lap but is behind on the current lap (accounting for retirements, pit-stop entries, pit-stop exits, and race starts), how many times has each type of overtake occurred in Formula 1?",false,false,false,true,azure/o3,"local329,local075,local056,local074","valid_races: race_ids where races_ext.is_pit_data_available is true; pit_flags: creates pit_in and pit_out flags per driver lap using pit_stops within valid races; retirement_laps: captures driver retirement lap and category within valid races; start_positions: joins results grid with lap_positions lap1 to flag drivers losing places at start; lap_changes: for laps≥2, compares current vs previous position per driver, adds pit_in, pit_out, retirement flags; overtake_events: selects losses where driver newly behind, labels type start, pit_entry, pit_exit, retirement, on_track; overtake_counts: aggregates number of overtakes per overtake_type","valid_races: race_ids where races_ext.is_pit_data_available is true; pit_flags: creates pit_in and pit_out flags per driver lap using pit_stops within valid races; retirement_laps: captures driver retirement lap and category within valid races; start_positions: joins results grid with lap_positions lap1 to flag drivers losing places at start; lap_changes: for laps≥2, compares current vs previous position per driver, adds pit_in, pit_out, retirement flags; overtake_events: selects losses where driver newly behind, labels type start, pit_entry, pit_exit, retirement, on_track; overtake_counts: aggregates number of overtakes per overtake_type","{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local329,local075,local056,local074""}",2025-10-17T16:45:26
local336,"In the first five laps of the race, how many overtakes occurred in each category—retirements, pit stops, start-related overtakes, and standard on-track passes?",false,false,false,true,azure/o3,"local228,local130,local015,local244","grid_positions: starting grid positions per race and driver; first_five_positions: lap positions for laps 1-5; lap_gains: position gains per driver between consecutive laps; pit_events: pit stop laps within first five; retire_events: retirements during laps 1-5; categorized_gains: classifies each gain as start, pit, retirement, or standard; category_totals: counts overtakes per category for final output","grid_positions: starting grid positions per race and driver; first_five_positions: lap positions for laps 1-5; lap_gains: position gains per driver between consecutive laps; pit_events: pit stop laps within first five; retire_events: retirements during laps 1-5; categorized_gains: classifies each gain as start, pit, retirement, or standard; category_totals: counts overtakes per category for final output","{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local228,local130,local015,local244""}",2025-10-17T16:45:46
local335,"In Formula 1 seasons since 2001, considering only drivers who scored points in a season, which five constructors have had the most seasons where their drivers scored the fewest total points among all point-scoring drivers in that season?",false,false,false,true,azure/o3,"local228,local141,local064,local283",season_driver_points: aggregate total points per driver-season since 2001 using driver_standings joined to races; season_min_points: compute minimum positive points per season; bottom_driver_seasons: select drivers matching season minimum and map to constructor via drives; constructor_bottom_counts: count seasons per constructor where it had bottom scoring driver; top_five_constructors: pick five constructors with most such seasons ordered by count then name,season_driver_points: aggregate total points per driver-season since 2001 using driver_standings joined to races; season_min_points: compute minimum positive points per season; bottom_driver_seasons: select drivers matching season minimum and map to constructor via drives; constructor_bottom_counts: count seasons per constructor where it had bottom scoring driver; top_five_constructors: pick five constructors with most such seasons ordered by count then name,"{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local228,local141,local064,local283""}",2025-10-17T16:45:56
local309,"For each year, which driver and which constructor scored the most points? I want the full name of each driver.",false,false,false,true,azure/o3,"local010,local196,local264,local141",final_races: last race_id per year determined by max round; final_driver_points: driver_standings joined to final_races for season-end points per driver; top_drivers: picks highest-scoring driver each year with row_number; final_constructor_points: constructor_standings joined to final_races for season-end points per constructor; top_constructors: picks highest-scoring constructor each year with row_number; driver_names: maps driver_id to driver full_name for output,final_races: last race_id per year determined by max round; final_driver_points: driver_standings joined to final_races for season-end points per driver; top_drivers: picks highest-scoring driver each year with row_number; final_constructor_points: constructor_standings joined to final_races for season-end points per constructor; top_constructors: picks highest-scoring constructor each year with row_number; driver_names: maps driver_id to driver full_name for output,"{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local010,local196,local264,local141""}",2025-10-17T16:46:15
local310,"Using only the data from the ‘results’ table, find the three years in which the sum of the highest total points earned by any driver and the highest total points earned by any constructor in that year (both calculated by summing up points from the ‘results’ table) is smallest, and list those three years in order of ascending total.",false,false,false,true,azure/o3,"local074,local311,local032,local059","results_by_year: join results to races to add race year; driver_totals: sum points per driver and year; top_driver_points: pick maximum driver total for each year; constructor_totals: sum points per constructor and year; top_constructor_points: pick maximum constructor total for each year; year_combined_min: add yearly top driver and constructor points, keep three smallest totals","results_by_year: join results to races to add race year; driver_totals: sum points per driver and year; top_driver_points: pick maximum driver total for each year; constructor_totals: sum points per constructor and year; top_constructor_points: pick maximum constructor total for each year; year_combined_min: add yearly top driver and constructor points, keep three smallest totals","{""target_db"": ""f1"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local074,local311,local032,local059""}",2025-10-17T16:46:25
local311,"Which constructors had the top 3 combined points from their best driver and team, and in which years did they achieve them?",false,false,false,true,azure/o3,"local023,local064,local244,local066",race_years: maps each race_id to season year for joins; constructor_year_points: sums constructor_standings points per constructor per year; driver_year_points: sums driver_standings points per driver per year; best_driver_points: joins driver_year_points to drives and keeps max points per constructor-year; combined_points: adds constructor total and best driver points per constructor-year; top_three_constructors: selects top three constructor-year combos by combined points and attaches constructor name,race_years: maps each race_id to season year for joins; constructor_year_points: sums constructor_standings points per constructor per year; driver_year_points: sums driver_standings points per driver per year; best_driver_points: joins driver_year_points to drives and keeps max points per constructor-year; combined_points: adds constructor total and best driver points per constructor-year; top_three_constructors: selects top three constructor-year combos by combined points and attaches constructor name,"{""target_db"": ""f1"", ""candidates_total"": 41, ""same_db_total"": 1, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local023,local064,local244,local066""}",2025-10-17T16:46:39
local354,"Among Formula 1 drivers who raced during the 1950s, which drivers completed a season in that decade with the same constructor in both the first and the last race they participated in, while also taking part in at least two distinct race rounds during that season?",false,false,false,true,azure/o3,"local244,local077,local194,local067",fifties_drives: filters drives to seasons 1950-1959; driver_season_stats: derives first and last constructors and distinct round count per driver-year; qualified_seasons: retains driver-years with same first/last constructor and at least two rounds; driver_constructors: attaches driver and constructor names for final output,fifties_drives: filters drives to seasons 1950-1959; driver_season_stats: derives first and last constructors and distinct round count per driver-year; qualified_seasons: retains driver-years with same first/last constructor and at least two rounds; driver_constructors: attaches driver and constructor names for final output,"{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local244,local077,local194,local067""}",2025-10-17T16:46:58
local355,"Calculate the overall average first round and average last round of races missed by Formula 1 drivers across all years. Include only drivers who missed fewer than three races in a given year and who switched teams between their appearances immediately before and after their hiatus (i.e., the constructor ID for the race right before their first missed race must be different from the constructor ID for the race right after their last missed race in that year). Do not group results by year; return just the overall averages across the entire dataset.",false,false,false,true,azure/o3,"local201,local253,local229,local066","stints: selects driver_id, year, constructor_id, first_round, last_round from drives; ordered_stints: ranks stints per driver-year and adds next stint details via lead; hiatus_candidates: computes gap_start, gap_end, missed_count, constructor_switched flag between consecutive stints; qualified_hiatuses: keeps gaps with missed_count < 3 and constructor_switched; overall_avg_missed_rounds: averages gap_start and gap_end across all qualified hiatuses","stints: selects driver_id, year, constructor_id, first_round, last_round from drives; ordered_stints: ranks stints per driver-year and adds next stint details via lead; hiatus_candidates: computes gap_start, gap_end, missed_count, constructor_switched flag between consecutive stints; qualified_hiatuses: keeps gaps with missed_count < 3 and constructor_switched; overall_avg_missed_rounds: averages gap_start and gap_end across all qualified hiatuses","{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local201,local253,local229,local066""}",2025-10-17T16:47:21
local356,"Provide the full names of drivers who have been overtaken on track more times than they have overtaken others on track during race laps, excluding position changes due to pit stops (both at pit entry and exit), retirements, or position changes that occurred during the first lap of a race (considered as start movements).",false,false,false,true,azure/o3,"local060,local015,local300,local099","pit_lap_flags: marks driver laps affected by pit stops (stop lap and immediate exit lap) for exclusion; retire_flags: marks driver laps where retirement occurred to exclude position changes; position_changes: compares consecutive laps per driver-race to calculate position delta; filtered_changes: keeps position_changes excluding first lap, pit_lap_flags, and retire_flags rows; pass_totals: aggregates per driver counting gained positions (overtakes) and lost positions; losing_drivers: joins pass_totals with drivers table and returns names where lost > gained","pit_lap_flags: marks driver laps affected by pit stops (stop lap and immediate exit lap) for exclusion; retire_flags: marks driver laps where retirement occurred to exclude position changes; position_changes: compares consecutive laps per driver-race to calculate position delta; filtered_changes: keeps position_changes excluding first lap, pit_lap_flags, and retire_flags rows; pass_totals: aggregates per driver counting gained positions (overtakes) and lost positions; losing_drivers: joins pass_totals with drivers table and returns names where lost > gained","{""target_db"": ""f1"", ""candidates_total"": 42, ""same_db_total"": 2, ""used_same_db_pool"": ""false"", ""chosen_ids"": ""local060,local015,local300,local099""}",2025-10-17T16:47:55
